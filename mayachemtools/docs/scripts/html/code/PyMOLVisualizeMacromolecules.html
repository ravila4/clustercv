<html>
<head>
<title>MayaChemTools:Code:PyMOLVisualizeMacromolecules.py</title>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<link rel="stylesheet" type="text/css" href="../../../css/MayaChemToolsPythonCode.css">
</head>
<body leftmargin="20" rightmargin="20" topmargin="10" bottommargin="10">
<br/>
<center>
<a href="http://www.mayachemtools.org" title="MayaChemTools Home"><img src="../../../images/MayaChemToolsLogo.gif" border="0" alt="MayaChemTools"></a>
</center>
<br/>
<pre>
    1 <span class="ch">#!/bin/env python</span>
    2 <span class="c1">#</span>
    3 <span class="c1"># File: PyMOLVisualizeMacromolecules.py</span>
    4 <span class="c1"># Author: Manish Sud &lt;msud@san.rr.com&gt;</span>
    5 <span class="c1">#</span>
    6 <span class="c1"># Copyright (C) 2018 Manish Sud. All rights reserved.</span>
    7 <span class="c1">#</span>
    8 <span class="c1"># The functionality available in this script is implemented using PyMOL, a</span>
    9 <span class="c1"># molecular visualization system on an open source foundation originally</span>
   10 <span class="c1"># developed by Warren DeLano.</span>
   11 <span class="c1">#</span>
   12 <span class="c1"># This file is part of MayaChemTools.</span>
   13 <span class="c1">#</span>
   14 <span class="c1"># MayaChemTools is free software; you can redistribute it and/or modify it under</span>
   15 <span class="c1"># the terms of the GNU Lesser General Public License as published by the Free</span>
   16 <span class="c1"># Software Foundation; either version 3 of the License, or (at your option) any</span>
   17 <span class="c1"># later version.</span>
   18 <span class="c1">#</span>
   19 <span class="c1"># MayaChemTools is distributed in the hope that it will be useful, but without</span>
   20 <span class="c1"># any warranty; without even the implied warranty of merchantability of fitness</span>
   21 <span class="c1"># for a particular purpose.  See the GNU Lesser General Public License for more</span>
   22 <span class="c1"># details.</span>
   23 <span class="c1">#</span>
   24 <span class="c1"># You should have received a copy of the GNU Lesser General Public License</span>
   25 <span class="c1"># along with MayaChemTools; if not, see &lt;http://www.gnu.org/licenses/&gt; or</span>
   26 <span class="c1"># write to the Free Software Foundation Inc., 59 Temple Place, Suite 330,</span>
   27 <span class="c1"># Boston, MA, 02111-1307, USA.</span>
   28 <span class="c1">#</span>
   29 
   30 <span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
   31 
   32 <span class="c1"># Add local python path to the global path and import standard library modules...</span>
   33 <span class="kn">import</span> <span class="nn">os</span>
   34 <span class="kn">import</span> <span class="nn">sys</span><span class="p">;</span>  <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s2">&quot;..&quot;</span><span class="p">,</span> <span class="s2">&quot;lib&quot;</span><span class="p">,</span> <span class="s2">&quot;Python&quot;</span><span class="p">))</span>
   35 <span class="kn">import</span> <span class="nn">time</span>
   36 <span class="kn">import</span> <span class="nn">re</span>
   37 
   38 <span class="c1"># PyMOL imports...</span>
   39 <span class="k">try</span><span class="p">:</span>
   40     <span class="kn">import</span> <span class="nn">pymol</span>
   41     <span class="c1"># Finish launching PyMOL in  a command line mode for batch processing (-c)</span>
   42     <span class="c1"># along with the following options:  disable loading of pymolrc and plugins (-k);</span>
   43     <span class="c1"># suppress start up messages (-q)</span>
   44     <span class="n">pymol</span><span class="o">.</span><span class="n">finish_launching</span><span class="p">([</span><span class="s1">&#39;pymol&#39;</span><span class="p">,</span> <span class="s1">&#39;-ckq&#39;</span><span class="p">])</span>
   45 <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">ErrMsg</span><span class="p">:</span>
   46     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Failed to import PyMOL module/package: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ErrMsg</span><span class="p">)</span>
   47     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Check/update your PyMOL environment and try again.</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
   48     <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
   49 
   50 <span class="c1"># MayaChemTools imports...</span>
   51 <span class="k">try</span><span class="p">:</span>
   52     <span class="kn">from</span> <span class="nn">docopt</span> <span class="kn">import</span> <span class="n">docopt</span>
   53     <span class="kn">import</span> <span class="nn">MiscUtil</span>
   54     <span class="kn">import</span> <span class="nn">PyMOLUtil</span>
   55 <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">ErrMsg</span><span class="p">:</span>
   56     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Failed to import MayaChemTools module/package: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ErrMsg</span><span class="p">)</span>
   57     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Check/update your MayaChemTools environment and try again.</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
   58     <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
   59 
   60 <span class="n">ScriptName</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
   61 <span class="n">Options</span> <span class="o">=</span> <span class="p">{}</span>
   62 <span class="n">OptionsInfo</span> <span class="o">=</span> <span class="p">{}</span>
   63 
   64 <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
   65     <span class="sd">&quot;&quot;&quot;Start execution of the script&quot;&quot;&quot;</span>
   66     
   67     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="s2"> (PyMOL v</span><span class="si">%s</span><span class="s2">; </span><span class="si">%s</span><span class="s2">) Starting...</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ScriptName</span><span class="p">,</span> <span class="n">pymol</span><span class="o">.</span><span class="n">cmd</span><span class="o">.</span><span class="n">get_version</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="n">time</span><span class="o">.</span><span class="n">asctime</span><span class="p">()))</span>
   68     
   69     <span class="p">(</span><span class="n">WallClockTime</span><span class="p">,</span> <span class="n">ProcessorTime</span><span class="p">)</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">GetWallClockAndProcessorTime</span><span class="p">()</span>
   70     
   71     <span class="c1"># Retrieve command line arguments and options...</span>
   72     <span class="n">RetrieveOptions</span><span class="p">()</span>
   73     
   74     <span class="c1"># Process and validate command line arguments and options...</span>
   75     <span class="n">ProcessOptions</span><span class="p">()</span>
   76 
   77     <span class="c1"># Perform actions required by the script...</span>
   78     <span class="n">GenerateMacromolecularVisualization</span><span class="p">()</span>
   79     
   80     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="s2">: Done...</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ScriptName</span><span class="p">)</span>
   81     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Total time: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">GetFormattedElapsedTime</span><span class="p">(</span><span class="n">WallClockTime</span><span class="p">,</span> <span class="n">ProcessorTime</span><span class="p">))</span>
   82 
   83 <span class="k">def</span> <span class="nf">GenerateMacromolecularVisualization</span><span class="p">():</span>
   84     <span class="sd">&quot;&quot;&quot;Generate macromolecular visualization.&quot;&quot;&quot;</span>
   85 
   86     <span class="n">Outfile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">]</span>
   87     <span class="n">OutFH</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">Outfile</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
   88     <span class="k">if</span> <span class="n">OutFH</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
   89         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;Failed to open output fie </span><span class="si">%s</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">Outfile</span><span class="p">)</span>
   90     
   91     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Generating file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">Outfile</span><span class="p">)</span>
   92 
   93     <span class="c1"># Setup header...</span>
   94     <span class="n">WritePMLHeader</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">ScriptName</span><span class="p">)</span>
   95     <span class="n">WritePyMOLParameters</span><span class="p">(</span><span class="n">OutFH</span><span class="p">)</span>
   96     
   97     <span class="c1"># Load reffile for alignment..</span>
   98     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Align&quot;</span><span class="p">]:</span>
   99         <span class="n">WriteAlignReference</span><span class="p">(</span><span class="n">OutFH</span><span class="p">)</span>
  100 
  101     <span class="c1"># Setup view for each input file...</span>
  102     <span class="n">FirstComplex</span> <span class="o">=</span> <span class="bp">True</span>
  103     <span class="n">FirstComplexFirstChainName</span> <span class="o">=</span> <span class="bp">None</span>
  104     <span class="k">for</span> <span class="n">FileIndex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">])):</span>
  105         <span class="c1"># Setup PyMOL object names...</span>
  106         <span class="n">PyMOLObjectNames</span> <span class="o">=</span> <span class="n">SetupPyMOLObjectNames</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">)</span>
  107 
  108         <span class="c1"># Setup complex view...</span>
  109         <span class="n">WriteComplexView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">FirstComplex</span><span class="p">)</span>
  110         
  111         <span class="n">SpecifiedChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  112         <span class="n">FirstChain</span> <span class="o">=</span> <span class="bp">True</span>
  113         <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
  114             <span class="k">if</span> <span class="n">FirstComplex</span> <span class="ow">and</span> <span class="n">FirstChain</span><span class="p">:</span>
  115                 <span class="n">FirstComplexFirstChainName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAlone&quot;</span><span class="p">]</span>
  116                 
  117             <span class="n">WriteChainView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  118             
  119             <span class="c1"># Setup ligand views...</span>
  120             <span class="n">FirstLigand</span> <span class="o">=</span> <span class="bp">True</span>
  121             <span class="k">for</span> <span class="n">LigandID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]:</span>
  122                 <span class="n">WriteChainLigandView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">)</span>
  123                 
  124                 <span class="c1"># Set up ligand level group...</span>
  125                 <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">]</span>
  126                 <span class="k">if</span> <span class="n">FirstLigand</span><span class="p">:</span>
  127                     <span class="n">FirstLigand</span> <span class="o">=</span> <span class="bp">False</span>
  128                     <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">]</span>
  129                 <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;ChainLigandGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;ChainLigandGroupMembers&quot;</span><span class="p">],</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span><span class="p">)</span>
  130             
  131             <span class="c1"># Setup Chain level group...</span>
  132             <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">]</span>
  133             <span class="k">if</span> <span class="n">FirstChain</span><span class="p">:</span>
  134                 <span class="n">FirstChain</span> <span class="o">=</span> <span class="bp">False</span>
  135                 <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">]</span>
  136             <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">],</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span><span class="p">)</span>
  137     
  138         <span class="c1"># Set up complex level group...</span>
  139         <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">]</span>
  140         <span class="k">if</span> <span class="n">FirstComplex</span><span class="p">:</span>
  141             <span class="n">FirstComplex</span> <span class="o">=</span> <span class="bp">False</span>
  142             <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">]</span>
  143         <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroupMembers&quot;</span><span class="p">],</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span><span class="p">)</span>
  144         
  145         <span class="c1"># Delete empty PyMOL objects...</span>
  146         <span class="n">DeleteEmptyPyMOLObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">)</span>
  147         
  148     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Align&quot;</span><span class="p">]:</span>
  149         <span class="n">DeleteAlignReference</span><span class="p">(</span><span class="n">OutFH</span><span class="p">)</span>
  150 
  151     <span class="k">if</span> <span class="n">FirstComplexFirstChainName</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
  152         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">cmd.orient(&quot;</span><span class="si">%s</span><span class="s2">&quot;, animate = -1)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">FirstComplexFirstChainName</span><span class="p">)</span>
  153     <span class="k">else</span><span class="p">:</span>
  154         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">cmd.orient(&quot;visible&quot;, animate = -1)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  155     
  156     <span class="n">OutFH</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
  157 
  158     <span class="c1"># Generate PSE file as needed...</span>
  159     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PSEOut&quot;</span><span class="p">]:</span>
  160         <span class="n">GeneratePyMOLSessionFile</span><span class="p">()</span>
  161 
  162 <span class="k">def</span> <span class="nf">WritePMLHeader</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">ScriptName</span><span class="p">):</span>
  163     <span class="sd">&quot;&quot;&quot;Write out PML setting up complex view&quot;&quot;&quot;</span>
  164 
  165     <span class="n">HeaderInfo</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLHeaderInfo</span><span class="p">(</span><span class="n">ScriptName</span><span class="p">)</span>
  166     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">HeaderInfo</span><span class="p">)</span>
  167 
  168 <span class="k">def</span> <span class="nf">WritePyMOLParameters</span><span class="p">(</span><span class="n">OutFH</span><span class="p">):</span>
  169     <span class="sd">&quot;&quot;&quot;Write out PyMOL global parameters. &quot;&quot;&quot;</span>
  170 
  171     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
  172     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;transparency&quot;, </span><span class="si">%.2f</span><span class="s2">, &quot;&quot;, 0)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceTransparency&quot;</span><span class="p">]))</span>
  173     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;label_font_id&quot;, </span><span class="si">%s</span><span class="s2">)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;LabelFontID&quot;</span><span class="p">]))</span>
  174     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
  175     
  176     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up PyMOL gobal parameters...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  177     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  178     
  179 <span class="k">def</span> <span class="nf">WriteAlignReference</span><span class="p">(</span><span class="n">OutFH</span><span class="p">):</span>
  180     <span class="sd">&quot;&quot;&quot;Setup object for alignment reference &quot;&quot;&quot;</span>
  181 
  182     <span class="n">RefFileInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileInfo&quot;</span><span class="p">]</span>
  183     <span class="n">RefFile</span> <span class="o">=</span> <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;RefFileName&quot;</span><span class="p">]</span>
  184     <span class="n">RefName</span> <span class="o">=</span> <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;PyMOLObjectName&quot;</span><span class="p">]</span>
  185     
  186     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
  187     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.load(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">RefFile</span><span class="p">,</span> <span class="n">RefName</span><span class="p">))</span>
  188     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.hide(&quot;everything&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">RefName</span><span class="p">))</span>
  189     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.disable(&quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">RefName</span><span class="p">))</span>
  190     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
  191     
  192     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Loading </span><span class="si">%s</span><span class="s2"> and setting up view for align reference...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">RefFile</span><span class="p">)</span>
  193     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  194     
  195 <span class="k">def</span> <span class="nf">WriteAlignComplex</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">):</span>
  196     <span class="sd">&quot;&quot;&quot;Setup alignment of complex to reference&quot;&quot;&quot;</span>
  197 
  198     <span class="n">RefFileInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileInfo&quot;</span><span class="p">]</span>
  199     <span class="n">RefName</span> <span class="o">=</span> <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;PyMOLObjectName&quot;</span><span class="p">]</span>
  200     
  201     <span class="n">ComplexName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">]</span>
  202     
  203     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^FirstChain$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignMode&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  204         <span class="n">RefFirstChainID</span> <span class="o">=</span> <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
  205         <span class="n">RefAlignSelection</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">RefName</span><span class="p">,</span> <span class="n">RefFirstChainID</span><span class="p">)</span>
  206         
  207         <span class="n">ComplexFirstChainID</span> <span class="o">=</span> <span class="n">RetrieveFirstChainID</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">)</span>
  208         <span class="n">ComplexAlignSelection</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ComplexName</span><span class="p">,</span> <span class="n">ComplexFirstChainID</span><span class="p">)</span>
  209     <span class="k">else</span><span class="p">:</span>
  210         <span class="n">RefAlignSelection</span> <span class="o">=</span> <span class="n">RefName</span>
  211         <span class="n">ComplexAlignSelection</span> <span class="o">=</span> <span class="n">ComplexName</span>
  212 
  213     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForAlignment</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignMethod&quot;</span><span class="p">],</span> <span class="n">RefAlignSelection</span><span class="p">,</span> <span class="n">ComplexAlignSelection</span><span class="p">)</span>
  214     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Aligning </span><span class="si">%s</span><span class="s2"> against reference </span><span class="si">%s</span><span class="s2"> ...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ComplexAlignSelection</span><span class="p">,</span> <span class="n">RefAlignSelection</span><span class="p">))</span>
  215     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  216     
  217 <span class="k">def</span> <span class="nf">DeleteAlignReference</span><span class="p">(</span><span class="n">OutFH</span><span class="p">):</span>
  218     <span class="sd">&quot;&quot;&quot;Delete alignment reference object.&quot;&quot;&quot;</span>
  219     
  220     <span class="n">RefName</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileInfo&quot;</span><span class="p">][</span><span class="s2">&quot;PyMOLObjectName&quot;</span><span class="p">]</span>
  221     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Deleting alignment reference object </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">RefName</span><span class="p">)</span>
  222     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.delete(&quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">RefName</span><span class="p">)</span>
  223 
  224 <span class="k">def</span> <span class="nf">WriteComplexView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">FirstComplex</span><span class="p">):</span>
  225     <span class="sd">&quot;&quot;&quot;Write out PML for viewing polymer complex.&quot;&quot;&quot;</span>
  226 
  227     <span class="c1"># Setup complex...</span>
  228     <span class="n">Infile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  229     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForPolymerComplexView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">],</span> <span class="n">Infile</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
  230     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Loading </span><span class="si">%s</span><span class="s2"> and setting up view for complex...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">Infile</span><span class="p">)</span>
  231     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  232 
  233     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Align&quot;</span><span class="p">]:</span>
  234         <span class="c1"># No need to align complex on to itself...</span>
  235         <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^FirstInputFile$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignRefFile&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="ow">and</span> <span class="n">FirstComplex</span><span class="p">):</span>
  236             <span class="n">WriteAlignComplex</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">)</span>
  237     
  238     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceComplex&quot;</span><span class="p">]:</span>
  239         <span class="c1"># Setup hydrophobic surface...</span>
  240         <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForHydrophobicSurfaceView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexHydrophobicSurface&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">],</span> <span class="n">ColorPalette</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceColorPalette&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
  241         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  242     
  243     <span class="c1"># Setup complex group...</span>
  244     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroupMembers&quot;</span><span class="p">],</span> <span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  245 
  246 <span class="k">def</span> <span class="nf">WriteChainView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  247     <span class="sd">&quot;&quot;&quot;Write out PML for viewing chain.&quot;&quot;&quot;</span>
  248     
  249     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up views for chain </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">ChainID</span><span class="p">)</span>
  250     
  251     <span class="n">ChainComplexName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplex&quot;</span><span class="p">]</span>
  252     
  253     <span class="c1"># Setup chain complex group view...</span>
  254     <span class="n">WriteChainComplexViews</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  255 
  256     <span class="c1"># Setup chain view...</span>
  257     <span class="n">WriteChainAloneViews</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  258     
  259     <span class="c1"># Setup chain solvent view...</span>
  260     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForSolventView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;Solvent&quot;</span><span class="p">],</span> <span class="n">ChainComplexName</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
  261     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  262 
  263     <span class="c1"># Setup chain inorganic view...</span>
  264     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForInorganicView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;Inorganic&quot;</span><span class="p">],</span> <span class="n">ChainComplexName</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
  265     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  266 
  267 <span class="k">def</span> <span class="nf">WriteChainComplexViews</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  268     <span class="sd">&quot;&quot;&quot;Write chain complex views. &quot;&quot;&quot;</span>
  269     
  270     <span class="c1"># Setup chain complex...</span>
  271     <span class="n">ChainComplexName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplex&quot;</span><span class="p">]</span>
  272     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForPolymerChainComplexView</span><span class="p">(</span><span class="n">ChainComplexName</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">],</span> <span class="n">ChainID</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
  273     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  274 
  275     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainComplex&quot;</span><span class="p">]:</span>
  276         <span class="c1"># Setup hydrophobic surface...</span>
  277         <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForHydrophobicSurfaceView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexHydrophobicSurface&quot;</span><span class="p">],</span> <span class="n">ChainComplexName</span><span class="p">,</span> <span class="n">ColorPalette</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceColorPalette&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
  278         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  279     
  280     <span class="c1"># Setup chain complex group...</span>
  281     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroupMembers&quot;</span><span class="p">],</span> <span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  282     
  283 <span class="k">def</span> <span class="nf">WriteChainAloneViews</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  284     <span class="sd">&quot;&quot;&quot;Write individual chain views. &quot;&quot;&quot;</span>
  285 
  286     <span class="n">ChainComplexName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplex&quot;</span><span class="p">]</span>
  287     
  288     <span class="c1"># Setup chain view...</span>
  289     <span class="n">ChainName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAlone&quot;</span><span class="p">]</span>
  290     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForPolymerChainView</span><span class="p">(</span><span class="n">ChainName</span><span class="p">,</span> <span class="n">ChainComplexName</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
  291     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  292 
  293     <span class="n">WriteChainAloneResidueTypesView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span>  <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  294         
  295     <span class="k">if</span> <span class="n">GetChainAloneContainsSurfacesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  296         <span class="k">if</span> <span class="n">GetChainAloneSurfaceChainStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  297             <span class="c1"># Setup surface colored by hyrdophobicitye...</span>
  298             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForHydrophobicSurfaceView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneHydrophobicSurface&quot;</span><span class="p">],</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">ColorPalette</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceColorPalette&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
  299             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  300             
  301             <span class="c1"># Setup surface colored by hyrdophobicity and charge...</span>
  302             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForHydrophobicAndChargeSurfaceView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneHydrophobicChargeSurface&quot;</span><span class="p">],</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;HydrophobicAtomsColor&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;NegativelyChargedAtomsColor&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;PositivelyChargedAtomsColor&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;OtherAtomsColor&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="bp">None</span><span class="p">)</span>
  303             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  304         
  305         <span class="k">if</span> <span class="n">GetChainAloneSurfaceChainElectrostaticsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  306             <span class="c1"># Setup electrostatics surface...</span>
  307             <span class="n">SelectionObjectName</span> <span class="o">=</span> <span class="n">ChainName</span>
  308             <span class="n">ElectrostaticsGroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneElectrostaticsGroup&quot;</span><span class="p">]</span>
  309             <span class="n">ElectrostaticsGroupMembers</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneElectrostaticsGroupMembers&quot;</span><span class="p">]</span>
  310             <span class="n">WriteSurfaceElectrostaticsView</span><span class="p">(</span><span class="s2">&quot;Chain&quot;</span><span class="p">,</span> <span class="n">OutFH</span><span class="p">,</span> <span class="n">SelectionObjectName</span><span class="p">,</span> <span class="n">ElectrostaticsGroupName</span><span class="p">,</span> <span class="n">ElectrostaticsGroupMembers</span><span class="p">)</span>
  311 
  312         <span class="c1"># Setup surface group...</span>
  313         <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSurfaceGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSurfaceGroupMembers&quot;</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">)</span>
  314 
  315     <span class="c1"># Setup chain group...</span>
  316     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroupMembers&quot;</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  317     
  318 <span class="k">def</span> <span class="nf">WriteChainLigandView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
  319     <span class="sd">&quot;&quot;&quot;Write out PML for viewing ligand in a chain.&quot;&quot;&quot;</span>
  320     
  321     <span class="k">for</span> <span class="n">GroupID</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Ligand&quot;</span><span class="p">,</span> <span class="s2">&quot;Pocket&quot;</span><span class="p">,</span> <span class="s2">&quot;PocketSolvent&quot;</span><span class="p">,</span> <span class="s2">&quot;PocketInorganic&quot;</span><span class="p">]:</span>
  322         <span class="n">ComplexName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplex&quot;</span><span class="p">]</span>
  323         <span class="n">LigandName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;Ligand&quot;</span><span class="p">]</span>
  324         
  325         <span class="c1"># Setup main object...</span>
  326         <span class="n">GroupTypeObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  327         <span class="n">GroupTypeObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupTypeObjectID</span><span class="p">]</span>
  328         
  329         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Ligand$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  330             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up views for ligand </span><span class="si">%s</span><span class="s2"> in chain </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">LigandID</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">))</span>
  331             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForLigandView</span><span class="p">(</span><span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">ComplexName</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
  332             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  333         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Pocket$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  334             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up views for pocket around ligand </span><span class="si">%s</span><span class="s2"> in chain </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">LigandID</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">))</span>
  335             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForLigandPocketView</span><span class="p">(</span><span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">ComplexName</span><span class="p">,</span> <span class="n">LigandName</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketDistanceCutoff&quot;</span><span class="p">],</span> <span class="bp">True</span><span class="p">)</span>
  336             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  337             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;label_color&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketLabelColor&quot;</span><span class="p">],</span> <span class="n">GroupTypeObjectName</span><span class="p">))</span>
  338         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^PocketSolvent$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  339             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up views for solvent in pockect around ligand </span><span class="si">%s</span><span class="s2"> in chain </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">LigandID</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">))</span>
  340             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForLigandPocketSolventView</span><span class="p">(</span><span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">ComplexName</span><span class="p">,</span> <span class="n">LigandName</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketDistanceCutoff&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
  341             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  342         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^PocketInorganic$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  343             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up views for inorganic in pockect around ligand </span><span class="si">%s</span><span class="s2"> in chain </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">LigandID</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">))</span>
  344             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForLigandPocketInorganicView</span><span class="p">(</span><span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">ComplexName</span><span class="p">,</span> <span class="n">LigandName</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketDistanceCutoff&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
  345             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  346         
  347         <span class="c1"># Set up polar contacts...</span>
  348         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(Pocket|PocketSolvent|PocketInorganic)$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  349             <span class="n">PolarContactsID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">PolarContacts&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  350             <span class="n">PolarContactsName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">PolarContactsID</span><span class="p">]</span>
  351             
  352             <span class="n">PolarContactsColor</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsLigandColor&quot;</span><span class="p">]</span>
  353             <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^PocketSolvent$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  354                 <span class="n">PolarContactsColor</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsSolventColor&quot;</span><span class="p">]</span>
  355             <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^PocketInorganic$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  356                 <span class="n">PolarContactsColor</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsInorganicColor&quot;</span><span class="p">]</span>
  357             
  358             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForPolarContactsView</span><span class="p">(</span><span class="n">PolarContactsName</span><span class="p">,</span> <span class="n">LigandName</span><span class="p">,</span> <span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">PolarContactsColor</span><span class="p">)</span>
  359             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  360             
  361             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;label_color&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PolarContactsColor</span><span class="p">,</span> <span class="n">PolarContactsName</span><span class="p">))</span>
  362             
  363         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Pocket$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  364             <span class="n">WritePocketResidueTypesView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span>  <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">,</span> <span class="n">GroupTypeObjectID</span><span class="p">)</span>
  365         
  366         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Ligand$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  367             <span class="c1"># Setup ball and stick view...</span>
  368             <span class="n">BallAndStickNameID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">BallAndStick&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  369             <span class="n">BallAndStickName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">BallAndStickNameID</span><span class="p">]</span>
  370             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForBallAndStickView</span><span class="p">(</span><span class="n">BallAndStickName</span><span class="p">,</span> <span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
  371             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  372             
  373         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Pocket$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  374             <span class="k">if</span> <span class="n">GetPocketContainsSurfaceStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
  375                 <span class="n">SurfaceGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">SurfaceGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  376                 <span class="n">SurfaceGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">SurfaceGroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  377                 
  378                 <span class="k">if</span> <span class="n">GetPocketSurfaceChainStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
  379                     <span class="c1"># Setup a surface colored by hydrphobicity...</span>
  380                     <span class="n">HydrophobicSurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">HydrophobicSurface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfaceGroupID</span><span class="p">)</span>
  381                     <span class="n">HydrophobicSurfaceName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">HydrophobicSurfaceID</span><span class="p">]</span>
  382                     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForHydrophobicSurfaceView</span><span class="p">(</span><span class="n">HydrophobicSurfaceName</span><span class="p">,</span> <span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">ColorPalette</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceColorPalette&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="s2">&quot;lines&quot;</span><span class="p">)</span>
  383                     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  384                     
  385                     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;label_color&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketLabelColor&quot;</span><span class="p">],</span> <span class="n">HydrophobicSurfaceName</span><span class="p">))</span>
  386                     
  387                     <span class="c1"># Setup a surface colored by hydrphobicity and charge...</span>
  388                     <span class="n">HydrophobicChargeSurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">HydrophobicChargeSurface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfaceGroupID</span><span class="p">)</span>
  389                     <span class="n">HydrophobicChargeSurfaceName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">HydrophobicChargeSurfaceID</span><span class="p">]</span>
  390                     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForHydrophobicAndChargeSurfaceView</span><span class="p">(</span><span class="n">HydrophobicChargeSurfaceName</span><span class="p">,</span> <span class="n">GroupTypeObjectName</span><span class="p">,</span>  <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;HydrophobicAtomsColor&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;NegativelyChargedAtomsColor&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;PositivelyChargedAtomsColor&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;OtherAtomsColor&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="s2">&quot;lines&quot;</span><span class="p">)</span>
  391                     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  392                     
  393                     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;label_color&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketLabelColor&quot;</span><span class="p">],</span> <span class="n">HydrophobicChargeSurfaceName</span><span class="p">))</span>
  394             
  395                 <span class="k">if</span> <span class="n">GetPocketSurfaceChainElectrostaticsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
  396                     <span class="c1"># Set up a electrostatics surface...</span>
  397                     <span class="n">ElectrostaticsGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">ElectrostaticsGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfaceGroupID</span><span class="p">)</span>
  398                     <span class="n">ElectrostaticsGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">ElectrostaticsGroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfaceGroupID</span><span class="p">)</span>
  399                     <span class="n">ElectrostaticsGroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ElectrostaticsGroupID</span><span class="p">]</span>
  400                     <span class="n">ElectrostaticsGroupMembers</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ElectrostaticsGroupMembersID</span><span class="p">]</span>
  401                     
  402                     <span class="n">WriteSurfaceElectrostaticsView</span><span class="p">(</span><span class="s2">&quot;Pocket&quot;</span><span class="p">,</span> <span class="n">OutFH</span><span class="p">,</span> <span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">ElectrostaticsGroupName</span><span class="p">,</span> <span class="n">ElectrostaticsGroupMembers</span><span class="p">)</span>
  403 
  404                 <span class="c1"># Setup surface group...</span>
  405                 <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SurfaceGroupID</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SurfaceGroupMembersID</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">)</span>
  406         
  407         <span class="c1"># Setup group....</span>
  408         <span class="n">GroupNameID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  409         <span class="n">GroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">GroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  410         <span class="n">GroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupNameID</span><span class="p">]</span>
  411         <span class="n">GroupMembers</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span>
  412 
  413         <span class="n">Action</span> <span class="o">=</span> <span class="s2">&quot;close&quot;</span>
  414         <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span>
  415         <span class="k">if</span>  <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(Ligand|Pocket)$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  416             <span class="n">Action</span> <span class="o">=</span> <span class="s2">&quot;open&quot;</span>
  417             <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span>
  418         <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">GroupName</span><span class="p">,</span> <span class="n">GroupMembers</span><span class="p">,</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span><span class="p">)</span>
  419 
  420 <span class="k">def</span> <span class="nf">WritePocketResidueTypesView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span>  <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">,</span> <span class="n">PocketObjectID</span><span class="p">):</span>
  421     <span class="sd">&quot;&quot;&quot;Write out PML for viewing residue types for a ligand pocket.&quot;&quot;&quot;</span>
  422     
  423     <span class="k">if</span> <span class="ow">not</span> <span class="n">GetPocketResidueTypesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
  424         <span class="k">return</span>
  425 
  426     <span class="n">PocketObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">PocketObjectID</span><span class="p">]</span>
  427     
  428     <span class="n">ResiduesGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">ResiduesGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PocketObjectID</span><span class="p">)</span>
  429     <span class="n">ResiduesGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Members&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupID</span><span class="p">)</span>
  430     
  431     <span class="c1"># Setup residue types objects...</span>
  432     <span class="k">for</span> <span class="n">SubGroupType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Aromatic&quot;</span><span class="p">,</span> <span class="s2">&quot;Hydrophobic&quot;</span><span class="p">,</span> <span class="s2">&quot;Polar&quot;</span><span class="p">,</span> <span class="s2">&quot;Positively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Negatively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Other&quot;</span><span class="p">]:</span>
  433         <span class="n">SubGroupID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">)</span>
  434         
  435         <span class="n">ResiduesSubGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupID</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
  436         <span class="n">ResiduesSubMembersGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Members&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesSubGroupID</span><span class="p">)</span>
  437     
  438         <span class="n">SubGroupMemberID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Residues&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesSubGroupID</span><span class="p">)</span>
  439         <span class="n">ResiduesObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SubGroupMemberID</span><span class="p">]</span>
  440 
  441         <span class="n">SubGroupMemberID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesSubGroupID</span><span class="p">)</span>
  442         <span class="n">ResiduesSurfaceObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SubGroupMemberID</span><span class="p">]</span>
  443 
  444         <span class="n">ResiduesColor</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesParams&quot;</span><span class="p">][</span><span class="n">SubGroupType</span><span class="p">][</span><span class="s2">&quot;Color&quot;</span><span class="p">]</span> 
  445         <span class="n">ResiduesNames</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesParams&quot;</span><span class="p">][</span><span class="n">SubGroupType</span><span class="p">][</span><span class="s2">&quot;Residues&quot;</span><span class="p">]</span>
  446 
  447         <span class="n">NegateResidueNames</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Other$&quot;</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
  448         <span class="n">WriteResidueTypesResiduesAndSurfaceView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PocketObjectName</span><span class="p">,</span> <span class="n">ResiduesObjectName</span><span class="p">,</span> <span class="n">ResiduesSurfaceObjectName</span><span class="p">,</span> <span class="n">ResiduesColor</span><span class="p">,</span> <span class="n">ResiduesNames</span><span class="p">,</span> <span class="n">NegateResidueNames</span><span class="p">)</span>
  449         
  450         <span class="c1"># Setup residue type sub groups...</span>
  451         <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ResiduesSubGroupID</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ResiduesSubMembersGroupID</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  452     
  453     <span class="c1"># Setup residue types group...</span>
  454     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ResiduesGroupID</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ResiduesGroupMembersID</span><span class="p">],</span> <span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  455 
  456 <span class="k">def</span> <span class="nf">WriteChainAloneResidueTypesView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span>  <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  457     <span class="sd">&quot;&quot;&quot;Write out PML for viewing residue types for a chain. &quot;&quot;&quot;</span>
  458 
  459     <span class="k">if</span> <span class="ow">not</span> <span class="n">GetChainAloneResidueTypesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  460         <span class="k">return</span>
  461     
  462     <span class="n">ChainName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAlone&quot;</span><span class="p">]</span>
  463     
  464     <span class="c1"># Setup residue types objects...</span>
  465     <span class="n">ResiduesGroupIDPrefix</span> <span class="o">=</span> <span class="s2">&quot;ChainAloneResidues&quot;</span>
  466     <span class="k">for</span> <span class="n">SubGroupType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Aromatic&quot;</span><span class="p">,</span> <span class="s2">&quot;Hydrophobic&quot;</span><span class="p">,</span> <span class="s2">&quot;Polar&quot;</span><span class="p">,</span> <span class="s2">&quot;Positively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Negatively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Other&quot;</span><span class="p">]:</span>
  467         <span class="n">SubGroupID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">)</span>
  468 
  469         <span class="n">ResiduesObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Residues&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
  470         <span class="n">ResiduesObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesObjectID</span><span class="p">]</span>
  471 
  472         <span class="n">ResiduesSurfaceObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
  473         <span class="n">ResiduesSurfaceObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesSurfaceObjectID</span><span class="p">]</span>
  474 
  475         <span class="n">ResiduesColor</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesParams&quot;</span><span class="p">][</span><span class="n">SubGroupType</span><span class="p">][</span><span class="s2">&quot;Color&quot;</span><span class="p">]</span> 
  476         <span class="n">ResiduesNames</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesParams&quot;</span><span class="p">][</span><span class="n">SubGroupType</span><span class="p">][</span><span class="s2">&quot;Residues&quot;</span><span class="p">]</span>
  477 
  478         <span class="n">NegateResidueNames</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Other$&quot;</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
  479         <span class="n">WriteResidueTypesResiduesAndSurfaceView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">ResiduesObjectName</span><span class="p">,</span> <span class="n">ResiduesSurfaceObjectName</span><span class="p">,</span> <span class="n">ResiduesColor</span><span class="p">,</span> <span class="n">ResiduesNames</span><span class="p">,</span> <span class="n">NegateResidueNames</span><span class="p">)</span>
  480 
  481         <span class="c1"># Setup sub groups for residue types..</span>
  482         <span class="n">ResiduesSubGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
  483         <span class="n">ResiduesSubGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">GroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
  484 
  485         <span class="c1"># Setup residue type sub groups...</span>
  486         <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesSubGroupID</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesSubGroupMembersID</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  487         
  488     <span class="c1"># Setup residue types group...</span>
  489     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneResiduesGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneResiduesGroupMembers&quot;</span><span class="p">],</span> <span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  490 
  491 <span class="k">def</span> <span class="nf">WriteResidueTypesResiduesAndSurfaceView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">SelectionObjectName</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">SurfaceName</span><span class="p">,</span> <span class="n">ResiduesColor</span><span class="p">,</span> <span class="n">ResiduesNames</span><span class="p">,</span> <span class="n">NegateResidueNames</span><span class="p">):</span>
  492     <span class="sd">&quot;&quot;&quot;Write residue types residues and surface view. &quot;&quot;&quot;</span>
  493 
  494     <span class="n">ResidueNamesSelection</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ResiduesNames</span><span class="p">)</span>
  495     <span class="k">if</span> <span class="n">NegateResidueNames</span><span class="p">:</span>
  496         <span class="n">Selection</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and (not resn </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionObjectName</span><span class="p">,</span> <span class="n">ResidueNamesSelection</span><span class="p">)</span>
  497     <span class="k">else</span><span class="p">:</span>
  498         <span class="n">Selection</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and (resn </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionObjectName</span><span class="p">,</span> <span class="n">ResidueNamesSelection</span><span class="p">)</span>
  499 
  500     <span class="c1"># Setup residues...</span>
  501     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForSelectionDisplayView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="s2">&quot;lines&quot;</span><span class="p">,</span> <span class="n">ResiduesColor</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
  502     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  503 
  504     <span class="c1"># Setup surface...</span>
  505     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForSelectionDisplayView</span><span class="p">(</span><span class="n">SurfaceName</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="s2">&quot;surface&quot;</span><span class="p">,</span> <span class="n">ResiduesColor</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
  506     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  507     
  508 <span class="k">def</span> <span class="nf">WriteSurfaceElectrostaticsView</span><span class="p">(</span><span class="n">Mode</span><span class="p">,</span> <span class="n">OutFH</span><span class="p">,</span> <span class="n">SelectionObjectName</span><span class="p">,</span> <span class="n">ElectrostaticsGroupName</span><span class="p">,</span> <span class="n">ElectrostaticsGroupMembers</span><span class="p">):</span>
  509     <span class="sd">&quot;&quot;&quot;Write out PML for viewing surface electrostatics. &quot;&quot;&quot;</span>
  510 
  511     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ElectrostaticsGroupMembers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
  512         <span class="n">Name</span><span class="p">,</span> <span class="n">ContactPotentialName</span><span class="p">,</span> <span class="n">MapName</span><span class="p">,</span> <span class="n">LegendName</span><span class="p">,</span> <span class="n">VolumeName</span> <span class="o">=</span> <span class="n">ElectrostaticsGroupMembers</span>
  513     <span class="k">else</span><span class="p">:</span>
  514         <span class="n">Name</span><span class="p">,</span> <span class="n">ContactPotentialName</span><span class="p">,</span> <span class="n">MapName</span><span class="p">,</span> <span class="n">LegendName</span> <span class="o">=</span> <span class="n">ElectrostaticsGroupMembers</span>
  515         <span class="n">VolumeName</span> <span class="o">=</span> <span class="bp">None</span>
  516 
  517     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
  518 
  519     <span class="c1"># Setup chain...</span>
  520     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.create(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;(</span><span class="si">%s</span><span class="s2">)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">SelectionObjectName</span><span class="p">))</span>
  521 
  522     <span class="c1"># Setup vacuum electrostatics surface along with associated objects...</span>
  523     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;util.protein_vacuum_esp(&quot;</span><span class="si">%s</span><span class="s2">&quot;, mode=2, quiet=0, _self=cmd)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
  524     
  525     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set_name(&quot;</span><span class="si">%s</span><span class="s2">_e_chg&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">ContactPotentialName</span><span class="p">))</span>
  526     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Chain$&quot;</span><span class="p">,</span> <span class="n">Mode</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  527         <span class="n">DisplayStyle</span> <span class="o">=</span> <span class="s2">&quot;cartoon&quot;</span>
  528     <span class="k">else</span><span class="p">:</span>
  529         <span class="n">DisplayStyle</span> <span class="o">=</span> <span class="s2">&quot;lines&quot;</span>
  530     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;(</span><span class="si">%s</span><span class="s2">)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DisplayStyle</span><span class="p">,</span> <span class="n">ContactPotentialName</span><span class="p">))</span>
  531     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">ContactPotentialName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">))</span>
  532     
  533     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set_name(&quot;</span><span class="si">%s</span><span class="s2">_e_map&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">MapName</span><span class="p">))</span>
  534     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">))</span>
  535     
  536     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set_name(&quot;</span><span class="si">%s</span><span class="s2">_e_pot&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">LegendName</span><span class="p">))</span>
  537     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">LegendName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">))</span>
  538 
  539     <span class="k">if</span> <span class="n">VolumeName</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
  540         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.volume(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;(</span><span class="si">%s</span><span class="s2">)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">VolumeName</span><span class="p">,</span> <span class="n">MapName</span><span class="p">,</span> <span class="s2">&quot;esp&quot;</span><span class="p">,</span> <span class="n">Name</span><span class="p">))</span>
  541         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">VolumeName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">))</span>
  542     
  543     <span class="c1"># Delete name and take it out from the group membership. It is</span>
  544     <span class="c1"># is already part of ContactPotential object.</span>
  545     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.delete(&quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
  546     <span class="n">ElectrostaticsGroupMembers</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
  547     
  548     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
  549     
  550     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  551     
  552     <span class="c1"># Setup group...</span>
  553     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">ElectrostaticsGroupName</span><span class="p">,</span> <span class="n">ElectrostaticsGroupMembers</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  554 
  555 <span class="k">def</span> <span class="nf">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">GroupName</span><span class="p">,</span> <span class="n">GroupMembers</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="s2">&quot;close&quot;</span><span class="p">):</span>
  556     <span class="sd">&quot;&quot;&quot;Generate and write PML for group. &quot;&quot;&quot;</span>
  557     
  558     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForGroup</span><span class="p">(</span><span class="n">GroupName</span><span class="p">,</span> <span class="n">GroupMembers</span><span class="p">,</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span><span class="p">)</span>
  559     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up group </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">GroupName</span><span class="p">)</span>
  560     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  561 
  562 <span class="k">def</span> <span class="nf">GeneratePyMOLSessionFile</span><span class="p">():</span>
  563     <span class="sd">&quot;&quot;&quot;Generate PME file from PML file. &quot;&quot;&quot;</span>
  564 
  565     <span class="n">PSEOutfile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PSEOutfile&quot;</span><span class="p">]</span>
  566     <span class="n">PMLOutfile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">]</span>
  567     
  568     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Generating file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">PSEOutfile</span><span class="p">)</span>
  569     
  570     <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">ConvertPMLFileToPSEFile</span><span class="p">(</span><span class="n">PMLOutfile</span><span class="p">,</span> <span class="n">PSEOutfile</span><span class="p">)</span>
  571     
  572     <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">PSEOutfile</span><span class="p">):</span>
  573         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;Failed to generate PSE file, </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PSEOutfile</span><span class="p">))</span>
  574     
  575     <span class="k">if</span> <span class="ow">not</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOut&quot;</span><span class="p">]:</span>
  576         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Deleting file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">PMLOutfile</span><span class="p">)</span>
  577         <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">PMLOutfile</span><span class="p">)</span>
  578 
  579 <span class="k">def</span> <span class="nf">DeleteEmptyPyMOLObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">):</span>
  580     <span class="sd">&quot;&quot;&quot;Delete empty PyMOL objects. &quot;&quot;&quot;</span>
  581     
  582     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AllowEmptyObjects&quot;</span><span class="p">]:</span>
  583         <span class="k">return</span>
  584     
  585     <span class="n">SpecifiedChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  586     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
  587         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Checking and deleting empty objects for chain </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">))</span>
  588         
  589         <span class="c1"># Delete any chain level objects...</span>
  590         <span class="n">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;Solvent&quot;</span><span class="p">])</span>
  591         <span class="n">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;Inorganic&quot;</span><span class="p">])</span>
  592 
  593         <span class="c1"># Delete residue type objects...</span>
  594         <span class="n">DeleteEmptyChainResidueTypesObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  595         
  596         <span class="k">for</span> <span class="n">LigandID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]:</span>
  597             <span class="c1"># Delete ligand level objects...</span>
  598             <span class="k">for</span> <span class="n">GroupID</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Pocket&quot;</span><span class="p">,</span> <span class="s2">&quot;PocketSolvent&quot;</span><span class="p">,</span> <span class="s2">&quot;PocketInorganic&quot;</span><span class="p">]:</span>
  599                 <span class="n">GroupNameID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  600                 <span class="n">GroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupNameID</span><span class="p">]</span>
  601 
  602                 <span class="n">GroupTypeObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  603                 <span class="n">GroupTypeObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupTypeObjectID</span><span class="p">]</span>
  604                 
  605                 <span class="n">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">GroupName</span><span class="p">)</span>
  606                 
  607                 <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Pocket$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  608                     <span class="n">DeleteEmptyPocketResidueTypesObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">,</span> <span class="n">GroupTypeObjectID</span><span class="p">)</span>
  609 
  610 <span class="k">def</span> <span class="nf">DeleteEmptyChainResidueTypesObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  611     <span class="sd">&quot;&quot;&quot;Delete empty chain residue objects. &quot;&quot;&quot;</span>
  612     
  613     <span class="k">if</span> <span class="ow">not</span> <span class="n">GetChainAloneResidueTypesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  614         <span class="k">return</span>
  615     
  616     <span class="n">ResiduesGroupIDPrefix</span> <span class="o">=</span> <span class="s2">&quot;ChainAloneResidues&quot;</span>
  617     <span class="k">for</span> <span class="n">GroupType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Aromatic&quot;</span><span class="p">,</span> <span class="s2">&quot;Hydrophobic&quot;</span><span class="p">,</span> <span class="s2">&quot;Polar&quot;</span><span class="p">,</span> <span class="s2">&quot;Positively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Negatively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Other&quot;</span><span class="p">]:</span>
  618         <span class="n">GroupID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">)</span>
  619         
  620         <span class="n">ResiduesGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">)</span>
  621         <span class="n">GroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesGroupID</span><span class="p">]</span>
  622         
  623         <span class="n">GroupObjectNamesList</span> <span class="o">=</span> <span class="p">[]</span>
  624         
  625         <span class="n">ResiduesObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Residues&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">)</span>
  626         <span class="n">ResiduesObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesObjectID</span><span class="p">]</span>
  627         <span class="n">GroupObjectNamesList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResiduesObjectName</span><span class="p">)</span>
  628         
  629         <span class="n">ResiduesSurfaceObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">)</span>
  630         <span class="n">ResiduesSurfaceObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesSurfaceObjectID</span><span class="p">]</span>
  631         <span class="n">GroupObjectNamesList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResiduesSurfaceObjectName</span><span class="p">)</span>
  632         
  633         <span class="n">GroupObjectNames</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">GroupObjectNamesList</span><span class="p">)</span>
  634         <span class="n">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">GroupObjectNames</span><span class="p">,</span> <span class="n">GroupName</span><span class="p">)</span>
  635 
  636 <span class="k">def</span> <span class="nf">DeleteEmptyPocketResidueTypesObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">,</span> <span class="n">PocketObjectID</span><span class="p">):</span>
  637     <span class="sd">&quot;&quot;&quot;Delete empty chain residue objects. &quot;&quot;&quot;</span>
  638     
  639     <span class="k">if</span> <span class="ow">not</span> <span class="n">GetPocketResidueTypesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
  640         <span class="k">return</span>
  641     
  642     <span class="n">ResiduesGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">ResiduesGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PocketObjectID</span><span class="p">)</span>
  643     <span class="n">ResiduesGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Members&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupID</span><span class="p">)</span>
  644     
  645     <span class="k">for</span> <span class="n">SubGroupType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Aromatic&quot;</span><span class="p">,</span> <span class="s2">&quot;Hydrophobic&quot;</span><span class="p">,</span> <span class="s2">&quot;Polar&quot;</span><span class="p">,</span> <span class="s2">&quot;Positively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Negatively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Other&quot;</span><span class="p">]:</span>
  646         <span class="n">SubGroupID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">)</span>
  647         
  648         <span class="n">ResiduesSubGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupID</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
  649         <span class="n">ResiduesSubMembersGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Members&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesSubGroupID</span><span class="p">)</span>
  650 
  651         <span class="n">SubGroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ResiduesSubGroupID</span><span class="p">]</span>
  652         <span class="n">SubGroupObjectNames</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ResiduesSubMembersGroupID</span><span class="p">])</span>
  653         
  654         <span class="n">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">SubGroupObjectNames</span><span class="p">,</span> <span class="n">SubGroupName</span><span class="p">)</span>
  655 
  656 <span class="k">def</span> <span class="nf">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">ObjectName</span><span class="p">,</span> <span class="n">ParentObjectName</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
  657     <span class="sd">&quot;&quot;&quot;Write PML to check and delete empty PyMOL objects. &quot;&quot;&quot;</span>
  658     
  659     <span class="k">if</span> <span class="n">ParentObjectName</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  660         <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;CheckAndDeleteEmptyObjects(&quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ObjectName</span><span class="p">)</span>
  661     <span class="k">else</span><span class="p">:</span>
  662         <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;CheckAndDeleteEmptyObjects(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ObjectName</span><span class="p">,</span> <span class="n">ParentObjectName</span><span class="p">)</span>
  663     
  664     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  665     
  666 <span class="k">def</span> <span class="nf">SetupPyMOLObjectNames</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">):</span>
  667     <span class="sd">&quot;&quot;&quot;Setup hierarchy of PyMOL groups and objects for ligand centric views of</span>
  668 <span class="sd">    chains and ligands present in input file.</span>
  669 <span class="sd">    &quot;&quot;&quot;</span>
  670 
  671     <span class="n">PyMOLObjectNames</span> <span class="o">=</span> <span class="p">{}</span>
  672     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  673     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  674 
  675     <span class="c1"># Setup groups and objects for complex...</span>
  676     <span class="n">SetupPyMOLObjectNamesForComplex</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">)</span>
  677     
  678     <span class="c1"># Setup groups and objects for chain...</span>
  679     <span class="n">SpecifiedChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  680     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
  681         <span class="n">SetupPyMOLObjectNamesForChain</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  682         
  683         <span class="c1"># Setup groups and objects for ligand...</span>
  684         <span class="k">for</span> <span class="n">LigandID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]:</span>
  685             <span class="n">SetupPyMOLObjectNamesForLigand</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">)</span>
  686 
  687     <span class="k">return</span> <span class="n">PyMOLObjectNames</span>
  688 
  689 <span class="k">def</span> <span class="nf">SetupPyMOLObjectNamesForComplex</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">):</span>
  690     <span class="sd">&quot;&quot;&quot;Setup groups and objects for complex. &quot;&quot;&quot;</span>
  691     
  692     <span class="n">PDBFileRoot</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesRoots&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  693     
  694     <span class="n">PDBGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PDBFileRoot</span>
  695     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PDBGroupName</span>
  696     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  697 
  698     <span class="n">ComplexGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Complex&quot;</span> <span class="o">%</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroup&quot;</span><span class="p">]</span>
  699     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ComplexGroupName</span>
  700     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ComplexGroupName</span><span class="p">)</span>
  701     
  702     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Complex&quot;</span> <span class="o">%</span> <span class="n">ComplexGroupName</span>
  703     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceComplex&quot;</span><span class="p">]:</span>
  704         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexHydrophobicSurface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface&quot;</span> <span class="o">%</span> <span class="n">ComplexGroupName</span>
  705 
  706     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  707     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">])</span>
  708     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceComplex&quot;</span><span class="p">]:</span>
  709         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexHydrophobicSurface&quot;</span><span class="p">])</span>
  710     
  711 <span class="k">def</span> <span class="nf">SetupPyMOLObjectNamesForChain</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  712     <span class="sd">&quot;&quot;&quot;Setup groups and objects for chain.&quot;&quot;&quot;</span>
  713     
  714     <span class="n">PDBGroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroup&quot;</span><span class="p">]</span>
  715     
  716     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  717     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  718     
  719     <span class="c1"># Set up chain group and chain objects...</span>
  720     <span class="n">ChainGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Chain</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PDBGroupName</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  721     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainGroupName</span>
  722     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainGroupName</span><span class="p">)</span>
  723     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  724     
  725     <span class="c1"># Setup chain complex group and objects...</span>
  726     <span class="n">ChainComplexGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Complex&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainGroupName</span><span class="p">)</span>
  727     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainComplexGroupName</span>
  728     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainComplexGroupName</span><span class="p">)</span>
  729 
  730     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  731     
  732     <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Complex&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainComplexGroupName</span><span class="p">)</span>
  733     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
  734     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
  735     
  736     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainComplex&quot;</span><span class="p">]:</span>
  737         <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainComplexGroupName</span><span class="p">)</span>
  738         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexHydrophobicSurface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
  739         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
  740 
  741     <span class="c1"># Setup up a group for individual chains...</span>
  742     <span class="n">ChainAloneGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Chain&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainGroupName</span><span class="p">)</span>
  743     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainAloneGroupName</span>
  744     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainAloneGroupName</span><span class="p">)</span>
  745         
  746     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  747         
  748     <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Chain&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainAloneGroupName</span><span class="p">)</span>
  749     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAlone&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
  750     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
  751 
  752     <span class="k">if</span> <span class="n">GetChainAloneResidueTypesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  753         <span class="c1"># Setup residue type group and its subgroups...</span>
  754         <span class="n">ResiduesGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Residues&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainAloneGroupName</span><span class="p">)</span>
  755         
  756         <span class="n">ResiduesGroupIDPrefix</span> <span class="o">=</span> <span class="s2">&quot;ChainAloneResidues&quot;</span>
  757         <span class="n">ResiduesGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="n">ResiduesGroupIDPrefix</span>
  758 
  759         <span class="c1"># Add residue group to chain alone group...</span>
  760         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResiduesGroupName</span>
  761         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResiduesGroupName</span><span class="p">)</span>
  762         
  763         <span class="c1"># Initialize residue group members...</span>
  764         <span class="n">ResiduesGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">GroupMembers&quot;</span> <span class="o">%</span> <span class="n">ResiduesGroupIDPrefix</span>
  765         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesGroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  766 
  767         <span class="c1"># Setup residues sub groups and its members...</span>
  768         <span class="k">for</span> <span class="n">SubGroupType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Aromatic&quot;</span><span class="p">,</span> <span class="s2">&quot;Hydrophobic&quot;</span><span class="p">,</span> <span class="s2">&quot;Polar&quot;</span><span class="p">,</span> <span class="s2">&quot;Positively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Negatively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Other&quot;</span><span class="p">]:</span>
  769             <span class="n">SubGroupID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">)</span>
  770 
  771             <span class="n">ResiduesSubGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupName</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">)</span>
  772             <span class="n">ResiduesSubGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
  773 
  774             <span class="c1"># Add sub group to residues group...</span>
  775             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesSubGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResiduesSubGroupName</span>
  776             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResiduesSubGroupName</span><span class="p">)</span>
  777 
  778             <span class="c1"># Initialize sub group members...</span>
  779             <span class="n">ResiduesSubGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">GroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
  780             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesSubGroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  781             
  782             <span class="c1"># Add sub group members to subgroup...</span>
  783             <span class="k">for</span> <span class="n">MemberType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Residues&quot;</span><span class="p">,</span> <span class="s2">&quot;Surface&quot;</span><span class="p">]:</span>
  784                 <span class="n">MemberID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">MemberType</span><span class="p">)</span>
  785 
  786                 <span class="n">SubGroupMemberName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesSubGroupName</span><span class="p">,</span> <span class="n">MemberType</span><span class="p">)</span>
  787                 <span class="n">SubGroupMemberID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">,</span> <span class="n">MemberID</span><span class="p">)</span>
  788                 
  789                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SubGroupMemberID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SubGroupMemberName</span>
  790                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesSubGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SubGroupMemberName</span><span class="p">)</span>
  791 
  792     <span class="k">if</span> <span class="n">GetChainAloneContainsSurfacesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  793         <span class="c1"># Setup a surface group and add it to chain alone group...</span>
  794         <span class="n">SurfaceGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainAloneGroupName</span><span class="p">)</span>
  795         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSurfaceGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SurfaceGroupName</span>
  796         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SurfaceGroupName</span><span class="p">)</span>
  797         
  798         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSurfaceGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  799         
  800         <span class="k">if</span> <span class="n">GetChainAloneSurfaceChainStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  801             <span class="c1"># Setup hydrophobicity surface...</span>
  802             <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Hydrophobicity&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfaceGroupName</span><span class="p">)</span>
  803             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneHydrophobicSurface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
  804             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSurfaceGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
  805             
  806             <span class="c1"># Setup hydrophobicity and charge surface...</span>
  807             <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Hydrophobicity_Charge&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfaceGroupName</span><span class="p">)</span>
  808             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneHydrophobicChargeSurface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
  809             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSurfaceGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
  810     
  811         <span class="k">if</span> <span class="n">GetChainAloneSurfaceChainElectrostaticsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  812             <span class="c1"># Setup electrostatics group...</span>
  813             <span class="n">GroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Vacuum_Electrostatics&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfaceGroupName</span><span class="p">)</span>
  814             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneElectrostaticsGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">GroupName</span>
  815             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSurfaceGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">GroupName</span><span class="p">)</span>
  816             
  817             <span class="c1"># Setup electrostatics group members...</span>
  818             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneElectrostaticsGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  819             
  820             <span class="k">for</span> <span class="n">MemberType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Chain&quot;</span><span class="p">,</span> <span class="s2">&quot;Contact_Potential&quot;</span><span class="p">,</span> <span class="s2">&quot;Map&quot;</span><span class="p">,</span> <span class="s2">&quot;Legend&quot;</span><span class="p">,</span> <span class="s2">&quot;Volume&quot;</span><span class="p">]:</span>
  821                 <span class="n">MemberID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">MemberType</span><span class="p">)</span>
  822                 
  823                 <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupName</span><span class="p">,</span> <span class="n">MemberType</span><span class="p">)</span>
  824                 <span class="n">NameID</span> <span class="o">=</span> <span class="s2">&quot;ChainAloneElectrostaticsSurface</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">MemberID</span>
  825                 
  826                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">NameID</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
  827                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneElectrostaticsGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
  828             
  829     <span class="c1"># Setup solvent and inorganic objects for chain...</span>
  830     <span class="k">for</span> <span class="n">NameID</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Solvent&quot;</span><span class="p">,</span> <span class="s2">&quot;Inorganic&quot;</span><span class="p">]:</span>
  831         <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainGroupName</span><span class="p">,</span> <span class="n">NameID</span><span class="p">)</span>
  832         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">NameID</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
  833         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
  834 
  835 <span class="k">def</span> <span class="nf">SetupPyMOLObjectNamesForLigand</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
  836     <span class="sd">&quot;&quot;&quot;Stetup groups and objects for ligand.&quot;&quot;&quot;</span>
  837 
  838     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  839     
  840     <span class="n">ChainGroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroup&quot;</span><span class="p">]</span>
  841     
  842     <span class="c1"># Setup a chain level ligand group...</span>
  843     <span class="n">ChainLigandGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Ligand</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainGroupName</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">)</span>
  844     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;ChainLigandGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainLigandGroupName</span>
  845     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainLigandGroupName</span><span class="p">)</span>
  846     
  847     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;ChainLigandGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  848 
  849     <span class="c1"># Set up groups and objects for a specific ligand group...</span>
  850     <span class="k">for</span> <span class="n">GroupType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Ligand&quot;</span><span class="p">,</span> <span class="s2">&quot;Pocket&quot;</span><span class="p">,</span> <span class="s2">&quot;Pocket_Solvent&quot;</span><span class="p">,</span> <span class="s2">&quot;Pocket_Inorganic&quot;</span><span class="p">]:</span>
  851         <span class="n">GroupID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">)</span>
  852         <span class="n">GroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainLigandGroupName</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">)</span>
  853                 
  854         <span class="n">GroupNameID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  855         <span class="n">GroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">GroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  856         
  857         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupNameID</span><span class="p">]</span> <span class="o">=</span> <span class="n">GroupName</span>
  858         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;ChainLigandGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">GroupName</span><span class="p">)</span>
  859         
  860         <span class="n">GroupTypeObjectName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupName</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">)</span>
  861         <span class="n">GroupTypeObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  862         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupTypeObjectID</span><span class="p">]</span> <span class="o">=</span> <span class="n">GroupTypeObjectName</span>
  863         
  864         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  865         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">GroupTypeObjectName</span><span class="p">)</span>
  866         
  867         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Ligand$&quot;</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  868             <span class="c1"># Only need to add ball and stick...</span>
  869             <span class="n">BallAndStickName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.BallAndStick&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupName</span><span class="p">)</span>
  870             <span class="n">BallAndStickID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">BallAndStick&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  871             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">BallAndStickID</span><span class="p">]</span> <span class="o">=</span> <span class="n">BallAndStickName</span>
  872             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">BallAndStickName</span><span class="p">)</span>
  873         
  874         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(Pocket|Pocket_Solvent|Pocket_Inorganic)$&quot;</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  875             <span class="n">PolarContactsName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Polar_Contacts&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupName</span><span class="p">)</span>
  876             <span class="n">PolarContactsID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">PolarContacts&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  877             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">PolarContactsID</span><span class="p">]</span> <span class="o">=</span> <span class="n">PolarContactsName</span>
  878             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PolarContactsName</span><span class="p">)</span>
  879                 
  880         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Pocket$&quot;</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  881             <span class="k">if</span> <span class="n">GetPocketResidueTypesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
  882                 <span class="c1"># Setup residue type group and add to pocket group...</span>
  883                 <span class="n">ResiduesGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Residues&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupName</span><span class="p">)</span>
  884                 <span class="n">ResiduesGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">ResiduesGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  885                 <span class="n">ResiduesGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Members&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupID</span><span class="p">)</span>
  886 
  887                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ResiduesGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResiduesGroupName</span>
  888                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResiduesGroupName</span><span class="p">)</span>
  889                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ResiduesGroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  890                 
  891                 <span class="c1"># Setup residue group subgroup and its members...</span>
  892                 <span class="k">for</span> <span class="n">SubGroupType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Aromatic&quot;</span><span class="p">,</span> <span class="s2">&quot;Hydrophobic&quot;</span><span class="p">,</span> <span class="s2">&quot;Polar&quot;</span><span class="p">,</span> <span class="s2">&quot;Positively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Negatively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Other&quot;</span><span class="p">]:</span>
  893                     <span class="n">SubGroupID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">)</span>
  894                     <span class="n">ResiduesSubGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupName</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">)</span>
  895                     <span class="n">ResiduesSubGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupID</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
  896                     <span class="n">ResiduesSubMembersGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Members&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesSubGroupID</span><span class="p">)</span>
  897                     
  898                     <span class="c1"># Add sub group to residues group...</span>
  899                     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ResiduesSubGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResiduesSubGroupName</span>
  900                     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ResiduesGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResiduesSubGroupName</span><span class="p">)</span>
  901                     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ResiduesSubMembersGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  902                     
  903                     <span class="c1"># Add sub group members to subgroup...</span>
  904                     <span class="k">for</span> <span class="n">MemberType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Residues&quot;</span><span class="p">,</span> <span class="s2">&quot;Surface&quot;</span><span class="p">]:</span>
  905                         <span class="n">MemberID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">MemberType</span><span class="p">)</span>
  906                         <span class="n">SubGroupMemberName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesSubGroupName</span><span class="p">,</span> <span class="n">MemberType</span><span class="p">)</span>
  907                         <span class="n">SubGroupMemberID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesSubGroupID</span><span class="p">,</span> <span class="n">MemberID</span><span class="p">)</span>
  908                         
  909                         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SubGroupMemberID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SubGroupMemberName</span>
  910                         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ResiduesSubMembersGroupID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SubGroupMemberName</span><span class="p">)</span>
  911 
  912             <span class="k">if</span> <span class="n">GetPocketContainsSurfaceStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
  913                 <span class="c1"># Setup a pocket surface group add it to the group...</span>
  914                 <span class="n">SurfaceGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupName</span><span class="p">)</span>
  915                 <span class="n">SurfaceGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">SurfaceGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  916                 <span class="n">SurfaceGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">SurfaceGroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  917                     
  918                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SurfaceGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SurfaceGroupName</span>
  919                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SurfaceGroupName</span><span class="p">)</span>
  920                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SurfaceGroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  921             
  922                 <span class="k">if</span> <span class="n">GetPocketSurfaceChainStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
  923                     <span class="c1"># Surface colored by hydrophobicity...</span>
  924                     <span class="n">HydrophobicSurfaceName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Hydrophobicity&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfaceGroupName</span><span class="p">)</span>
  925                     <span class="n">HydrophobicSurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">HydrophobicSurface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfaceGroupID</span><span class="p">)</span>
  926                     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">HydrophobicSurfaceID</span><span class="p">]</span> <span class="o">=</span> <span class="n">HydrophobicSurfaceName</span>
  927                     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SurfaceGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HydrophobicSurfaceName</span><span class="p">)</span>
  928                     
  929                     <span class="c1"># Surface colored by hydrophobicity and charge...</span>
  930                     <span class="n">HydrophobicChargeSurfaceName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Hydrophobicity_Charge&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfaceGroupName</span><span class="p">)</span>
  931                     <span class="n">HydrophobicChargeSurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">HydrophobicChargeSurface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfaceGroupID</span><span class="p">)</span>
  932                     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">HydrophobicChargeSurfaceID</span><span class="p">]</span> <span class="o">=</span> <span class="n">HydrophobicChargeSurfaceName</span>
  933                     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SurfaceGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HydrophobicChargeSurfaceName</span><span class="p">)</span>
  934                     
  935                 
  936                 <span class="k">if</span> <span class="n">GetPocketSurfaceChainElectrostaticsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
  937                     <span class="n">ElectrostaticsGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Vacuum_Electrostatics&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfaceGroupName</span><span class="p">)</span>
  938                     <span class="n">ElectrostaticsGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">ElectrostaticsGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfaceGroupID</span><span class="p">)</span>
  939                     <span class="n">ElectrostaticsGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">ElectrostaticsGroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfaceGroupID</span><span class="p">)</span>
  940                     
  941                     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ElectrostaticsGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">ElectrostaticsGroupName</span>
  942                     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SurfaceGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ElectrostaticsGroupName</span><span class="p">)</span>
  943                     
  944                     <span class="c1"># Setup electrostatics group members without the volume object...</span>
  945                     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ElectrostaticsGroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  946 
  947                     <span class="k">for</span> <span class="n">MemberType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Pocket&quot;</span><span class="p">,</span> <span class="s2">&quot;Contact_Potential&quot;</span><span class="p">,</span> <span class="s2">&quot;Map&quot;</span><span class="p">,</span> <span class="s2">&quot;Legend&quot;</span><span class="p">]:</span>
  948                         <span class="n">MemberID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">MemberType</span><span class="p">)</span>
  949                         
  950                         <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ElectrostaticsGroupName</span><span class="p">,</span> <span class="n">MemberType</span><span class="p">)</span>
  951                         <span class="n">NameID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ElectrostaticsGroupID</span><span class="p">,</span> <span class="n">MemberID</span><span class="p">)</span>
  952                         
  953                         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">NameID</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
  954                         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ElectrostaticsGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
  955     
  956 <span class="k">def</span> <span class="nf">RetrieveInfilesInfo</span><span class="p">():</span>
  957     <span class="sd">&quot;&quot;&quot;Retrieve information for input files.&quot;&quot;&quot;</span>
  958 
  959     <span class="n">InfilesInfo</span> <span class="o">=</span> <span class="p">{}</span>
  960     
  961     <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  962     <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;InfilesRoots&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  963     <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  964     
  965     <span class="k">for</span> <span class="n">Infile</span> <span class="ow">in</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">]:</span>
  966         <span class="n">FileDir</span><span class="p">,</span> <span class="n">FileName</span><span class="p">,</span> <span class="n">FileExt</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ParseFileName</span><span class="p">(</span><span class="n">Infile</span><span class="p">)</span>
  967         <span class="n">InfileRoot</span> <span class="o">=</span> <span class="n">FileName</span>
  968         
  969         <span class="n">ChainsAndLigandInfo</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">GetChainsAndLigandsInfo</span><span class="p">(</span><span class="n">Infile</span><span class="p">,</span> <span class="n">InfileRoot</span><span class="p">)</span>
  970         
  971         <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Infile</span><span class="p">)</span>
  972         <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;InfilesRoots&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">InfileRoot</span><span class="p">)</span>
  973         <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainsAndLigandInfo</span><span class="p">)</span>
  974     
  975     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">InfilesInfo</span>
  976 
  977 <span class="k">def</span> <span class="nf">RetrieveRefFileInfo</span><span class="p">():</span>
  978     <span class="sd">&quot;&quot;&quot;Retrieve information for ref file.&quot;&quot;&quot;</span>
  979 
  980     <span class="n">RefFileInfo</span> <span class="o">=</span> <span class="p">{}</span>
  981     <span class="k">if</span> <span class="ow">not</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Align&quot;</span><span class="p">]:</span>
  982         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RefFileInfo</span>
  983         <span class="k">return</span>
  984 
  985     <span class="n">RefFile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileName&quot;</span><span class="p">]</span>
  986     
  987     <span class="n">FileDir</span><span class="p">,</span> <span class="n">FileName</span><span class="p">,</span> <span class="n">FileExt</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ParseFileName</span><span class="p">(</span><span class="n">RefFile</span><span class="p">)</span>
  988     <span class="n">RefFileRoot</span> <span class="o">=</span> <span class="n">FileName</span>
  989     
  990     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^FirstInputFile$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignRefFile&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  991         <span class="n">ChainsAndLigandInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
  992     <span class="k">else</span><span class="p">:</span>
  993         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Retrieving chain and ligand information for alignment reference file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">RefFile</span><span class="p">)</span>
  994         <span class="n">ChainsAndLigandInfo</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">GetChainsAndLigandsInfo</span><span class="p">(</span><span class="n">RefFile</span><span class="p">,</span> <span class="n">RefFileRoot</span><span class="p">)</span>
  995 
  996     <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;RefFileName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RefFile</span>
  997     <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;RefFileRoot&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RefFileRoot</span>
  998     <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;PyMOLObjectName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;AlignRef_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">RefFileRoot</span>
  999     <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainsAndLigandInfo</span>
 1000     
 1001     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RefFileInfo</span>
 1002 
 1003 <span class="k">def</span> <span class="nf">ProcessChainAndLigandIDs</span><span class="p">():</span>
 1004     <span class="sd">&quot;&quot;&quot;Process specified chain and ligand IDs for infiles.&quot;&quot;&quot;</span>
 1005     
 1006     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1007     
 1008     <span class="k">for</span> <span class="n">FileIndex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">])):</span>
 1009         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Processing specified chain and ligand IDs for input file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">])</span>
 1010         
 1011         <span class="n">ChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
 1012         <span class="n">SpecifiedChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">ProcessChainsAndLigandsOptionsInfo</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">,</span> <span class="s2">&quot;-c, --chainIDs&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">],</span> <span class="s2">&quot;-l, --ligandIDs&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">])</span>
 1013         <span class="n">ProcessResidueTypesAndSurfaceOptions</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">)</span>
 1014         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">)</span>
 1015         
 1016         <span class="n">CheckPresenceOfValidLigandIDs</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">,</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">)</span>
 1017         
 1018 <span class="k">def</span> <span class="nf">ProcessResidueTypesAndSurfaceOptions</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">):</span>
 1019     <span class="sd">&quot;&quot;&quot;Process residue types and surface options for chains and pockets.&quot;&quot;&quot;</span>
 1020 
 1021     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSurfaces&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1022     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChain&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1023     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainElectrostatics&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1024     
 1025     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;PocketSurfaces&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1026     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfacePocket&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1027     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfacePocketElectrostatics&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1028     
 1029     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesChain&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1030     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesPocket&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1031 
 1032     <span class="c1"># Load infile...</span>
 1033     <span class="n">Infile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
 1034     <span class="n">MolName</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesRoots&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
 1035     <span class="n">pymol</span><span class="o">.</span><span class="n">cmd</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">Infile</span><span class="p">,</span> <span class="n">MolName</span><span class="p">)</span>
 1036     
 1037     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
 1038         <span class="n">AminoAcidsPresent</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">AreAminoAcidResiduesPresent</span><span class="p">(</span><span class="n">MolName</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
 1039 
 1040         <span class="c1"># Process surfaces for chains...</span>
 1041         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChain&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1042             <span class="n">SurfaceChain</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">AminoAcidsPresent</span> <span class="k">else</span> <span class="bp">False</span>
 1043         <span class="k">else</span><span class="p">:</span>
 1044             <span class="n">SurfaceChain</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^yes$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChain&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1045         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChain&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SurfaceChain</span>
 1046 
 1047         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainElectrostatics&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1048             <span class="n">SurfaceChainElectrostatics</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">AminoAcidsPresent</span> <span class="k">else</span> <span class="bp">False</span>
 1049         <span class="k">else</span><span class="p">:</span>
 1050             <span class="n">SurfaceChainElectrostatics</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^yes$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainElectrostatics&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1051         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainElectrostatics&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SurfaceChainElectrostatics</span>
 1052         
 1053         <span class="n">ChainSurfaces</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="p">(</span><span class="n">SurfaceChain</span> <span class="ow">or</span> <span class="n">SurfaceChainElectrostatics</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1054         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSurfaces&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainSurfaces</span>
 1055         
 1056         <span class="c1"># Process residue types for chains...</span>
 1057         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesChain&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1058             <span class="n">ResidueTypesChain</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">AminoAcidsPresent</span> <span class="k">else</span> <span class="bp">False</span>
 1059         <span class="k">else</span><span class="p">:</span>
 1060             <span class="n">ResidueTypesChain</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^yes$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesChain&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1061         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesChain&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResidueTypesChain</span>
 1062 
 1063         <span class="c1"># Process residue types and surfaces for pockets...</span>
 1064         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;PocketSurfaces&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1065         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfacePocket&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1066         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfacePocketElectrostatics&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1067         
 1068         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesPocket&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1069         
 1070         <span class="k">for</span> <span class="n">LigandID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]:</span>
 1071             <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketSurface&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1072                 <span class="n">PocketSurface</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">AminoAcidsPresent</span> <span class="k">else</span> <span class="bp">False</span>
 1073             <span class="k">else</span><span class="p">:</span>
 1074                 <span class="n">PocketSurface</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^yes$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketSurface&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1075             <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfacePocket&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">]</span> <span class="o">=</span> <span class="n">PocketSurface</span>
 1076             
 1077             <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketSurfaceElectrostatics&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1078                 <span class="n">PocketSurfaceElectrostatics</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">AminoAcidsPresent</span> <span class="k">else</span> <span class="bp">False</span>
 1079             <span class="k">else</span><span class="p">:</span>
 1080                 <span class="n">PocketSurfaceElectrostatics</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^yes$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketSurfaceElectrostatics&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1081             <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfacePocketElectrostatics&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">]</span> <span class="o">=</span> <span class="n">PocketSurfaceElectrostatics</span>
 1082 
 1083             <span class="n">PocketSurfaces</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="p">(</span><span class="n">PocketSurface</span> <span class="ow">or</span> <span class="n">PocketSurfaceElectrostatics</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1084             <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;PocketSurfaces&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">]</span> <span class="o">=</span> <span class="n">PocketSurfaces</span>
 1085         
 1086             <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketResidueTypes&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1087                 <span class="n">PocketResidueTypes</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">AminoAcidsPresent</span> <span class="k">else</span> <span class="bp">False</span>
 1088             <span class="k">else</span><span class="p">:</span>
 1089                 <span class="n">PocketResidueTypes</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^yes$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketResidueTypes&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1090             <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesPocket&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">]</span> <span class="o">=</span> <span class="n">PocketResidueTypes</span>
 1091     
 1092     <span class="c1"># Delete loaded object...</span>
 1093     <span class="n">pymol</span><span class="o">.</span><span class="n">cmd</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">MolName</span><span class="p">)</span>
 1094 
 1095 <span class="k">def</span> <span class="nf">GetChainAloneResidueTypesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1096     <span class="sd">&quot;&quot;&quot;Get status of residue types for chain alone object.&quot;&quot;&quot;</span>
 1097 
 1098     <span class="n">Status</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;ResidueTypesChain&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="k">else</span> <span class="bp">False</span>
 1099     
 1100     <span class="k">return</span> <span class="n">Status</span>
 1101 
 1102 <span class="k">def</span> <span class="nf">GetPocketResidueTypesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
 1103     <span class="sd">&quot;&quot;&quot;Get status of residue types for a pocket.&quot;&quot;&quot;</span>
 1104 
 1105     <span class="k">return</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;ResidueTypesPocket&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">]</span>
 1106 
 1107 <span class="k">def</span> <span class="nf">GetChainAloneContainsSurfacesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1108     <span class="sd">&quot;&quot;&quot;Get status of surfaces present in chain alone object.&quot;&quot;&quot;</span>
 1109 
 1110     <span class="k">return</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;ChainSurfaces&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
 1111 
 1112 <span class="k">def</span> <span class="nf">GetPocketContainsSurfaceStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
 1113     <span class="sd">&quot;&quot;&quot;Get status of surfaces present in a pocket.&quot;&quot;&quot;</span>
 1114 
 1115     <span class="k">return</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;PocketSurfaces&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">]</span>
 1116 
 1117 <span class="k">def</span> <span class="nf">GetChainAloneSurfaceChainStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1118     <span class="sd">&quot;&quot;&quot;Get status of hydrophobic surfaces for chain alone object.&quot;&quot;&quot;</span>
 1119 
 1120     <span class="k">return</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;SurfaceChain&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
 1121 
 1122 <span class="k">def</span> <span class="nf">GetChainAloneSurfaceChainElectrostaticsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1123     <span class="sd">&quot;&quot;&quot;Get status of electrostatics surfaces for chain alone object.&quot;&quot;&quot;</span>
 1124 
 1125     <span class="k">return</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;SurfaceChainElectrostatics&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
 1126 
 1127 <span class="k">def</span> <span class="nf">GetPocketSurfaceChainStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
 1128     <span class="sd">&quot;&quot;&quot;Get status of hydrophobic surfaces for a pocket.&quot;&quot;&quot;</span>
 1129 
 1130     <span class="k">return</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;SurfacePocket&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">]</span>
 1131 
 1132 <span class="k">def</span> <span class="nf">GetPocketSurfaceChainElectrostaticsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
 1133     <span class="sd">&quot;&quot;&quot;Get status of hydrophobic surfaces for a pocket.&quot;&quot;&quot;</span>
 1134 
 1135     <span class="k">return</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;SurfacePocketElectrostatics&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">]</span>
 1136 
 1137 <span class="k">def</span> <span class="nf">CheckPresenceOfValidLigandIDs</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">,</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">):</span>
 1138     <span class="sd">&quot;&quot;&quot;Check presence of valid ligand IDs.&quot;&quot;&quot;</span>
 1139 
 1140     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Specified chain IDs: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">])))</span>
 1141     
 1142     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
 1143         <span class="k">if</span> <span class="nb">len</span> <span class="p">(</span><span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]):</span>
 1144             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Chain ID: </span><span class="si">%s</span><span class="s2">; Specified LigandIDs: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">])))</span>
 1145         <span class="k">else</span><span class="p">:</span>
 1146             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Chain IDs: </span><span class="si">%s</span><span class="s2">; Specified LigandIDs: None&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">))</span>
 1147             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;No valid ligand IDs found for chain ID, </span><span class="si">%s</span><span class="s2">. PyMOL groups and objects related to ligand and binding pockect won&#39;t be created.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">))</span>
 1148 
 1149 <span class="k">def</span> <span class="nf">RetrieveFirstChainID</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">):</span>
 1150     <span class="sd">&quot;&quot;&quot;Get first chain ID.&quot;&quot;&quot;</span>
 1151     
 1152     <span class="n">ChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
 1153     
 1154     <span class="n">FirstChainID</span> <span class="o">=</span> <span class="bp">None</span>
 1155     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]):</span>
 1156         <span class="n">FirstChainID</span> <span class="o">=</span> <span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
 1157     
 1158     <span class="k">return</span> <span class="n">FirstChainID</span>
 1159 
 1160 <span class="k">def</span> <span class="nf">ProcessResidueTypes</span><span class="p">():</span>
 1161     <span class="sd">&quot;&quot;&quot;Process residue types. &quot;&quot;&quot;</span>
 1162 
 1163     <span class="c1"># Set up  default values for residue types, colors, and names.</span>
 1164     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesNames&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Aromatic&quot;</span><span class="p">,</span> <span class="s2">&quot;Hydrophobic&quot;</span><span class="p">,</span> <span class="s2">&quot;Polar&quot;</span><span class="p">,</span> <span class="s2">&quot;Positively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Negatively_Charged&quot;</span><span class="p">]</span>
 1165     
 1166     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesParams&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1167     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesParams&quot;</span><span class="p">][</span><span class="s2">&quot;Aromatic&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Color&quot;</span><span class="p">:</span> <span class="s2">&quot;brightorange&quot;</span><span class="p">,</span> <span class="s2">&quot;Residues&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;HIS&quot;</span><span class="p">,</span> <span class="s2">&quot;PHE&quot;</span><span class="p">,</span> <span class="s2">&quot;TRP&quot;</span><span class="p">,</span> <span class="s2">&quot;TYR&quot;</span><span class="p">]}</span>
 1168     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesParams&quot;</span><span class="p">][</span><span class="s2">&quot;Hydrophobic&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Color&quot;</span><span class="p">:</span> <span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="s2">&quot;Residues&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;ALA&quot;</span><span class="p">,</span> <span class="s2">&quot;GLY&quot;</span><span class="p">,</span> <span class="s2">&quot;VAL&quot;</span><span class="p">,</span> <span class="s2">&quot;LEU&quot;</span><span class="p">,</span> <span class="s2">&quot;ILE&quot;</span><span class="p">,</span> <span class="s2">&quot;PRO&quot;</span><span class="p">,</span> <span class="s2">&quot;MET&quot;</span><span class="p">]}</span>
 1169     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesParams&quot;</span><span class="p">][</span><span class="s2">&quot;Polar&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Color&quot;</span><span class="p">:</span> <span class="s2">&quot;palegreen&quot;</span><span class="p">,</span> <span class="s2">&quot;Residues&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;ASN&quot;</span><span class="p">,</span> <span class="s2">&quot;GLN&quot;</span><span class="p">,</span> <span class="s2">&quot;SER&quot;</span><span class="p">,</span> <span class="s2">&quot;THR&quot;</span><span class="p">,</span> <span class="s2">&quot;CYS&quot;</span><span class="p">]}</span>
 1170     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesParams&quot;</span><span class="p">][</span><span class="s2">&quot;Positively_Charged&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Color&quot;</span><span class="p">:</span> <span class="s2">&quot;marine&quot;</span><span class="p">,</span> <span class="s2">&quot;Residues&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;ARG&quot;</span><span class="p">,</span> <span class="s2">&quot;LYS&quot;</span><span class="p">]}</span>
 1171     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesParams&quot;</span><span class="p">][</span><span class="s2">&quot;Negatively_Charged&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Color&quot;</span><span class="p">:</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;Residues&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;ASP&quot;</span><span class="p">,</span> <span class="s2">&quot;GLU&quot;</span><span class="p">]}</span>
 1172     
 1173     <span class="n">ResidueTypes</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypes&quot;</span><span class="p">]</span>
 1174     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypes&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1175         <span class="n">SetupOtherResidueTypes</span><span class="p">()</span>
 1176         <span class="k">return</span>
 1177     
 1178     <span class="c1"># Parse specified residue types...</span>
 1179     <span class="n">ResidueTypesWords</span> <span class="o">=</span> <span class="n">ResidueTypes</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
 1180     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ResidueTypesWords</span><span class="p">)</span> <span class="o">%</span> <span class="mi">3</span><span class="p">:</span>
 1181         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The number of comma delimited residue type, color, and name triplets, </span><span class="si">%d</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">-r, --residueTypes</span><span class="se">\&quot;</span><span class="s2"> option must be a multple of 3.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ResidueTypesWords</span><span class="p">)))</span>
 1182 
 1183     <span class="c1"># Set up canonical residue type names...</span>
 1184     <span class="n">ValidResidueTypeNames</span> <span class="o">=</span> <span class="p">[]</span>
 1185     <span class="n">CanonicalResidueTypeNamesMap</span> <span class="o">=</span> <span class="p">{}</span>
 1186     <span class="k">for</span> <span class="n">Name</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesNames&quot;</span><span class="p">]):</span>
 1187         <span class="n">ValidResidueTypeNames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1188         <span class="n">CanonicalResidueTypeNamesMap</span><span class="p">[</span><span class="n">Name</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="n">Name</span>
 1189 
 1190     <span class="c1"># Validate and set residue types, colors, and names..</span>
 1191     <span class="k">for</span> <span class="n">Index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ResidueTypesWords</span><span class="p">),</span> <span class="mi">3</span><span class="p">):</span>
 1192         <span class="n">TypeName</span> <span class="o">=</span> <span class="n">ResidueTypesWords</span><span class="p">[</span><span class="n">Index</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1193         <span class="n">ResidueTypeColor</span> <span class="o">=</span> <span class="n">ResidueTypesWords</span><span class="p">[</span><span class="n">Index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1194         <span class="n">ResidueNames</span> <span class="o">=</span> <span class="n">ResidueTypesWords</span><span class="p">[</span><span class="n">Index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1195         
 1196         <span class="n">ResidueNames</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;[ ]+&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">ResidueNames</span><span class="p">)</span>
 1197         <span class="n">ResidueNamesWords</span> <span class="o">=</span> <span class="n">ResidueNames</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
 1198 
 1199         <span class="n">CanonicalTypeName</span> <span class="o">=</span> <span class="n">TypeName</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
 1200         <span class="k">if</span> <span class="ow">not</span> <span class="n">CanonicalTypeName</span> <span class="ow">in</span> <span class="n">CanonicalResidueTypeNamesMap</span><span class="p">:</span>
 1201             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The residue type, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">-r, --residueTypes</span><span class="se">\&quot;</span><span class="s2"> option is not a valid type. Supported residue types: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">TypeName</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ValidResidueTypeNames</span><span class="p">)))</span>
 1202         <span class="n">ResidueTypeName</span> <span class="o">=</span> <span class="n">CanonicalResidueTypeNamesMap</span><span class="p">[</span><span class="n">CanonicalTypeName</span><span class="p">]</span>
 1203 
 1204         <span class="k">if</span> <span class="ow">not</span> <span class="n">ResidueTypeColor</span><span class="p">:</span>
 1205             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;No color name specified for residue type, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="s2">-r, --residueTypes</span><span class="se">\&quot;</span><span class="s2"> option, </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">TypeName</span><span class="p">,</span> <span class="n">ResidueTypes</span><span class="p">))</span>
 1206         
 1207         <span class="k">if</span> <span class="ow">not</span> <span class="n">ResidueNames</span><span class="p">:</span>
 1208             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;No residue names specified for residue type, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="s2">-r, --residueTypes</span><span class="se">\&quot;</span><span class="s2"> option, </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">TypeName</span><span class="p">,</span> <span class="n">ResidueTypes</span><span class="p">))</span>
 1209             
 1210         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesParams&quot;</span><span class="p">][</span><span class="n">ResidueTypeName</span><span class="p">][</span><span class="s2">&quot;Color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResidueTypeColor</span>
 1211         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesParams&quot;</span><span class="p">][</span><span class="n">ResidueTypeName</span><span class="p">][</span><span class="s2">&quot;Residues&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResidueNamesWords</span>
 1212         
 1213         <span class="n">SetupOtherResidueTypes</span><span class="p">()</span>
 1214 
 1215 <span class="k">def</span> <span class="nf">SetupOtherResidueTypes</span><span class="p">():</span>
 1216     <span class="sd">&quot;&quot;&quot;Setup other residue types.&quot;&quot;&quot;</span>
 1217 
 1218     <span class="c1"># Set other residues to all specified residues. The other residues are selected by</span>
 1219     <span class="c1"># performing a negation operation on this list during the creation of PyMOL objects.</span>
 1220     
 1221     <span class="n">ResidueNames</span> <span class="o">=</span> <span class="p">[]</span>
 1222     <span class="k">for</span> <span class="n">ResiduesType</span> <span class="ow">in</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesParams&quot;</span><span class="p">]:</span>
 1223         <span class="n">ResidueNames</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesParams&quot;</span><span class="p">][</span><span class="n">ResiduesType</span><span class="p">][</span><span class="s2">&quot;Residues&quot;</span><span class="p">]</span> <span class="p">)</span>
 1224     
 1225     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesParams&quot;</span><span class="p">][</span><span class="s2">&quot;Other&quot;</span><span class="p">]</span><span class="o">=</span> <span class="p">{}</span>
 1226     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesParams&quot;</span><span class="p">][</span><span class="s2">&quot;Other&quot;</span><span class="p">][</span><span class="s2">&quot;Color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
 1227     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesParams&quot;</span><span class="p">][</span><span class="s2">&quot;Other&quot;</span><span class="p">][</span><span class="s2">&quot;Residues&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResidueNames</span>
 1228 
 1229 <span class="k">def</span> <span class="nf">ProcessSurfaceAtomTypesColors</span><span class="p">():</span>
 1230     <span class="sd">&quot;&quot;&quot;Process surface atom types colors. &quot;&quot;&quot;</span>
 1231 
 1232     <span class="c1"># Set up  default values for atom type colors...</span>
 1233     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;HydrophobicAtomsColor&quot;</span><span class="p">:</span> <span class="s2">&quot;yellow&quot;</span><span class="p">,</span> <span class="s2">&quot;NegativelyChargedAtomsColor&quot;</span><span class="p">:</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;PositivelyChargedAtomsColor&quot;</span><span class="p">:</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;OtherAtomsColor&quot;</span><span class="p">:</span> <span class="s2">&quot;gray90&quot;</span><span class="p">}</span>
 1234     
 1235     <span class="n">AtomTypesColors</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceAtomTypesColors&quot;</span><span class="p">]</span>
 1236     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">AtomTypesColors</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1237         <span class="k">return</span>
 1238     
 1239     <span class="c1"># Parse atom type colors and values...</span>
 1240     <span class="n">AtomTypesColorsWords</span> <span class="o">=</span> <span class="n">AtomTypesColors</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
 1241     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">AtomTypesColorsWords</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
 1242         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The number of comma delimited surface atom color types and values, </span><span class="si">%d</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">--surfaceAtomTypesColors</span><span class="se">\&quot;</span><span class="s2"> option must be a multple of 2.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">AtomTypesColorsWords</span><span class="p">)))</span>
 1243 
 1244     <span class="c1"># Set up canonical atom type colors...</span>
 1245     <span class="n">ValidAtomTypesColors</span> <span class="o">=</span> <span class="p">[]</span>
 1246     <span class="n">CanonicalAtomTypesColorsMap</span> <span class="o">=</span> <span class="p">{}</span>
 1247     <span class="k">for</span> <span class="n">Type</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">]):</span>
 1248         <span class="n">ValidAtomTypesColors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Type</span><span class="p">)</span>
 1249         <span class="n">CanonicalAtomTypesColorsMap</span><span class="p">[</span><span class="n">Type</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="n">Type</span>
 1250     
 1251     <span class="c1"># Validate and process specified values...</span>
 1252     <span class="k">for</span> <span class="n">Index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">AtomTypesColorsWords</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
 1253         <span class="n">Type</span> <span class="o">=</span> <span class="n">AtomTypesColorsWords</span><span class="p">[</span><span class="n">Index</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1254         <span class="n">Color</span> <span class="o">=</span> <span class="n">AtomTypesColorsWords</span><span class="p">[</span><span class="n">Index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1255         
 1256         <span class="n">Color</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;[ ]+&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">Color</span><span class="p">)</span>
 1257         <span class="n">ColorWords</span> <span class="o">=</span> <span class="n">Color</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
 1258     
 1259         <span class="n">CanonicalType</span> <span class="o">=</span> <span class="n">Type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
 1260         <span class="k">if</span> <span class="ow">not</span> <span class="n">CanonicalType</span> <span class="ow">in</span> <span class="n">CanonicalAtomTypesColorsMap</span><span class="p">:</span>
 1261             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The surface atom color type, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">--surfaceAtomTypesColors</span><span class="se">\&quot;</span><span class="s2"> option  is not a valid type: Supported atom color types: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Type</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ValidAtomTypesColors</span><span class="p">)))</span>
 1262         <span class="n">Type</span> <span class="o">=</span> <span class="n">CanonicalAtomTypesColorsMap</span><span class="p">[</span><span class="n">CanonicalType</span><span class="p">]</span>
 1263 
 1264         <span class="k">if</span> <span class="ow">not</span> <span class="n">Color</span><span class="p">:</span>
 1265             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;No color type specified for atom color type, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="s2">--surfaceAtomTypesColors</span><span class="se">\&quot;</span><span class="s2"> option.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Type</span><span class="p">))</span>
 1266 
 1267         <span class="n">ColorWordsLen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ColorWords</span><span class="p">)</span>
 1268         <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">ColorWordsLen</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">ColorWordsLen</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>
 1269             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The number, </span><span class="si">%s</span><span class="s2">, of color name or space delimited RGB values, </span><span class="si">%s</span><span class="s2">, specified for atom color type, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="s2">--surfaceAtomTypesColors</span><span class="se">\&quot;</span><span class="s2"> option must be 1 or 3.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ColorWordsLen</span><span class="p">,</span> <span class="n">Color</span><span class="p">,</span> <span class="n">Type</span><span class="p">))</span>
 1270 
 1271         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="n">Type</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ColorWords</span><span class="p">)</span>
 1272         
 1273 <span class="k">def</span> <span class="nf">ProcessOptions</span><span class="p">():</span>
 1274     <span class="sd">&quot;&quot;&quot;Process and validate command line arguments and options&quot;&quot;&quot;</span>
 1275 
 1276     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Processing options...&quot;</span><span class="p">)</span>
 1277     
 1278     <span class="c1"># Validate options...</span>
 1279     <span class="n">ValidateOptions</span><span class="p">()</span>
 1280     
 1281     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Align&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--align&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1282     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignMethod&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignMethod&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
 1283     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignMode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignMode&quot;</span><span class="p">]</span>
 1284     
 1285     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AllowEmptyObjects&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--allowEmptyObjects&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1286 
 1287     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Infiles&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infiles&quot;</span><span class="p">]</span>
 1288     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infileNames&quot;</span><span class="p">]</span>
 1289 
 1290     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignRefFile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignRefFile&quot;</span><span class="p">]</span>
 1291     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^FirstInputFile$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignRefFile&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1292         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
 1293     <span class="k">else</span><span class="p">:</span>
 1294         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignRefFile&quot;</span><span class="p">]</span>
 1295     
 1296     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Overwrite&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--overwrite&quot;</span><span class="p">]</span>
 1297     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--PMLOut&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1298     
 1299     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">]</span>
 1300     <span class="n">FileDir</span><span class="p">,</span> <span class="n">FileName</span><span class="p">,</span> <span class="n">FileExt</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ParseFileName</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">])</span>
 1301     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PSEOut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span> 
 1302     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^pml$&quot;</span><span class="p">,</span> <span class="n">FileExt</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1303         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">]</span> 
 1304         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMEOutfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;.pml$&quot;</span><span class="p">,</span> <span class="s2">&quot;.pme&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">])</span> 
 1305     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^pse$&quot;</span><span class="p">,</span> <span class="n">FileExt</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1306         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PSEOut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> 
 1307         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PSEOutfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">]</span> 
 1308         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;.pse$&quot;</span><span class="p">,</span> <span class="s2">&quot;.pml&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">])</span> 
 1309         <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Overwrite&quot;</span><span class="p">]):</span>
 1310             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The intermediate output file to be generated, </span><span class="si">%s</span><span class="s2">, already exist. Use option </span><span class="se">\&quot;</span><span class="s2">--ov</span><span class="se">\&quot;</span><span class="s2"> or </span><span class="se">\&quot;</span><span class="s2">--overwrite</span><span class="se">\&quot;</span><span class="s2"> and try again.&quot;</span> <span class="o">%</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">]</span> <span class="p">)</span>
 1311 
 1312     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;LabelFontID&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--labelFontID&quot;</span><span class="p">])</span>
 1313     
 1314     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsLigandColor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketContactsLigandColor&quot;</span><span class="p">]</span>
 1315     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsSolventColor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketContactsSolventColor&quot;</span><span class="p">]</span>
 1316     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsInorganicColor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketContactsInorganicColor&quot;</span><span class="p">]</span>
 1317     
 1318     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketDistanceCutoff&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketDistanceCutoff&quot;</span><span class="p">])</span>
 1319     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketLabelColor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketLabelColor&quot;</span><span class="p">]</span>
 1320     
 1321     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketResidueTypes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketResidueTypes&quot;</span><span class="p">]</span>
 1322     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketSurface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketSurface&quot;</span><span class="p">]</span>
 1323     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketSurfaceElectrostatics&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketSurfaceElectrostatics&quot;</span><span class="p">]</span>
 1324     
 1325     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesChain&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--residueTypesChain&quot;</span><span class="p">]</span>
 1326     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--residueTypes&quot;</span><span class="p">]</span>
 1327     <span class="n">ProcessResidueTypes</span><span class="p">()</span>
 1328     
 1329     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChain&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceChain&quot;</span><span class="p">]</span>
 1330     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainElectrostatics&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceChainElectrostatics&quot;</span><span class="p">]</span>
 1331     
 1332     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainComplex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceChainComplex&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1333     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceComplex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceComplex&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1334     
 1335     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceColorPalette&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceColorPalette&quot;</span><span class="p">]</span>
 1336     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceAtomTypesColors&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceAtomTypesColors&quot;</span><span class="p">]</span>
 1337     <span class="n">ProcessSurfaceAtomTypesColors</span><span class="p">()</span>
 1338     
 1339     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceTransparency&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceTransparency&quot;</span><span class="p">])</span>
 1340     
 1341     <span class="n">RetrieveInfilesInfo</span><span class="p">()</span>
 1342     <span class="n">RetrieveRefFileInfo</span><span class="p">()</span>
 1343     
 1344     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--chainIDs&quot;</span><span class="p">]</span>
 1345     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--ligandIDs&quot;</span><span class="p">]</span>
 1346     
 1347     <span class="n">ProcessChainAndLigandIDs</span><span class="p">()</span>
 1348 
 1349 <span class="k">def</span> <span class="nf">RetrieveOptions</span><span class="p">():</span> 
 1350     <span class="sd">&quot;&quot;&quot;Retrieve command line arguments and options&quot;&quot;&quot;</span>
 1351     
 1352     <span class="c1"># Get options...</span>
 1353     <span class="k">global</span> <span class="n">Options</span>
 1354     <span class="n">Options</span> <span class="o">=</span> <span class="n">docopt</span><span class="p">(</span><span class="n">_docoptUsage_</span><span class="p">)</span>
 1355 
 1356     <span class="c1"># Set current working directory to the specified directory...</span>
 1357     <span class="n">WorkingDir</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--workingdir&quot;</span><span class="p">]</span>
 1358     <span class="k">if</span> <span class="n">WorkingDir</span><span class="p">:</span>
 1359         <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">WorkingDir</span><span class="p">)</span>
 1360     
 1361     <span class="c1"># Handle examples option...</span>
 1362     <span class="k">if</span> <span class="s2">&quot;--examples&quot;</span> <span class="ow">in</span> <span class="n">Options</span> <span class="ow">and</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--examples&quot;</span><span class="p">]:</span>
 1363         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="n">MiscUtil</span><span class="o">.</span><span class="n">GetExamplesTextFromDocOptText</span><span class="p">(</span><span class="n">_docoptUsage_</span><span class="p">))</span>
 1364         <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
 1365 
 1366 <span class="k">def</span> <span class="nf">ValidateOptions</span><span class="p">():</span>
 1367     <span class="sd">&quot;&quot;&quot;Validate option values&quot;&quot;&quot;</span>
 1368     
 1369     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--align&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--align&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1370     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--alignMethod&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignMethod&quot;</span><span class="p">],</span> <span class="s2">&quot;align cealign super&quot;</span><span class="p">)</span>
 1371     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--alignMode&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignMode&quot;</span><span class="p">],</span> <span class="s2">&quot;FirstChain Complex&quot;</span><span class="p">)</span>
 1372     
 1373     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--allowEmptyObjects&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--allowEmptyObjects&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1374 
 1375     <span class="c1"># Expand infiles to handle presence of multiple input files...</span>
 1376     <span class="n">InfileNames</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ExpandFileNames</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infiles&quot;</span><span class="p">],</span> <span class="s2">&quot;,&quot;</span><span class="p">)</span>
 1377     <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">InfileNames</span><span class="p">):</span>
 1378         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;No input files specified for </span><span class="se">\&quot;</span><span class="s2">-i, --infiles</span><span class="se">\&quot;</span><span class="s2"> option&quot;</span><span class="p">)</span>
 1379 
 1380     <span class="c1"># Validate file extensions...</span>
 1381     <span class="k">for</span> <span class="n">Infile</span> <span class="ow">in</span> <span class="n">InfileNames</span><span class="p">:</span>
 1382         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFilePath</span><span class="p">(</span><span class="s2">&quot;-i, --infiles&quot;</span><span class="p">,</span> <span class="n">Infile</span><span class="p">)</span>
 1383         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFileExt</span><span class="p">(</span><span class="s2">&quot;-i, --infiles&quot;</span><span class="p">,</span> <span class="n">Infile</span><span class="p">,</span> <span class="s2">&quot;pdb cif&quot;</span><span class="p">)</span>
 1384         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionsDistinctFileNames</span><span class="p">(</span><span class="s2">&quot;-i, --infiles&quot;</span><span class="p">,</span> <span class="n">Infile</span><span class="p">,</span> <span class="s2">&quot;-o, --outfile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">])</span>
 1385     <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infileNames&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">InfileNames</span>
 1386     
 1387     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFileExt</span><span class="p">(</span><span class="s2">&quot;-o, --outfile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">],</span> <span class="s2">&quot;pml pse&quot;</span><span class="p">)</span>
 1388     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionsOutputFileOverwrite</span><span class="p">(</span><span class="s2">&quot;-o, --outfile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">],</span> <span class="s2">&quot;--overwrite&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--overwrite&quot;</span><span class="p">])</span>
 1389 
 1390     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--align&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1391         <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^FirstInputFile$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignRefFile&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1392             <span class="n">AlignRefFile</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignRefFile&quot;</span><span class="p">]</span>
 1393             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFilePath</span><span class="p">(</span><span class="s2">&quot;--alignRefFile&quot;</span><span class="p">,</span> <span class="n">AlignRefFile</span><span class="p">)</span>
 1394             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFileExt</span><span class="p">(</span><span class="s2">&quot;--alignRefFile&quot;</span><span class="p">,</span> <span class="n">AlignRefFile</span><span class="p">,</span> <span class="s2">&quot;pdb cif&quot;</span><span class="p">)</span>
 1395             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionsDistinctFileNames</span><span class="p">(</span><span class="s2">&quot;--AlignRefFile&quot;</span><span class="p">,</span> <span class="n">AlignRefFile</span><span class="p">,</span> <span class="s2">&quot;-o, --outfile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">])</span>
 1396     
 1397     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--PMLOut&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--PMLOut&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1398     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionIntegerValue</span><span class="p">(</span><span class="s2">&quot;--labelFontID&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--labelFontID&quot;</span><span class="p">],</span> <span class="p">{})</span>
 1399 
 1400     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFloatValue</span><span class="p">(</span><span class="s2">&quot;--pocketDistanceCutoff&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketDistanceCutoff&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;&gt;&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">})</span>
 1401     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--pocketResidueTypes&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketResidueTypes&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no auto&quot;</span><span class="p">)</span>
 1402     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--pocketSurface&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketSurface&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no auto&quot;</span><span class="p">)</span>
 1403     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--pocketSurfaceElectrostatics&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketSurfaceElectrostatics&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no auto&quot;</span><span class="p">)</span>
 1404     
 1405     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--residueTypesChain&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--residueTypesChain&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no auto&quot;</span><span class="p">)</span>
 1406     
 1407     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--surfaceComplex&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceComplex&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1408     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--surfaceChainComplex&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceChainComplex&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1409     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--surfaceChain&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceChain&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no auto&quot;</span><span class="p">)</span>
 1410     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--surfaceChainElectrostatics&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceChainElectrostatics&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no auto&quot;</span><span class="p">)</span>
 1411     
 1412     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--surfaceColorPalette&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceColorPalette&quot;</span><span class="p">],</span> <span class="s2">&quot;RedToWhite WhiteToGreen&quot;</span><span class="p">)</span>
 1413     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFloatValue</span><span class="p">(</span><span class="s2">&quot;--surfaceTransparency&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceTransparency&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;&gt;=&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;&lt;=&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">})</span>
 1414     
 1415 <span class="c1"># Setup a usage string for docopt...</span>
 1416 <span class="n">_docoptUsage_</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
 1417 <span class="s2">PyMOLVisualizeMacromolecules.py - Visualize macromolecules</span>
 1418 
 1419 <span class="s2">Usage:</span>
 1420 <span class="s2">    PyMOLVisualizeMacromolecules.py [--align &lt;yes or no&gt;] [--alignMethod &lt;align, cealign, super&gt;]</span>
 1421 <span class="s2">                                    [--alignMode &lt;FirstChain or Complex&gt;] [--alignRefFile &lt;filename&gt;]</span>
 1422 <span class="s2">                                    [--allowEmptyObjects &lt;yes or no&gt;] [--chainIDs &lt;First, All or ID1,ID2...&gt;]</span>
 1423 <span class="s2">                                    [--ligandIDs &lt;Largest, All or ID1,ID2...&gt;] [--labelFontID &lt;number&gt;]</span>
 1424 <span class="s2">                                    [--PMLOut &lt;yes or no&gt;] [--pocketContactsInorganicColor &lt;text&gt;]</span>
 1425 <span class="s2">                                    [--pocketContactsLigandColor &lt;text&gt;] [--pocketContactsSolventColor &lt;text&gt;]</span>
 1426 <span class="s2">                                    [--pocketDistanceCutoff &lt;number&gt;] [--pocketLabelColor &lt;text&gt;] [--pocketResidueTypes &lt;yes or no&gt;]</span>
 1427 <span class="s2">                                    [--pocketSurface &lt;yes or no&gt;] [--pocketSurfaceElectrostatics &lt;yes or no&gt;]</span>
 1428 <span class="s2">                                    [--residueTypes &lt;Type,Color,ResNames,...&gt;] [--residueTypesChain &lt;yes or no&gt;]</span>
 1429 <span class="s2">                                    [--surfaceChain &lt;yes or no&gt;] [--surfaceChainElectrostatics &lt;yes or no&gt;]</span>
 1430 <span class="s2">                                    [--surfaceChainComplex &lt;yes or no&gt;] [--surfaceComplex &lt;yes or no&gt;]</span>
 1431 <span class="s2">                                    [--surfaceColorPalette &lt;RedToWhite or WhiteToGreen&gt;]</span>
 1432 <span class="s2">                                    [--surfaceAtomTypesColors &lt;ColorType,ColorSpec,...&gt;]</span>
 1433 <span class="s2">                                    [--surfaceTransparency &lt;number&gt;] [--overwrite] [-w &lt;dir&gt;] -i &lt;infile1,infile2,infile3...&gt; -o &lt;outfile&gt;</span>
 1434 <span class="s2">    PyMOLVisualizeMacromolecules.py -h | --help | -e | --examples</span>
 1435 
 1436 <span class="s2">Description:</span>
 1437 <span class="s2">    Generate PyMOL visualization files for viewing surfaces, chains, ligands, ligand</span>
 1438 <span class="s2">    binding pockets, and interactions between ligands and binding pockets in</span>
 1439 <span class="s2">    macromolecules including proteins and nucleic acids.</span>
 1440 
 1441 <span class="s2">    The supported input file format are: PDB (.pdb), CIF (.cif)</span>
 1442 
 1443 <span class="s2">    The supported output file formats are: PyMOL script file (.pml), PyMOL session</span>
 1444 <span class="s2">    file (.pse)</span>
 1445 
 1446 <span class="s2">    A variety of PyMOL groups and objects may be  created for visualization of</span>
 1447 <span class="s2">    macromolecules. These groups and objects correspond to complexes, surfaces,</span>
 1448 <span class="s2">    chains, ligands, inorganics, ligand binding pockets, pocket, polar interactions,</span>
 1449 <span class="s2">    and pocket hydrophobic surfaces. A complete hierarchy of all possible PyMOL</span>
 1450 <span class="s2">    groups and objects is shown below:</span>
 1451 <span class="s2">    </span>
 1452 <span class="s2">        &lt;PDBFileRoot&gt;</span>
 1453 <span class="s2">            .Complex</span>
 1454 <span class="s2">                .Complex</span>
 1455 <span class="s2">                .Surface</span>
 1456 <span class="s2">            .Chain&lt;ID&gt;</span>
 1457 <span class="s2">                .Complex</span>
 1458 <span class="s2">                    .Complex</span>
 1459 <span class="s2">                    .Surface</span>
 1460 <span class="s2">                .Chain</span>
 1461 <span class="s2">                    .Chain</span>
 1462 <span class="s2">                    .Residues</span>
 1463 <span class="s2">                        .Aromatic</span>
 1464 <span class="s2">                            .Residues</span>
 1465 <span class="s2">                            .Surface</span>
 1466 <span class="s2">                        .Hydrophobic</span>
 1467 <span class="s2">                            .Residues</span>
 1468 <span class="s2">                            .Surface</span>
 1469 <span class="s2">                        .Polar</span>
 1470 <span class="s2">                            .Residues</span>
 1471 <span class="s2">                            .Surface</span>
 1472 <span class="s2">                        .Positively_Charged</span>
 1473 <span class="s2">                            .Residues</span>
 1474 <span class="s2">                            .Surface</span>
 1475 <span class="s2">                        .Negatively_Charged</span>
 1476 <span class="s2">                            .Residues</span>
 1477 <span class="s2">                            .Surface</span>
 1478 <span class="s2">                        .Other</span>
 1479 <span class="s2">                            .Residues</span>
 1480 <span class="s2">                            .Surface</span>
 1481 <span class="s2">                    .Surface</span>
 1482 <span class="s2">                        .Hydrophobicity</span>
 1483 <span class="s2">                        .Hydrophobicity_Charge</span>
 1484 <span class="s2">                        .Vacuum_Electrostatics</span>
 1485 <span class="s2">                            .Contact_Potentials</span>
 1486 <span class="s2">                            .Map</span>
 1487 <span class="s2">                            .Legend</span>
 1488 <span class="s2">                            .Volume</span>
 1489 <span class="s2">                .Solvent</span>
 1490 <span class="s2">                .Inorganic</span>
 1491 <span class="s2">                .Ligand&lt;ID&gt;</span>
 1492 <span class="s2">                    .Ligand</span>
 1493 <span class="s2">                        .Ligand</span>
 1494 <span class="s2">                        .BallAndStick</span>
 1495 <span class="s2">                    .Pocket</span>
 1496 <span class="s2">                        .Pocket</span>
 1497 <span class="s2">                        .Polar_Contacts</span>
 1498 <span class="s2">                        .Residues</span>
 1499 <span class="s2">                            .Aromatic</span>
 1500 <span class="s2">                                .Residues</span>
 1501 <span class="s2">                                .Surface</span>
 1502 <span class="s2">                            .Hydrophobic</span>
 1503 <span class="s2">                                .Residues</span>
 1504 <span class="s2">                                .Surface</span>
 1505 <span class="s2">                            .Polar</span>
 1506 <span class="s2">                                .Residues</span>
 1507 <span class="s2">                                .Surface</span>
 1508 <span class="s2">                            .Positively_Charged</span>
 1509 <span class="s2">                                .Residues</span>
 1510 <span class="s2">                                .Surface</span>
 1511 <span class="s2">                            .Negatively_Charged</span>
 1512 <span class="s2">                                .Residues</span>
 1513 <span class="s2">                                .Surface</span>
 1514 <span class="s2">                            .Other</span>
 1515 <span class="s2">                                .Residues</span>
 1516 <span class="s2">                                .Surface</span>
 1517 <span class="s2">                        .Surface</span>
 1518 <span class="s2">                            .Hydrophobicity</span>
 1519 <span class="s2">                            .Hydrophobicity_Charge</span>
 1520 <span class="s2">                            .Vacuum_Electrostatics</span>
 1521 <span class="s2">                                .Contact_Potentials</span>
 1522 <span class="s2">                                .Map</span>
 1523 <span class="s2">                                .Legend</span>
 1524 <span class="s2">                    .Pocket_Solvent</span>
 1525 <span class="s2">                        .Pocket_Solvent</span>
 1526 <span class="s2">                        .Polar_Contacts</span>
 1527 <span class="s2">                    .Pocket_Inorganic</span>
 1528 <span class="s2">                        .Pocket_Inorganic</span>
 1529 <span class="s2">                        .Polar_Contacts</span>
 1530 <span class="s2">                .Ligand&lt;ID&gt;</span>
 1531 <span class="s2">                    .Ligand</span>
 1532 <span class="s2">                        ... ... ...</span>
 1533 <span class="s2">                    .Pocket</span>
 1534 <span class="s2">                        ... ... ...</span>
 1535 <span class="s2">                    .Pocket_Solvent</span>
 1536 <span class="s2">                        ... ... ...</span>
 1537 <span class="s2">                    .Pocket_Inorganic</span>
 1538 <span class="s2">                        ... ... ...</span>
 1539 <span class="s2">            .Chain&lt;ID&gt;</span>
 1540 <span class="s2">                ... ... ...</span>
 1541 <span class="s2">                .Ligand&lt;ID&gt;</span>
 1542 <span class="s2">                    ... ... ...</span>
 1543 <span class="s2">                .Ligand&lt;ID&gt;</span>
 1544 <span class="s2">                    ... ... ...</span>
 1545 <span class="s2">            .Chain&lt;ID&gt;</span>
 1546 <span class="s2">                ... ... ...</span>
 1547 <span class="s2">        &lt;PDBFileRoot&gt;</span>
 1548 <span class="s2">            .Complex</span>
 1549 <span class="s2">                ... ... ...</span>
 1550 <span class="s2">            .Chain&lt;ID&gt;</span>
 1551 <span class="s2">                ... ... ...</span>
 1552 <span class="s2">                .Ligand&lt;ID&gt;</span>
 1553 <span class="s2">                    ... ... ...</span>
 1554 <span class="s2">                .Ligand&lt;ID&gt;</span>
 1555 <span class="s2">                    ... ... ...</span>
 1556 <span class="s2">            .Chain&lt;ID&gt;</span>
 1557 <span class="s2">                ... ... ...</span>
 1558 <span class="s2">    </span>
 1559 <span class="s2">    The hydrophobic surfaces are not cerated for complete complex and chain complex</span>
 1560 <span class="s2">    in input file(s) by default. A word to the wise: The creation of surface objects may</span>
 1561 <span class="s2">    slow down loading of PML file and generation of PSE file, based on the size of input</span>
 1562 <span class="s2">    complexes. The generation of PSE file may also fail.</span>
 1563 
 1564 <span class="s2">Options:</span>
 1565 <span class="s2">    -a, --align &lt;yes or no&gt;  [default: no]</span>
 1566 <span class="s2">        Align input files to a reference file before visualization.</span>
 1567 <span class="s2">    --alignMethod &lt;align, cealign, super&gt;  [default: super]</span>
 1568 <span class="s2">        Alignment methodology to use for aligning input files to a</span>
 1569 <span class="s2">        reference file.</span>
 1570 <span class="s2">    --alignMode &lt;FirstChain or Complex&gt;  [default: FirstChain]</span>
 1571 <span class="s2">        Portion of input and reference files to use for spatial alignment of</span>
 1572 <span class="s2">        input files against reference file.  Possible values: FirstChain or</span>
 1573 <span class="s2">        Complex.</span>
 1574 <span class="s2">        </span>
 1575 <span class="s2">        The FirstChain mode allows alignment of the first chain in each input</span>
 1576 <span class="s2">        file to the first chain in the reference file along with moving the rest</span>
 1577 <span class="s2">        of the complex to coordinate space of the reference file. The complete</span>
 1578 <span class="s2">        complex in each input file is aligned to the complete complex in reference</span>
 1579 <span class="s2">        file for the Complex mode.</span>
 1580 <span class="s2">    --alignRefFile &lt;filename&gt;  [default: FirstInputFile]</span>
 1581 <span class="s2">        Reference input file name. The default is to use the first input file</span>
 1582 <span class="s2">        name specified using &#39;-i, --infiles&#39; option.</span>
 1583 <span class="s2">    --allowEmptyObjects &lt;yes or no&gt;  [default: no]</span>
 1584 <span class="s2">        Allow creation of empty PyMOL objects corresponding to solvent and</span>
 1585 <span class="s2">        inorganic atom selections across chains and ligands in input file(s). By</span>
 1586 <span class="s2">        default, the empty objects are marked for deletion.</span>
 1587 <span class="s2">    -c, --chainIDs &lt;First, All or ID1,ID2...&gt;  [default: First]</span>
 1588 <span class="s2">        List of chain IDs to use for visualizing macromolecules. Possible values:</span>
 1589 <span class="s2">        First, All, or a comma delimited list of chain IDs. The default is to use the</span>
 1590 <span class="s2">        chain ID for the first chain in each input file.</span>
 1591 <span class="s2">    -e, --examples</span>
 1592 <span class="s2">        Print examples.</span>
 1593 <span class="s2">    -h, --help</span>
 1594 <span class="s2">        Print this help message.</span>
 1595 <span class="s2">    -i, --infiles &lt;infile1,infile2,infile3...&gt;</span>
 1596 <span class="s2">        Input file names.</span>
 1597 <span class="s2">    -l, --ligandIDs &lt;Largest, All or ID1,ID2...&gt;  [default: Largest]</span>
 1598 <span class="s2">        List of ligand IDs present in chains for visualizing macromolecules to</span>
 1599 <span class="s2">        highlight ligand interactions. Possible values: Largest, All, or a comma</span>
 1600 <span class="s2">        delimited list of ligand IDs. The default is to use the largest ligand present</span>
 1601 <span class="s2">        in all or specified chains in each input file.</span>
 1602 <span class="s2">        </span>
 1603 <span class="s2">        Ligands are identified using organic selection operator available in PyMOL.</span>
 1604 <span class="s2">        It&#39;ll also  identify buffer molecules as ligands. The largest ligand contains</span>
 1605 <span class="s2">        the highest number of heavy atoms.</span>
 1606 <span class="s2">    --labelFontID &lt;number&gt;  [default: 7]</span>
 1607 <span class="s2">        Font ID for drawing labels. Default: 7 (Sans Bold). Valid values: 5 to 16.</span>
 1608 <span class="s2">        The specified value must be a valid PyMOL font ID. No validation is</span>
 1609 <span class="s2">        performed. The complete lists of valid font IDs is available at:</span>
 1610 <span class="s2">        pymolwiki.org/index.php/Label_font_id. Examples: 5 - Sans;</span>
 1611 <span class="s2">        7 - Sans Bold; 9 - Serif; 10 - Serif Bold.</span>
 1612 <span class="s2">    -o, --outfile &lt;outfile&gt;</span>
 1613 <span class="s2">        Output file name.</span>
 1614 <span class="s2">    -p, --PMLOut &lt;yes or no&gt;  [default: yes]</span>
 1615 <span class="s2">        Save PML file during generation of PSE file.</span>
 1616 <span class="s2">    --pocketContactsInorganicColor &lt;text&gt;  [default: deepsalmon]</span>
 1617 <span class="s2">        Color for drawing polar contacts between inorganic and pocket residues.</span>
 1618 <span class="s2">        The specified value must be valid color. No validation is performed.</span>
 1619 <span class="s2">    --pocketContactsLigandColor &lt;text&gt;  [default: orange]</span>
 1620 <span class="s2">        Color for drawing polar contacts between ligand and pocket residues.</span>
 1621 <span class="s2">        The specified value must be valid color. No validation is performed.</span>
 1622 <span class="s2">    --pocketContactsSolventColor &lt;text&gt;  [default: marine]</span>
 1623 <span class="s2">        Color for drawing polar contacts between solvent and pocket residues..</span>
 1624 <span class="s2">        The specified value must be valid color. No validation is performed.</span>
 1625 <span class="s2">    --pocketDistanceCutoff &lt;number&gt;  [default: 5.0]</span>
 1626 <span class="s2">        Distance in Angstroms for identifying pocket residues around ligands.</span>
 1627 <span class="s2">    --pocketLabelColor &lt;text&gt;  [default: magenta]</span>
 1628 <span class="s2">        Color for drawing residue or atom level labels for a pocket. The specified</span>
 1629 <span class="s2">        value must be valid color. No validation is performed.</span>
 1630 <span class="s2">    --pocketResidueTypes &lt;yes or no&gt;  [default: auto]</span>
 1631 <span class="s2">        Pocket residue types. The residue groups are generated using residue types,</span>
 1632 <span class="s2">        colors, and names specified by &#39;--residueTypes&#39; option. It is only valid for</span>
 1633 <span class="s2">        amino acids.  By default, the residue type groups are automatically created</span>
 1634 <span class="s2">        for pockets containing amino acids and skipped for chains only containing</span>
 1635 <span class="s2">        nucleic acids.</span>
 1636 <span class="s2">    --pocketSurface &lt;yes or no&gt;  [default: auto]</span>
 1637 <span class="s2">        Surfaces around pocket residues colored by hydrophobicity alone and</span>
 1638 <span class="s2">        both hydrophobicity and charge. The hydrophobicity surface is colored</span>
 1639 <span class="s2">        at residue level using Eisenberg hydrophobicity scale for residues and color</span>
 1640 <span class="s2">        gradient specified by &#39;--surfaceColorPalette&#39; option. The  hydrophobicity and</span>
 1641 <span class="s2">        charge surface is colored [ REF 140 ] at atom level using colors specified for</span>
 1642 <span class="s2">        groups of atoms by &#39;--surfaceAtomTypesColors&#39; option. This scheme allows</span>
 1643 <span class="s2">        simultaneous mapping of hyrophobicity and charge values on the surfaces.</span>
 1644 <span class="s2">        </span>
 1645 <span class="s2">        This option is only valid for amino acids. By default, both surfaces are</span>
 1646 <span class="s2">        automatically created for pockets containing amino acids and skipped for</span>
 1647 <span class="s2">        pockets containing only nucleic acids.</span>
 1648 <span class="s2">    --pocketSurfaceElectrostatics &lt;yes or no&gt;  [default: auto]</span>
 1649 <span class="s2">        Vacuum electrostatics contact potential surface around pocket residues.</span>
 1650 <span class="s2">        A word of to the wise from PyMOL documentation: The computed protein</span>
 1651 <span class="s2">        contact potentials are only qualitatively useful, due to short cutoffs,</span>
 1652 <span class="s2">        truncation, and lack of solvent &quot;screening&quot;.</span>
 1653 <span class="s2">        </span>
 1654 <span class="s2">        This option is only valid for amino acids. By default, the electrostatics surface</span>
 1655 <span class="s2">        is automatically created for chains containing amino acids and skipped for chains</span>
 1656 <span class="s2">        containing only nucleic acids.</span>
 1657 <span class="s2">    -r, --residueTypes &lt;Type,Color,ResNames,...&gt;  [default: auto]</span>
 1658 <span class="s2">        Residue types, colors, and names to generate for residue groups during</span>
 1659 <span class="s2">        &#39;--pocketResidueTypes&#39; and &#39;--residueTypesChain&#39; option. It is only</span>
 1660 <span class="s2">        valid for amino acids.</span>
 1661 <span class="s2">        </span>
 1662 <span class="s2">        It is a triplet of comma delimited list of amino acid residues type, residues</span>
 1663 <span class="s2">        color, and a space delimited list three letter residue names. </span>
 1664 <span class="s2">        </span>
 1665 <span class="s2">        The default values for residue type, color, and name triplets  are shown</span>
 1666 <span class="s2">        below:</span>
 1667 <span class="s2">            </span>
 1668 <span class="s2">            Aromatic,brightorange,HIS PHE TRP TYR,</span>
 1669 <span class="s2">            Hydrophobic,orange,ALA GLY VAL LEU ILE PRO MET,</span>
 1670 <span class="s2">            Polar,palegreen,ASN GLN SER THR CYS,</span>
 1671 <span class="s2">            Positively_Charged,marine,ARG LYS,</span>
 1672 <span class="s2">            Negatively_Charged,red,ASP GLU</span>
 1673 <span class="s2">            </span>
 1674 <span class="s2">        The color name must be a valid PyMOL name. No validation is performed.</span>
 1675 <span class="s2">        An amino acid name may appear across multiple residue types. All other</span>
 1676 <span class="s2">        residues are grouped under &#39;Other&#39;.</span>
 1677 <span class="s2">    --residueTypesChain &lt;yes or no&gt;  [default: auto]</span>
 1678 <span class="s2">        Chain residue types. The residue groups are generated using residue types,</span>
 1679 <span class="s2">        colors, and names specified by &#39;--residueTypes&#39; option. It is only valid for</span>
 1680 <span class="s2">        amino acids.  By default, the residue type groups are automatically created</span>
 1681 <span class="s2">        for chains containing amino acids and skipped for chains only containing</span>
 1682 <span class="s2">        nucleic acids.</span>
 1683 <span class="s2">    --surfaceChain &lt;yes or no&gt;  [default: auto]</span>
 1684 <span class="s2">        Surfaces around individual chain colored by hydrophobicity alone and</span>
 1685 <span class="s2">        both hydrophobicity and charge. The hydrophobicity surface is colored</span>
 1686 <span class="s2">        at residue level using Eisenberg hydrophobicity scale for residues and color</span>
 1687 <span class="s2">        gradient specified by &#39;--surfaceColorPalette&#39; option. The  hydrophobicity and</span>
 1688 <span class="s2">        charge surface is colored [ REF 140 ] at atom level using colors specified for</span>
 1689 <span class="s2">        groups of atoms by &#39;--surfaceAtomTypesColors&#39; option. This scheme allows</span>
 1690 <span class="s2">        simultaneous mapping of hyrophobicity and charge values on the surfaces.</span>
 1691 <span class="s2">        </span>
 1692 <span class="s2">        This option is only valid for amino acids. By default, both surfaces are</span>
 1693 <span class="s2">        automatically created for chains containing amino acids and skipped for</span>
 1694 <span class="s2">        chains containing only nucleic acids.</span>
 1695 <span class="s2">    --surfaceChainElectrostatics &lt;yes or no&gt;  [default: auto]</span>
 1696 <span class="s2">        Vacuum electrostatics contact potential surface and volume around individual</span>
 1697 <span class="s2">        chain. A word of to the wise from PyMOL documentation: The computed protein</span>
 1698 <span class="s2">        contact potentials are only qualitatively useful, due to short cutoffs,</span>
 1699 <span class="s2">        truncation, and lack of solvent &quot;screening&quot;.</span>
 1700 <span class="s2">        </span>
 1701 <span class="s2">        This option is only valid for amino acids. By default, the electrostatics surface</span>
 1702 <span class="s2">        and volume are automatically created for chains containing amino acids and</span>
 1703 <span class="s2">        skipped for chains containing only nucleic acids.</span>
 1704 <span class="s2">    --surfaceChainComplex &lt;yes or no&gt;  [default: no]</span>
 1705 <span class="s2">        Hydrophobic surface around chain complex. The  surface is colored by</span>
 1706 <span class="s2">        hydrophobicity. It is only valid for amino acids.</span>
 1707 <span class="s2">    --surfaceComplex &lt;yes or no&gt;  [default: no]</span>
 1708 <span class="s2">        Hydrophobic surface around complete complex. The  surface is colored by</span>
 1709 <span class="s2">        hydrophobicity. It is only valid for amino acids.</span>
 1710 <span class="s2">    --surfaceColorPalette &lt;RedToWhite or WhiteToGreen&gt;  [default: RedToWhite]</span>
 1711 <span class="s2">        Color palette for hydrophobic surfaces around chains and pockets in proteins.</span>
 1712 <span class="s2">        Possible values: RedToWhite or WhiteToGreen from most hydrophobic amino</span>
 1713 <span class="s2">        acid to least hydrophobic. The colors values for amino acids are taken from</span>
 1714 <span class="s2">        color_h script available as part of the Script Library at PyMOL Wiki.</span>
 1715 <span class="s2">    --surfaceAtomTypesColors &lt;ColorType,ColorSpec,...&gt;  [default: auto]</span>
 1716 <span class="s2">        Atom colors for generating surfaces colored by hyrophobicity and charge</span>
 1717 <span class="s2">        around chains and pockets in proteins. It&#39;s a pairwise comma delimited list</span>
 1718 <span class="s2">        of atom color type and color specification for goups of atoms.</span>
 1719 <span class="s2">        </span>
 1720 <span class="s2">        The default values for color types [ REF 140 ] along wth color specifications</span>
 1721 <span class="s2">        are shown below: </span>
 1722 <span class="s2">            </span>
 1723 <span class="s2">            HydrophobicAtomsColor, yellow,</span>
 1724 <span class="s2">            NegativelyChargedAtomsColor, red,</span>
 1725 <span class="s2">            PositivelyChargedAtomsColor, blue,</span>
 1726 <span class="s2">            OtherAtomsColor, gray90</span>
 1727 <span class="s2">            </span>
 1728 <span class="s2">        The color names must be valid PyMOL names.</span>
 1729 <span class="s2">        </span>
 1730 <span class="s2">        The color values may also be specified as space delimited RGB triplets:</span>
 1731 <span class="s2">             </span>
 1732 <span class="s2">            HydrophobicAtomsColor, 0.95 0.78 0.0,</span>
 1733 <span class="s2">            NegativelyChargedAtomsColor, 1.0 0.4 0.4,</span>
 1734 <span class="s2">            PositivelyChargedAtomsColor, 0.2 0.5 0.8,</span>
 1735 <span class="s2">            OtherAtomsColor, 0.95 0.95 0.95</span>
 1736 <span class="s2">            </span>
 1737 <span class="s2">    --surfaceTransparency &lt;number&gt;  [default: 0.25]</span>
 1738 <span class="s2">        Surface transparency for molecular surfaces.</span>
 1739 <span class="s2">    --overwrite</span>
 1740 <span class="s2">        Overwrite existing files.</span>
 1741 <span class="s2">    -w, --workingdir &lt;dir&gt;</span>
 1742 <span class="s2">        Location of working directory which defaults to the current directory.</span>
 1743 
 1744 <span class="s2">Examples:</span>
 1745 <span class="s2">    To visualize the first chain, the largest ligand in the first chain, and ligand</span>
 1746 <span class="s2">    binding pockets to highlight ligand interaction with pocket resiudes, solvents</span>
 1747 <span class="s2">    and inorganics, in a PDB file, and generate a PML file, type:</span>
 1748 
 1749 <span class="s2">        % PyMOLVisualizeMacromolecules.py -i Sample4.pdb -o Sample4.pml</span>
 1750 
 1751 <span class="s2">    To visualize all chains, all ligands in all chains, and all ligand binding pockets to</span>
 1752 <span class="s2">    highlight ligand interaction with pocket resiudes, solvents and inorganics, in a</span>
 1753 <span class="s2">    PDB file, and generate a PML file, type:</span>
 1754 
 1755 <span class="s2">        % PyMOLVisualizeMacromolecules.py -c All -l All -i Sample4.pdb -o</span>
 1756 <span class="s2">          Sample4.pml</span>
 1757 
 1758 <span class="s2">    To visualize all chains, ligands, and ligand binding pockets along with displaying</span>
 1759 <span class="s2">    all hydrophibic surfaces and chain electrostatic surface, in a PDB file, and</span>
 1760 <span class="s2">    generate a PML file, type:</span>
 1761 
 1762 <span class="s2">        % PyMOLVisualizeMacromolecules.py -c All -l All</span>
 1763 <span class="s2">          --surfaceChainElectrostatics yes --surfaceChainComplex yes</span>
 1764 <span class="s2">          --surfaceComplex yes -i Sample4.pdb -o Sample4.pml</span>
 1765 
 1766 <span class="s2">    To visualize chain E, ligand ADP in chain E, and ligand binding pockets to</span>
 1767 <span class="s2">    highlight ligand interaction with pocket resiudes, solvents and inorganics,</span>
 1768 <span class="s2">    in a PDB file, and generate a PML file, type:</span>
 1769 
 1770 <span class="s2">        % PyMOLVisualizeMacromolecules.py -c E -l ADP -i Sample3.pdb</span>
 1771 <span class="s2">          -o Sample3.pml</span>
 1772 
 1773 <span class="s2">    To visualize chain E, ligand ADP in chain E, and ligand binding pockets to</span>
 1774 <span class="s2">    highlight ligand interaction with pocket resiudes, solvents and inorganics,</span>
 1775 <span class="s2">    in a PDB file, and generate a PSE file, type:</span>
 1776 
 1777 <span class="s2">        % PyMOLVisualizeMacromolecules.py -c E -l ADP -i Sample3.pdb</span>
 1778 <span class="s2">          -o Sample3.pse</span>
 1779 
 1780 <span class="s2">    To visualize the first chain, the largest ligand in the first chain, and ligand</span>
 1781 <span class="s2">    binding pockets to highlight ligand interaction with pocket resiudes, solvents</span>
 1782 <span class="s2">    and inorganics, in PDB files, along with aligning first chain in each input file to</span>
 1783 <span class="s2">    the first chain in first input file, and generate a PML file, type:</span>
 1784 
 1785 <span class="s2">        % PyMOLVisualizeMacromolecules.py --align yes -i</span>
 1786 <span class="s2">          &quot;Sample5.pdb,Sample6.pdb,Sample7.pdb&quot; -o SampleOut.pml</span>
 1787 
 1788 <span class="s2">    To visualize all chains, all ligands in all chains, and all ligand binding pockets to</span>
 1789 <span class="s2">    highlight ligand interaction with pocket resiudes, solvents and inorganics, in</span>
 1790 <span class="s2">    PDB files, along with aligning first chain in each input file to the first chain in</span>
 1791 <span class="s2">    first input file, and generate a PML file, type:</span>
 1792 
 1793 <span class="s2">        % PyMOLVisualizeMacromolecules.py --align yes  -c All -l All -i</span>
 1794 <span class="s2">          &quot;Sample5.pdb,Sample6.pdb,Sample7.pdb&quot; -o SampleOut.pml</span>
 1795 
 1796 <span class="s2">    To visualize all chains, all ligands in all chains, and all ligand binding pockets to</span>
 1797 <span class="s2">    highlight ligand interaction with pocket resiudes, solvents and inorganics, in</span>
 1798 <span class="s2">    PDB files, along with aligning first chain in each input file to the first chain in a</span>
 1799 <span class="s2">    specified PDB file using a specified alignment method, and generate a PML</span>
 1800 <span class="s2">    file, type:</span>
 1801 
 1802 <span class="s2">        % PyMOLVisualizeMacromolecules.py --align yes  --alignMode FirstChain</span>
 1803 <span class="s2">          --alignRefFile Sample5.pdb --alignMethod super   -c All  -l All -i</span>
 1804 <span class="s2">          &quot;Sample5.pdb,Sample6.pdb,Sample7.pdb&quot; -o SampleOut.pml</span>
 1805 
 1806 <span class="s2">Author:</span>
 1807 <span class="s2">    Manish Sud(msud@san.rr.com)</span>
 1808 
 1809 <span class="s2">See also:</span>
 1810 <span class="s2">    DownloadPDBFiles.pl,  PyMOLVisualizeCryoEMDensity.py,</span>
 1811 <span class="s2">    PyMOLVisualizeElectronDensity.py</span>
 1812 
 1813 <span class="s2">Copyright:</span>
 1814 <span class="s2">    Copyright (C) 2018 Manish Sud. All rights reserved.</span>
 1815 
 1816 <span class="s2">    The functionality available in this script is implemented using PyMOL, a</span>
 1817 <span class="s2">    molecular visualization system on an open source foundation originally</span>
 1818 <span class="s2">    developed by Warren DeLano.</span>
 1819 
 1820 <span class="s2">    This file is part of MayaChemTools.</span>
 1821 
 1822 <span class="s2">    MayaChemTools is free software; you can redistribute it and/or modify it under</span>
 1823 <span class="s2">    the terms of the GNU Lesser General Public License as published by the Free</span>
 1824 <span class="s2">    Software Foundation; either version 3 of the License, or (at your option) any</span>
 1825 <span class="s2">    later version.</span>
 1826 
 1827 <span class="s2">&quot;&quot;&quot;</span>
 1828 
 1829 <span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
 1830     <span class="n">main</span><span class="p">()</span>
</pre>
<br />
<center>
<img src="../../../images/h2o2.png">
</center>
</body>
</html>
