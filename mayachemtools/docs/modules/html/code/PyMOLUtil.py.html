<html>
<head>
<title>MayaChemTools:Code:Python/PyMOLUtil.py</title>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<link rel="stylesheet" type="text/css" href="../../../css/MayaChemToolsPythonCode.css">
</head>
<body leftmargin="20" rightmargin="20" topmargin="10" bottommargin="10">
<br/>
<center>
<a href="http://www.mayachemtools.org" title="MayaChemTools Home"><img src="../../../images/MayaChemToolsLogo.gif" border="0" alt="MayaChemTools"></a>
</center>
<br/>
<pre>
    1 <span class="ch">#!/bin/env python</span>
    2 <span class="c1"># File: PyMOLUtil.py</span>
    3 <span class="c1"># Author: Manish Sud &lt;msud@san.rr.com&gt;</span>
    4 <span class="c1">#</span>
    5 <span class="c1"># Copyright (C) 2018 Manish Sud. All rights reserved.</span>
    6 <span class="c1">#</span>
    7 <span class="c1"># The functionality available in this file is implemented using PyMOL, a</span>
    8 <span class="c1"># molecular visualization system on an open source foundation originally</span>
    9 <span class="c1"># developed by Warren DeLano.</span>
   10 <span class="c1">#</span>
   11 <span class="c1"># This file is part of MayaChemTools.</span>
   12 <span class="c1">#</span>
   13 <span class="c1"># MayaChemTools is free software; you can redistribute it and/or modify it under</span>
   14 <span class="c1"># the terms of the GNU Lesser General Public License as published by the Free</span>
   15 <span class="c1"># Software Foundation; either version 3 of the License, or (at your option) any</span>
   16 <span class="c1"># later version.</span>
   17 <span class="c1">#</span>
   18 <span class="c1"># MayaChemTools is distributed in the hope that it will be useful, but without</span>
   19 <span class="c1"># any warranty; without even the implied warranty of merchantability of fitness</span>
   20 <span class="c1"># for a particular purpose.  See the GNU Lesser General Public License for more</span>
   21 <span class="c1"># details.</span>
   22 <span class="c1">#</span>
   23 <span class="c1"># You should have received a copy of the GNU Lesser General Public License</span>
   24 <span class="c1"># along with MayaChemTools; if not, see &lt;http://www.gnu.org/licenses/&gt; or</span>
   25 <span class="c1"># write to the Free Software Foundation Inc., 59 Temple Place, Suite 330,</span>
   26 <span class="c1"># Boston, MA, 02111-1307, USA.</span>
   27 <span class="c1">#</span>
   28 
   29 <span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
   30 
   31 <span class="kn">import</span> <span class="nn">os</span>
   32 <span class="kn">import</span> <span class="nn">sys</span>
   33 <span class="kn">import</span> <span class="nn">re</span>
   34 
   35 <span class="kn">from</span> <span class="nn">pymol</span> <span class="kn">import</span> <span class="n">cmd</span><span class="p">,</span> <span class="n">stored</span><span class="p">,</span> <span class="n">CmdException</span>
   36 
   37 <span class="kn">import</span> <span class="nn">MiscUtil</span>
   38 
   39 <span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;AreAminoAcidResiduesPresent&quot;</span><span class="p">,</span> <span class="s2">&quot;AreNucleicAcidResiduesPresent&quot;</span><span class="p">,</span> <span class="s2">&quot;CalculateCenterOfMass&quot;</span><span class="p">,</span> <span class="s2">&quot;ConvertFileFormat&quot;</span><span class="p">,</span> <span class="s2">&quot;ConvertPMLFileToPSEFile&quot;</span><span class="p">,</span> <span class="s2">&quot;GetChains&quot;</span><span class="p">,</span> <span class="s2">&quot;GetChainsAndLigandsInfo&quot;</span><span class="p">,</span> <span class="s2">&quot;GetAminoAcidResiduesInfo&quot;</span><span class="p">,</span> <span class="s2">&quot;GetInorganicResiduesInfo&quot;</span><span class="p">,</span> <span class="s2">&quot;GetLargestLigand&quot;</span><span class="p">,</span> <span class="s2">&quot;GetLigandResiduesInfo&quot;</span><span class="p">,</span> <span class="s2">&quot;GetLigands&quot;</span><span class="p">,</span> <span class="s2">&quot;GetMolecules&quot;</span><span class="p">,</span> <span class="s2">&quot;GetNucleicAcidResiduesInfo&quot;</span><span class="p">,</span> <span class="s2">&quot;GetPocketInorganicResiduesInfo&quot;</span><span class="p">,</span> <span class="s2">&quot;GetPocketPolymerResiduesInfo&quot;</span><span class="p">,</span> <span class="s2">&quot;GetPocketSolventResiduesInfo&quot;</span><span class="p">,</span>  <span class="s2">&quot;GetPolymerResiduesInfo&quot;</span><span class="p">,</span> <span class="s2">&quot;GetSolventResiduesInfo&quot;</span><span class="p">,</span> <span class="s2">&quot;ProcessChainsAndLigandsOptionsInfo&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLForAlignment&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLForBFactorPuttyView&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLForBallAndStickView&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLForEnableDisable&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLForGroup&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLForHydrophobicSurfaceView&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLForHydrophobicAndChargeSurfaceView&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLForInorganicView&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLForLigandPocketInorganicView&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLForLigandPocketSolventView&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLForLigandPocketView&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLForLigandView&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLForPolarContactsView&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLForPolymerChainComplexView&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLForPolymerChainView&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLForPolymerComplexView&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLForSolventView&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLForSurfaceView&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLForSelectionDisplayView&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLHeaderInfo&quot;</span><span class="p">]</span>
   40 
   41 <span class="k">def</span> <span class="nf">GetMolecules</span><span class="p">(</span><span class="n">Selection</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span><span class="p">):</span>
   42     <span class="sd">&quot;&quot;&quot;Get names of molecule objects in a selection or all molecule objects.</span>
   43 
   44 <span class="sd">    Arguments:</span>
   45 <span class="sd">        Selection: (str): A PyMOL selection.</span>
   46 
   47 <span class="sd">    Returns:</span>
   48 <span class="sd">        list: Names of molecule objects.</span>
   49 
   50 <span class="sd">    &quot;&quot;&quot;</span>
   51     <span class="n">Names</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="n">Selection</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">)</span>
   52 
   53     <span class="k">return</span> <span class="n">Names</span>
   54 
   55 <span class="k">def</span> <span class="nf">GetChains</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">RemoveEmpty</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
   56     <span class="sd">&quot;&quot;&quot;Get chain identifiers present in a molecule.</span>
   57 
   58 <span class="sd">    Arguments:</span>
   59 <span class="sd">        MoleculeName (str): Name of a PyMOL molecule object.</span>
   60 <span class="sd">        RemoveEmpty (bool): Remove empty chain ID from the list of chain IDs</span>
   61 <span class="sd">            returned by PyMOL.</span>
   62 
   63 <span class="sd">    Returns:</span>
   64 <span class="sd">        list: Names of chains present in a molecule, sorted alphabetically in a</span>
   65 <span class="sd">            ascending order.</span>
   66 
   67 <span class="sd">    &quot;&quot;&quot;</span>
   68     <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">):</span>
   69         <span class="k">return</span> <span class="bp">None</span>
   70 
   71     <span class="n">ChainIDs</span> <span class="o">=</span> <span class="p">[]</span>
   72     <span class="k">try</span><span class="p">:</span>
   73         <span class="n">ChainIDs</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="n">get_chains</span><span class="p">(</span><span class="s1">&#39;model </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">MoleculeName</span><span class="p">)</span>
   74     <span class="k">except</span> <span class="n">CmdException</span> <span class="k">as</span> <span class="n">ErrMsg</span><span class="p">:</span>
   75         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;PyMOLUtil.GetChains: Invalid molecule name: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">MoleculeName</span><span class="p">)</span>
   76 
   77     <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainIDs</span><span class="p">):</span>
   78         <span class="k">return</span> <span class="bp">None</span>
   79 
   80     <span class="c1"># Remove empty Chain IDs from the list...</span>
   81     <span class="k">if</span> <span class="n">RemoveEmpty</span><span class="p">:</span>
   82         <span class="n">NonEmptyChainIDs</span> <span class="o">=</span> <span class="p">[]</span>
   83         <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">ChainIDs</span><span class="p">:</span>
   84             <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainID</span><span class="p">):</span>
   85                 <span class="n">NonEmptyChainIDs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainID</span><span class="p">)</span>
   86         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">NonEmptyChainIDs</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainIDs</span><span class="p">):</span>
   87             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;PyMOLUtil.GetChains: Removing non-empty chain IDs from the list of chain IDs...&quot;</span><span class="p">)</span>
   88             
   89         <span class="n">ChainIDs</span> <span class="o">=</span> <span class="n">NonEmptyChainIDs</span>
   90         
   91     <span class="k">return</span> <span class="n">ChainIDs</span>
   92 
   93 <span class="k">def</span> <span class="nf">GetChainsAndLigandsInfo</span><span class="p">(</span><span class="n">Infile</span><span class="p">,</span> <span class="n">MolName</span><span class="p">,</span> <span class="n">Quite</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">LigandSortBy</span> <span class="o">=</span> <span class="s2">&quot;Size&quot;</span><span class="p">,</span> <span class="n">LigandSortOrder</span> <span class="o">=</span> <span class="s2">&quot;Auto&quot;</span><span class="p">,</span> <span class="n">LigandIgnoreHydrogens</span> <span class="o">=</span> <span class="s2">&quot;Yes&quot;</span><span class="p">):</span>
   94     <span class="sd">&quot;&quot;&quot;Get chain identifiers present in a molecule along with names of the</span>
   95 <span class="sd">    ligands present in chains. Ligands are identified using PyMOL &#39;organic&#39;</span>
   96 <span class="sd">    selection.</span>
   97 
   98 <span class="sd">    Arguments:</span>
   99 <span class="sd">        Infile (str) : Name of a file.</span>
  100 <span class="sd">        MolName (str) : Name to use for PyMOL molecule object.</span>
  101 <span class="sd">        Quite (bool) : Flag </span>
  102 <span class="sd">        LigandSortBy (str): Sort ligand names alphabetically or by size. Possible</span>
  103 <span class="sd">            values: Alphabetical or Size</span>
  104 <span class="sd">        LigandSortOrder (str): Sort order for sorting ligands. Possible values:</span>
  105 <span class="sd">            Ascending, Descending, Auto. The &#39;Auto&#39; value implies automatic</span>
  106 <span class="sd">            determination of sort order based on the value of &#39;SortBy&#39;.</span>
  107 <span class="sd">            Automatic defaults: Descending for SortBy value of Size; Ascending</span>
  108 <span class="sd">            for SortBy value of Alphabetical.</span>
  109 <span class="sd">        LigandIgnoreHydrogens (str): Ignore hydrogens during determination of ligand</span>
  110 <span class="sd">            size.</span>
  111 
  112 <span class="sd">    Returns:</span>
  113 <span class="sd">        dict: A dictionary containing list of chain identifiers and dictionaries</span>
  114 <span class="sd">            of chains containing lists of ligand names for each chain. Names of</span>
  115 <span class="sd">            ligands present in chain for a molecule sorted by size or</span>
  116 <span class="sd">            alphabetically.</span>
  117 
  118 <span class="sd">    Examples:</span>
  119 
  120 <span class="sd">        ChainsAndLigandsInfo = GetChainsAndLigandsInfo(Infile, MolName)</span>
  121 <span class="sd">        for ChainID in ChainsAndLigandsInfo[&quot;ChainIDs&quot;]:</span>
  122 <span class="sd">            for LigandID in ChainsAndLigandsInfo[&quot;LigandIDs&quot;][ChainID]:</span>
  123 <span class="sd">                MiscUtil.PrintInfo(&quot;ChainID: %s; LigandID: %s&quot; % (ChainID,</span>
  124 <span class="sd">                    LigandID))</span>
  125 
  126 <span class="sd">    &quot;&quot;&quot;</span>
  127     <span class="k">if</span> <span class="ow">not</span> <span class="n">Quite</span><span class="p">:</span>
  128         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Retrieving chain and ligand information from input file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">Infile</span><span class="p">)</span>
  129     
  130     <span class="c1"># Collect chains and ligands information with ligands sorted by size to be used for</span>
  131     <span class="c1"># identification of largest ligand at the top...</span>
  132     <span class="n">cmd</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">Infile</span><span class="p">,</span> <span class="n">MolName</span><span class="p">)</span>
  133     <span class="n">ChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">_GetChainsAndLigands</span><span class="p">(</span><span class="n">MolName</span><span class="p">,</span> <span class="n">LigandSortBy</span> <span class="o">=</span> <span class="s2">&quot;size&quot;</span><span class="p">,</span> <span class="n">LigandSortOrder</span> <span class="o">=</span> <span class="s2">&quot;descending&quot;</span><span class="p">)</span>
  134     <span class="n">cmd</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">MolName</span><span class="p">)</span>
  135 
  136     <span class="c1"># Print out chain and ligand IDs...</span>
  137     <span class="k">if</span> <span class="ow">not</span> <span class="n">Quite</span><span class="p">:</span>
  138         <span class="n">ChainIDs</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">])</span> <span class="k">else</span> <span class="s2">&quot;None&quot;</span>
  139         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Chain IDs: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ChainIDs</span><span class="p">)</span>
  140         
  141         <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
  142             <span class="n">LigandIDs</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">])</span> <span class="k">else</span> <span class="s2">&quot;None&quot;</span>
  143             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Chain ID: </span><span class="si">%s</span><span class="s2">; LigandIDs: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandIDs</span><span class="p">))</span>
  144     
  145     <span class="k">return</span> <span class="n">ChainsAndLigandsInfo</span>
  146 
  147 <span class="k">def</span> <span class="nf">GetLigands</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">SortBy</span> <span class="o">=</span> <span class="s2">&quot;Size&quot;</span><span class="p">,</span> <span class="n">SortOrder</span> <span class="o">=</span> <span class="s2">&quot;Auto&quot;</span><span class="p">,</span> <span class="n">IgnoreHydrogens</span> <span class="o">=</span> <span class="s2">&quot;Yes&quot;</span><span class="p">):</span>
  148     <span class="sd">&quot;&quot;&quot;Get names of ligands present in a chain of a  molecule. Ligands are</span>
  149 <span class="sd">    identified using PyMOL &#39;organic&#39; selection.</span>
  150 
  151 <span class="sd">    Arguments:</span>
  152 <span class="sd">        MoleculeName (str): Name of a PyMOL molecule object.</span>
  153 <span class="sd">        ChainName (str): Name of a chain in a molecule.</span>
  154 <span class="sd">        SortBy (str): Sort ligand names alphabetically or by size. Possible</span>
  155 <span class="sd">            values: Alphabetical or Size</span>
  156 <span class="sd">        SortOrder (str): Sort order for sorting ligands. Possible values:</span>
  157 <span class="sd">            Ascending, Descending, Auto. The &#39;Auto&#39; value implies automatic</span>
  158 <span class="sd">            determination of sort order based on the value of &#39;SortBy&#39;.</span>
  159 <span class="sd">            Automatic defaults: Descending for SortBy value of Size; Ascending</span>
  160 <span class="sd">            for SortBy value of Alphabetical.</span>
  161 <span class="sd">        IgnoreHydrogens (str): Ignore hydrogens during determination of ligand</span>
  162 <span class="sd">            size.</span>
  163 
  164 <span class="sd">    Returns:</span>
  165 <span class="sd">        list: Names of ligands present in chain for a molecule sorted by size</span>
  166 <span class="sd">            or alphabetically.</span>
  167 
  168 <span class="sd">    &quot;&quot;&quot;</span>
  169     <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainName</span><span class="p">)):</span>
  170         <span class="k">return</span> <span class="bp">None</span>
  171 
  172     <span class="n">LigandsInfoMap</span> <span class="o">=</span> <span class="n">_GetLigandsInfo</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">SortBy</span><span class="p">,</span> <span class="n">SortOrder</span><span class="p">,</span> <span class="n">IgnoreHydrogens</span><span class="p">)</span>
  173     
  174     <span class="n">LigandIDs</span> <span class="o">=</span> <span class="n">LigandsInfoMap</span><span class="p">[</span><span class="s2">&quot;LigandResNames&quot;</span><span class="p">]</span>
  175     <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">LigandIDs</span><span class="p">):</span>
  176         <span class="n">LigandIDs</span> <span class="o">=</span> <span class="bp">None</span>
  177     
  178     <span class="k">return</span> <span class="n">LigandIDs</span>
  179 
  180 <span class="k">def</span> <span class="nf">GetLargestLigand</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">IgnoreHydrogens</span> <span class="o">=</span> <span class="s1">&#39;Yes&#39;</span><span class="p">):</span>
  181     <span class="sd">&quot;&quot;&quot;Get name of the largest ligand for a chain present in a molecule. Ligands</span>
  182 <span class="sd">    are identified using PyMOL &#39;organic&#39; selection.</span>
  183 
  184 <span class="sd">    Arguments:</span>
  185 <span class="sd">        IgnoreHydrogens (str): Ignore hydrogens during determination of ligand</span>
  186 <span class="sd">            size.</span>
  187 
  188 <span class="sd">    Returns:</span>
  189 <span class="sd">        str: Name of the largest ligand present in a chain. </span>
  190 
  191 <span class="sd">    &quot;&quot;&quot;</span>
  192     <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainName</span><span class="p">)):</span>
  193         <span class="k">return</span> <span class="bp">None</span>
  194 
  195     <span class="n">SortBy</span> <span class="o">=</span> <span class="s2">&quot;Size&quot;</span>
  196     <span class="n">SortOrder</span> <span class="o">=</span> <span class="s2">&quot;Descending&quot;</span>
  197     <span class="n">LigandsInfoMap</span> <span class="o">=</span> <span class="n">_GetLigandsInfo</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">SortBy</span><span class="p">,</span> <span class="n">SortOrder</span><span class="p">,</span> <span class="n">IgnoreHydrogens</span><span class="p">)</span>
  198     <span class="n">LigandIDs</span> <span class="o">=</span> <span class="n">LigandsInfoMap</span><span class="p">[</span><span class="s2">&quot;LigandResNames&quot;</span><span class="p">]</span>
  199     
  200     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">LigandIDs</span><span class="p">):</span>
  201         <span class="n">LigandID</span> <span class="o">=</span> <span class="n">LigandIDs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
  202     <span class="k">else</span><span class="p">:</span>
  203         <span class="n">LigandID</span> <span class="o">=</span> <span class="bp">None</span>
  204 
  205     <span class="k">return</span> <span class="n">LigandID</span>
  206 
  207 <span class="k">def</span> <span class="nf">_GetChainsAndLigands</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">LigandSortBy</span> <span class="o">=</span> <span class="s2">&quot;Size&quot;</span><span class="p">,</span> <span class="n">LigandSortOrder</span> <span class="o">=</span> <span class="s2">&quot;Auto&quot;</span><span class="p">,</span> <span class="n">LigandIgnoreHydrogens</span> <span class="o">=</span> <span class="s2">&quot;Yes&quot;</span><span class="p">):</span>
  208     <span class="sd">&quot;&quot;&quot;Get chain identifiers in a molecule along with names of the ligands</span>
  209 <span class="sd">    present in chains. Ligands are identified using PyMOL &#39;organic&#39; selection.</span>
  210 <span class="sd">    &quot;&quot;&quot;</span>
  211     <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">):</span>
  212         <span class="k">return</span> <span class="bp">None</span>
  213 
  214     <span class="n">ChainIDs</span> <span class="o">=</span> <span class="n">GetChains</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">)</span>
  215     <span class="k">if</span> <span class="n">ChainIDs</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  216         <span class="k">return</span> <span class="bp">None</span>
  217         
  218     <span class="n">ChainsAndLigandsMap</span> <span class="o">=</span> <span class="p">{}</span>
  219     <span class="n">ChainsAndLigandsMap</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  220     <span class="n">ChainsAndLigandsMap</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  221     
  222     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">ChainIDs</span><span class="p">:</span>
  223         <span class="n">ChainsAndLigandsMap</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainID</span><span class="p">)</span>
  224         <span class="n">ChainsAndLigandsMap</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  225         
  226         <span class="n">LigandIDs</span> <span class="o">=</span> <span class="n">GetLigands</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">SortBy</span> <span class="o">=</span> <span class="n">LigandSortBy</span><span class="p">,</span> <span class="n">SortOrder</span> <span class="o">=</span> <span class="n">LigandSortOrder</span><span class="p">,</span> <span class="n">IgnoreHydrogens</span> <span class="o">=</span> <span class="n">LigandIgnoreHydrogens</span><span class="p">)</span>
  227         <span class="k">if</span> <span class="n">LigandIDs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
  228             <span class="n">ChainsAndLigandsMap</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">LigandIDs</span>
  229         
  230     <span class="k">return</span> <span class="n">ChainsAndLigandsMap</span>
  231 
  232 <span class="k">def</span> <span class="nf">_GetLigandsInfo</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">SortBy</span> <span class="o">=</span> <span class="s2">&quot;Size&quot;</span><span class="p">,</span> <span class="n">SortOrder</span> <span class="o">=</span> <span class="s2">&quot;Auto&quot;</span><span class="p">,</span> <span class="n">IgnoreHydrogens</span> <span class="o">=</span> <span class="s2">&quot;Yes&quot;</span><span class="p">):</span>
  233     <span class="sd">&quot;&quot;&quot;Retrieve information about ligands present in a chain of a molecule.&quot;&quot;&quot;</span>
  234 
  235     <span class="k">if</span> <span class="ow">not</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">CheckTextValue</span><span class="p">(</span><span class="n">SortBy</span><span class="p">,</span> <span class="s2">&quot;Size Alphabetical&quot;</span><span class="p">):</span>
  236         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;PyMOLUtil._GetLigandsInfo: The value specified, </span><span class="si">%s</span><span class="s2">, for parameter SortBy is not valid. SupportedValues: Size Alphabetical&quot;</span> <span class="o">%</span> <span class="n">SortBy</span><span class="p">)</span>
  237         
  238     <span class="k">if</span> <span class="ow">not</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">CheckTextValue</span><span class="p">(</span><span class="n">SortOrder</span><span class="p">,</span> <span class="s2">&quot;Ascending Descending Auto&quot;</span><span class="p">):</span>
  239         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;PyMOLUtil._GetLigandsInfo: The value specified, </span><span class="si">%s</span><span class="s2">, for parameter SortOrder is not valid. SupportedValues: Ascending Descending Auto&quot;</span> <span class="o">%</span> <span class="n">SortOrder</span><span class="p">)</span>
  240         
  241     <span class="k">if</span> <span class="ow">not</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">CheckTextValue</span><span class="p">(</span><span class="n">IgnoreHydrogens</span><span class="p">,</span> <span class="s2">&quot;Yes No&quot;</span><span class="p">):</span>
  242         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;PyMOLUtil._GetLigandsInfo: The value specified, </span><span class="si">%s</span><span class="s2">, for parameter IgnoreHydrogens is not valid. SupportedValues: Yes No&quot;</span> <span class="o">%</span> <span class="n">IgnoreHydrogens</span><span class="p">)</span>
  243         
  244     <span class="n">SortBySize</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Size$&quot;</span><span class="p">,</span> <span class="n">SortBy</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
  245     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Auto$&quot;</span><span class="p">,</span> <span class="n">SortOrder</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  246         <span class="n">SortOrderDescending</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Size$&quot;</span><span class="p">,</span> <span class="n">SortBy</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
  247     <span class="k">else</span><span class="p">:</span>
  248         <span class="n">SortOrderDescending</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Descending$&quot;</span><span class="p">,</span> <span class="n">SortOrder</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
  249     <span class="n">IgnoreHydrogenAtoms</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">IgnoreHydrogens</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
  250 
  251     <span class="c1"># Set up a command to retrieve all appropriate ligand atoms in organic ligands...</span>
  252     <span class="n">SelectionCmd</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2"> and organic&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">)</span>
  253     <span class="k">if</span> <span class="n">IgnoreHydrogenAtoms</span><span class="p">:</span>
  254         <span class="n">SelectionCmd</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and not hydro&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionCmd</span><span class="p">)</span>
  255 
  256     <span class="c1"># Retrieve atoms...</span>
  257     <span class="n">stored</span><span class="o">.</span><span class="n">LigandsInfo</span> <span class="o">=</span> <span class="p">[]</span>
  258     <span class="n">cmd</span><span class="o">.</span><span class="n">iterate</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">,</span> <span class="s2">&quot;stored.LigandsInfo.append([resi, resn])&quot;</span><span class="p">)</span>
  259 
  260     <span class="c1"># Retrieve ligands...</span>
  261     <span class="n">LigandsInfoMap</span> <span class="o">=</span> <span class="p">{}</span>
  262     <span class="n">LigandsInfoMap</span><span class="p">[</span><span class="s2">&quot;LigandResNames&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  263     <span class="n">LigandsInfoMap</span><span class="p">[</span><span class="s2">&quot;LigandAtomCount&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  264     <span class="n">LigandsInfoMap</span><span class="p">[</span><span class="s2">&quot;LigandResNumber&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  265     
  266     <span class="k">for</span> <span class="n">LigandResNum</span><span class="p">,</span> <span class="n">LigandResName</span> <span class="ow">in</span> <span class="n">stored</span><span class="o">.</span><span class="n">LigandsInfo</span><span class="p">:</span>
  267         <span class="k">if</span> <span class="n">LigandResName</span> <span class="ow">in</span> <span class="n">LigandsInfoMap</span><span class="p">[</span><span class="s2">&quot;LigandResNames&quot;</span><span class="p">]:</span>
  268             <span class="n">LigandsInfoMap</span><span class="p">[</span><span class="s2">&quot;LigandAtomCount&quot;</span><span class="p">][</span><span class="n">LigandResName</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
  269         <span class="k">else</span><span class="p">:</span>
  270             <span class="n">LigandsInfoMap</span><span class="p">[</span><span class="s2">&quot;LigandResNames&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">LigandResName</span><span class="p">)</span>
  271             <span class="n">LigandsInfoMap</span><span class="p">[</span><span class="s2">&quot;LigandAtomCount&quot;</span><span class="p">][</span><span class="n">LigandResName</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
  272             <span class="n">LigandsInfoMap</span><span class="p">[</span><span class="s2">&quot;LigandResNumber&quot;</span><span class="p">][</span><span class="n">LigandResName</span><span class="p">]</span> <span class="o">=</span> <span class="n">LigandResNum</span>
  273 
  274     <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">LigandsInfoMap</span><span class="p">[</span><span class="s2">&quot;LigandResNames&quot;</span><span class="p">]):</span>
  275         <span class="k">return</span> <span class="n">LigandsInfoMap</span>
  276         
  277     <span class="c1"># Sort ligand names...</span>
  278     <span class="n">ReverseOrder</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">SortOrderDescending</span> <span class="k">else</span> <span class="bp">False</span>
  279     <span class="k">if</span> <span class="n">SortBySize</span><span class="p">:</span>
  280         <span class="n">SortedLigandResNames</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">LigandsInfoMap</span><span class="p">[</span><span class="s2">&quot;LigandResNames&quot;</span><span class="p">],</span> <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">LigandResName</span><span class="p">:</span> <span class="n">LigandsInfoMap</span><span class="p">[</span><span class="s2">&quot;LigandAtomCount&quot;</span><span class="p">][</span><span class="n">LigandResName</span><span class="p">],</span> <span class="n">reverse</span> <span class="o">=</span> <span class="n">ReverseOrder</span><span class="p">)</span>
  281     <span class="k">else</span><span class="p">:</span>
  282         <span class="c1"># Sort alphabetically...</span>
  283         <span class="n">SortedLigandResNames</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">LigandsInfoMap</span><span class="p">[</span><span class="s2">&quot;LigandResNames&quot;</span><span class="p">],</span> <span class="n">reverse</span> <span class="o">=</span> <span class="n">ReverseOrder</span><span class="p">)</span>
  284 
  285     <span class="n">LigandsInfoMap</span><span class="p">[</span><span class="s2">&quot;LigandResNames&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SortedLigandResNames</span>
  286     
  287     <span class="k">return</span> <span class="n">LigandsInfoMap</span>
  288 
  289 <span class="k">def</span> <span class="nf">AreAminoAcidResiduesPresent</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">Type</span> <span class="o">=</span> <span class="s2">&quot;Any&quot;</span><span class="p">):</span>
  290     <span class="sd">&quot;&quot;&quot;Check for the presence of amino acid residues in a chain of a</span>
  291 <span class="sd">    molecule. Chains are identified using PyMOL &#39;polymer&#39; selection.</span>
  292 <span class="sd">    Nonstandard amino acid residues correspond to all residues other than</span>
  293 <span class="sd">    the standard amino acids and nucleic acids. Any amino acid residues cover</span>
  294 <span class="sd">    all residues other than the standard nucleic acids.</span>
  295 
  296 <span class="sd">    Arguments:</span>
  297 <span class="sd">        MoleculeName (str): Name of a PyMOL molecule object.</span>
  298 <span class="sd">        ChainName (str): Name of a chain in a molecule.</span>
  299 <span class="sd">        Type (str): Types of amino acids: Standard, NonStandard, Any</span>
  300 
  301 <span class="sd">    Returns:</span>
  302 <span class="sd">        boolean: True or False.</span>
  303 
  304 <span class="sd">    &quot;&quot;&quot;</span>
  305     
  306     <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainName</span><span class="p">)):</span>
  307         <span class="k">return</span> <span class="bp">False</span>
  308 
  309     <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(Standard|NonStandard|Any)$&quot;</span><span class="p">,</span> <span class="n">Type</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  310         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;PyMOLUtil.AreAminoAcidResiduesPresent: Invalid amino acid type: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">Type</span><span class="p">)</span>
  311 
  312     <span class="n">SelectionCmd</span> <span class="o">=</span> <span class="n">_SetupAminoAcidResiduesSelectionCmd</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">Type</span><span class="p">)</span>
  313     
  314     <span class="n">Status</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">cmd</span><span class="o">.</span><span class="n">count_atoms</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
  315     
  316     <span class="k">return</span> <span class="n">Status</span>
  317     
  318 <span class="k">def</span> <span class="nf">AreNucleicAcidResiduesPresent</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">):</span>
  319     <span class="sd">&quot;&quot;&quot;Check for the presence of nucleic acid residues in a chain of a </span>
  320 <span class="sd">    molecule. Chains are identified using PyMOL &#39;polymer&#39; selection.</span>
  321 
  322 <span class="sd">    Arguments:</span>
  323 <span class="sd">        MoleculeName (str): Name of a PyMOL molecule object.</span>
  324 <span class="sd">        ChainName (str): Name of a chain in a molecule.</span>
  325 
  326 <span class="sd">    Returns:</span>
  327 <span class="sd">        boolean: True or False.</span>
  328 
  329 <span class="sd">    &quot;&quot;&quot;</span>
  330     
  331     <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainName</span><span class="p">)):</span>
  332         <span class="k">return</span> <span class="bp">False</span>
  333     
  334     <span class="n">ResidueNames</span> <span class="o">=</span> <span class="n">_GetNucleicAcidResidueNames</span><span class="p">()</span>
  335     <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">ResidueNames</span><span class="p">):</span>
  336         <span class="k">return</span> <span class="bp">False</span>
  337     
  338     <span class="n">ResidueNamesSelection</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ResidueNames</span><span class="p">)</span>
  339     <span class="n">SelectionCmd</span> <span class="o">=</span> <span class="s2">&quot;(</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2"> and polymer and (resn </span><span class="si">%s</span><span class="s2">))&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">ResidueNamesSelection</span><span class="p">)</span>
  340 
  341     <span class="n">Status</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">cmd</span><span class="o">.</span><span class="n">count_atoms</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
  342     
  343     <span class="k">return</span> <span class="n">Status</span>
  344     
  345 <span class="k">def</span> <span class="nf">_SetupAminoAcidResiduesSelectionCmd</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">Type</span><span class="p">):</span>
  346     <span class="sd">&quot;&quot;&quot;Set up amino acids selection command for PyMOL. &quot;&quot;&quot;</span>
  347     
  348     <span class="n">AminoAcidsSelection</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_GetAminoAcidResidueNames</span><span class="p">())</span>
  349     <span class="n">NucleicAcidsSelection</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_GetNucleicAcidResidueNames</span><span class="p">())</span>
  350     
  351     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Standard$&quot;</span><span class="p">,</span> <span class="n">Type</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  352         <span class="n">SelectionCmd</span> <span class="o">=</span> <span class="s2">&quot;(</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2"> and polymer and (resn </span><span class="si">%s</span><span class="s2">))&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">AminoAcidsSelection</span><span class="p">)</span>
  353     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^NonStandard$&quot;</span><span class="p">,</span> <span class="n">Type</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  354         <span class="n">SelectionCmd</span> <span class="o">=</span> <span class="s2">&quot;(</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2"> and polymer and (not ((resn </span><span class="si">%s</span><span class="s2">) or (resn </span><span class="si">%s</span><span class="s2">))))&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">AminoAcidsSelection</span><span class="p">,</span> <span class="n">NucleicAcidsSelection</span><span class="p">)</span>
  355     <span class="k">else</span><span class="p">:</span>
  356         <span class="c1"># Any amino acid resiudes...</span>
  357         <span class="n">SelectionCmd</span> <span class="o">=</span> <span class="s2">&quot;(</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2"> and polymer and (not (resn </span><span class="si">%s</span><span class="s2">)))&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">NucleicAcidsSelection</span><span class="p">)</span>
  358 
  359     <span class="k">return</span> <span class="n">SelectionCmd</span>
  360 
  361 <span class="k">def</span> <span class="nf">_GetAminoAcidResidueNames</span><span class="p">():</span>
  362     <span class="sd">&quot;&quot;&quot;Get list of amino acid residue names.</span>
  363 <span class="sd">    &quot;&quot;&quot;</span>
  364     
  365     <span class="n">ResidueNames</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ALA&quot;</span><span class="p">,</span> <span class="s2">&quot;ARG&quot;</span><span class="p">,</span> <span class="s2">&quot;ASN&quot;</span><span class="p">,</span> <span class="s2">&quot;ASP&quot;</span><span class="p">,</span> <span class="s2">&quot;CYS&quot;</span><span class="p">,</span> <span class="s2">&quot;GLN&quot;</span><span class="p">,</span> <span class="s2">&quot;GLU&quot;</span><span class="p">,</span> <span class="s2">&quot;GLY&quot;</span><span class="p">,</span> <span class="s2">&quot;HIS&quot;</span><span class="p">,</span> <span class="s2">&quot;ILE&quot;</span><span class="p">,</span> <span class="s2">&quot;LEU&quot;</span><span class="p">,</span> <span class="s2">&quot;LYS&quot;</span><span class="p">,</span> <span class="s2">&quot;MET&quot;</span><span class="p">,</span> <span class="s2">&quot;PHE&quot;</span><span class="p">,</span> <span class="s2">&quot;PRO&quot;</span><span class="p">,</span> <span class="s2">&quot;SER&quot;</span><span class="p">,</span> <span class="s2">&quot;THR&quot;</span><span class="p">,</span> <span class="s2">&quot;TRP&quot;</span><span class="p">,</span> <span class="s2">&quot;TYR&quot;</span><span class="p">,</span> <span class="s2">&quot;VAL&quot;</span><span class="p">]</span>
  366     
  367     <span class="k">return</span> <span class="n">ResidueNames</span>
  368 
  369 <span class="k">def</span> <span class="nf">_GetNucleicAcidResidueNames</span><span class="p">():</span>
  370     <span class="sd">&quot;&quot;&quot;Get list of nucleic acid residue names.</span>
  371 <span class="sd">    &quot;&quot;&quot;</span>
  372     
  373     <span class="n">ResidueNames</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;G&quot;</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="s2">&quot;U&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;DA&quot;</span><span class="p">,</span> <span class="s2">&quot;DG&quot;</span><span class="p">,</span> <span class="s2">&quot;DT&quot;</span><span class="p">,</span> <span class="s2">&quot;DU&quot;</span><span class="p">,</span> <span class="s2">&quot;DC&quot;</span><span class="p">]</span>
  374     
  375     <span class="k">return</span> <span class="n">ResidueNames</span>
  376 
  377 <span class="k">def</span> <span class="nf">GetPolymerResiduesInfo</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">):</span>
  378     <span class="sd">&quot;&quot;&quot;Get information for residues present in a chain of a  molecule.</span>
  379 <span class="sd">    Chains are identified using PyMOL &#39;polymer&#39; selection.</span>
  380 
  381 <span class="sd">    Arguments:</span>
  382 <span class="sd">        MoleculeName (str): Name of a PyMOL molecule object.</span>
  383 <span class="sd">        ChainName (str): Name of a chain in a molecule.</span>
  384 
  385 <span class="sd">    Returns:</span>
  386 <span class="sd">        dict: A dictionary containing list of residue names and dictionaries of</span>
  387 <span class="sd">            residue numbers and residue count for each residue. Names of </span>
  388 <span class="sd">            residues in the dictionary are not sorted.</span>
  389 
  390 <span class="sd">    Examples:</span>
  391 
  392 <span class="sd">        ResiduesInfo = GetPolymerResiduesInfo(MolName, ChainName)</span>
  393 <span class="sd">        for ResName in ResiduesInfo[&quot;ResNames&quot;]:</span>
  394 <span class="sd">            ResCount = ResiduesInfo[&quot;ResCount&quot;][ResName]</span>
  395 <span class="sd">            ResNums = ResiduesInfo[&quot;ResNum&quot;][ResName]</span>
  396 <span class="sd">            MiscUtil.PrintInfo(&quot;ResName: %s; ResCount: %s; ResNums: %s&quot; %</span>
  397 <span class="sd">                (ResName, ResCount, ResNums))</span>
  398 
  399 <span class="sd">    &quot;&quot;&quot;</span>
  400     <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainName</span><span class="p">)):</span>
  401         <span class="k">return</span> <span class="bp">None</span>
  402 
  403     <span class="n">SelectionCmd</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2"> and polymer&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">)</span>
  404     <span class="n">ResiduesInfoMap</span> <span class="o">=</span> <span class="n">_GetSelectionResiduesInfo</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">)</span>
  405 
  406     <span class="k">return</span> <span class="n">ResiduesInfoMap</span>
  407 
  408 <span class="k">def</span> <span class="nf">GetAminoAcidResiduesInfo</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">Type</span> <span class="o">=</span> <span class="s2">&quot;Standard&quot;</span><span class="p">):</span>
  409     <span class="sd">&quot;&quot;&quot;Get information for amino acid residues present in a chain of a</span>
  410 <span class="sd">    molecule. Chains are identified using PyMOL &#39;polymer&#39; selection.</span>
  411 <span class="sd">    Nonstandard amino acid residues correspond to all residues other than</span>
  412 <span class="sd">    the standard amino acids and nucleic acids. Any amino acid residues cover</span>
  413 <span class="sd">    all residues other than the standard nucleic acids.</span>
  414 
  415 <span class="sd">    Arguments:</span>
  416 <span class="sd">        MoleculeName (str): Name of a PyMOL molecule object.</span>
  417 <span class="sd">        ChainName (str): Name of a chain in a molecule.</span>
  418 <span class="sd">        Type (str): Types of amino acids: Standard, NonStandard, Any</span>
  419 
  420 <span class="sd">    Returns:</span>
  421 <span class="sd">        dict: A dictionary containing list of residue names and dictionaries of</span>
  422 <span class="sd">            residue numbers and residue count for each residue. Names of </span>
  423 <span class="sd">            residues in the dictionary are not sorted.</span>
  424 
  425 <span class="sd">    Examples:</span>
  426 
  427 <span class="sd">        ResiduesInfo = GetPolymerResiduesInfo(MolName, ChainName)</span>
  428 <span class="sd">        for ResName in ResiduesInfo[&quot;ResNames&quot;]:</span>
  429 <span class="sd">            ResCount = ResiduesInfo[&quot;ResCount&quot;][ResName]</span>
  430 <span class="sd">            ResNums = ResiduesInfo[&quot;ResNum&quot;][ResName]</span>
  431 <span class="sd">            MiscUtil.PrintInfo(&quot;ResName: %s; ResCount: %s; ResNums: %s&quot; %</span>
  432 <span class="sd">                (ResName, ResCount, ResNums))</span>
  433 
  434 <span class="sd">    &quot;&quot;&quot;</span>
  435     
  436     <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainName</span><span class="p">)):</span>
  437         <span class="k">return</span> <span class="bp">None</span>
  438 
  439     <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(Standard|NonStandard|Any)$&quot;</span><span class="p">,</span> <span class="n">Type</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  440         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;PyMOLUtil.GetAminoAcidResiduesInfo: Invalid amino acid type: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">Type</span><span class="p">)</span>
  441     
  442     <span class="n">SelectionCmd</span> <span class="o">=</span> <span class="n">_SetupAminoAcidResiduesSelectionCmd</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">Type</span><span class="p">)</span>
  443     <span class="n">ResiduesInfoMap</span> <span class="o">=</span> <span class="n">_GetSelectionResiduesInfo</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">)</span>
  444 
  445     <span class="k">return</span> <span class="n">ResiduesInfoMap</span>
  446 
  447 <span class="k">def</span> <span class="nf">GetNucleicAcidResiduesInfo</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">):</span>
  448     <span class="sd">&quot;&quot;&quot;Get information for nucleic acid residues present in a chain of</span>
  449 <span class="sd">    a  molecule. Chains are identified using PyMOL &#39;polymer&#39; selection.</span>
  450 
  451 <span class="sd">    Arguments:</span>
  452 <span class="sd">        MoleculeName (str): Name of a PyMOL molecule object.</span>
  453 <span class="sd">        ChainName (str): Name of a chain in a molecule.</span>
  454 
  455 <span class="sd">    Returns:</span>
  456 <span class="sd">        dict: A dictionary containing list of residue names and dictionaries of</span>
  457 <span class="sd">            residue numbers and residue count for each residue. Names of </span>
  458 <span class="sd">            residues in the dictionary are not sorted.</span>
  459 
  460 <span class="sd">    Examples:</span>
  461 
  462 <span class="sd">        ResiduesInfo = GetPolymerResiduesInfo(MolName, ChainName)</span>
  463 <span class="sd">        for ResName in ResiduesInfo[&quot;ResNames&quot;]:</span>
  464 <span class="sd">            ResCount = ResiduesInfo[&quot;ResCount&quot;][ResName]</span>
  465 <span class="sd">            ResNums = ResiduesInfo[&quot;ResNum&quot;][ResName]</span>
  466 <span class="sd">            MiscUtil.PrintInfo(&quot;ResName: %s; ResCount: %s; ResNums: %s&quot; %</span>
  467 <span class="sd">                (ResName, ResCount, ResNums))</span>
  468 
  469 <span class="sd">    &quot;&quot;&quot;</span>
  470     
  471     <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainName</span><span class="p">)):</span>
  472         <span class="k">return</span> <span class="bp">None</span>
  473 
  474     <span class="n">ResidueNames</span> <span class="o">=</span> <span class="n">_GetNucleicAcidResidueNames</span><span class="p">()</span>
  475     
  476     <span class="n">ResidueNamesSelection</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ResidueNames</span><span class="p">)</span>
  477     <span class="n">SelectionCmd</span> <span class="o">=</span> <span class="s2">&quot;(</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2"> and polymer and (resn </span><span class="si">%s</span><span class="s2">))&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">ResidueNamesSelection</span><span class="p">)</span>
  478     
  479     <span class="n">ResiduesInfoMap</span> <span class="o">=</span> <span class="n">_GetSelectionResiduesInfo</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">)</span>
  480 
  481     <span class="k">return</span> <span class="n">ResiduesInfoMap</span>
  482 
  483 <span class="k">def</span> <span class="nf">GetSolventResiduesInfo</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">):</span>
  484     <span class="sd">&quot;&quot;&quot;Get information for solvent residues present in a chain of a  molecule.</span>
  485 <span class="sd">    Solvents are identified using PyMOL &#39;solvent&#39; selection.</span>
  486 
  487 <span class="sd">    Arguments:</span>
  488 <span class="sd">        MoleculeName (str): Name of a PyMOL molecule object.</span>
  489 <span class="sd">        ChainName (str): Name of a chain in a molecule.</span>
  490 
  491 <span class="sd">    Returns:</span>
  492 <span class="sd">        dict: A dictionary containing list of residue names and dictionaries of</span>
  493 <span class="sd">            residue numbers and residue count for each residue. Names of </span>
  494 <span class="sd">            residues in the dictionary are not sorted.</span>
  495 
  496 <span class="sd">    Examples:</span>
  497 
  498 <span class="sd">        ResiduesInfo = GetSolventResiduesInfo(MolName, ChainName)</span>
  499 <span class="sd">        for ResName in ResiduesInfo[&quot;ResNames&quot;]:</span>
  500 <span class="sd">            ResCount = ResiduesInfo[&quot;ResCount&quot;][ResName]</span>
  501 <span class="sd">            ResNums = ResiduesInfo[&quot;ResNum&quot;][ResName]</span>
  502 <span class="sd">            MiscUtil.PrintInfo(&quot;ResName: %s; ResCount: %s; ResNums: %s&quot; %</span>
  503 <span class="sd">                (ResName, ResCount, ResNums))</span>
  504 
  505 <span class="sd">    &quot;&quot;&quot;</span>
  506     <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainName</span><span class="p">)):</span>
  507         <span class="k">return</span> <span class="bp">None</span>
  508 
  509     <span class="n">SelectionCmd</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2"> and solvent&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">)</span>
  510     <span class="n">ResiduesInfoMap</span> <span class="o">=</span> <span class="n">_GetSelectionResiduesInfo</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">)</span>
  511 
  512     <span class="k">return</span> <span class="n">ResiduesInfoMap</span>
  513 
  514 <span class="k">def</span> <span class="nf">GetInorganicResiduesInfo</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">):</span>
  515     <span class="sd">&quot;&quot;&quot;Get information for inorganic residues present in a chain of a  molecule.</span>
  516 <span class="sd">    Inorganic residues are identified using PyMOL &#39;inorganic&#39; selection.</span>
  517 
  518 <span class="sd">    Arguments:</span>
  519 <span class="sd">        MoleculeName (str): Name of a PyMOL molecule object.</span>
  520 <span class="sd">        ChainName (str): Name of a chain in a molecule.</span>
  521 
  522 <span class="sd">    Returns:</span>
  523 <span class="sd">        dict: A dictionary containing list of residue names and dictionaries of</span>
  524 <span class="sd">            residue numbers and residue count for each residue. Names of </span>
  525 <span class="sd">            residues in the dictionary are not sorted.</span>
  526 
  527 <span class="sd">    Examples:</span>
  528 
  529 <span class="sd">        ResiduesInfo = GetInorganicResiduesInfo(MolName, ChainName)</span>
  530 <span class="sd">        for ResName in ResiduesInfo[&quot;ResNames&quot;]:</span>
  531 <span class="sd">            ResCount = ResiduesInfo[&quot;ResCount&quot;][ResName]</span>
  532 <span class="sd">            ResNums = ResiduesInfo[&quot;ResNum&quot;][ResName]</span>
  533 <span class="sd">            MiscUtil.PrintInfo(&quot;ResName: %s; ResCount: %s; ResNums: %s&quot; %</span>
  534 <span class="sd">                (ResName, ResCount, ResNums))</span>
  535 
  536 <span class="sd">    &quot;&quot;&quot;</span>
  537     <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainName</span><span class="p">)):</span>
  538         <span class="k">return</span> <span class="bp">None</span>
  539 
  540     <span class="n">SelectionCmd</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2"> and inorganic&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">)</span>
  541     <span class="n">ResiduesInfoMap</span> <span class="o">=</span> <span class="n">_GetSelectionResiduesInfo</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">)</span>
  542 
  543     <span class="k">return</span> <span class="n">ResiduesInfoMap</span>
  544 
  545 <span class="k">def</span> <span class="nf">GetLigandResiduesInfo</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">):</span>
  546     <span class="sd">&quot;&quot;&quot;Get information for ligand residues present in a chain of a  molecule.</span>
  547 <span class="sd">    Ligands are identified using PyMOL &#39;organic&#39; selection.</span>
  548 
  549 <span class="sd">    Arguments:</span>
  550 <span class="sd">        MoleculeName (str): Name of a PyMOL molecule object.</span>
  551 <span class="sd">        ChainName (str): Name of a chain in a molecule.</span>
  552 
  553 <span class="sd">    Returns:</span>
  554 <span class="sd">        dict: A dictionary containing list of residue names and dictionaries of</span>
  555 <span class="sd">            residue numbers and residue count for each residue. Names of </span>
  556 <span class="sd">            residues in the dictionary are not sorted.</span>
  557 
  558 <span class="sd">    Examples:</span>
  559 
  560 <span class="sd">        ResiduesInfo = GetLigandResiduesInfo(MolName, ChainName)</span>
  561 <span class="sd">        for ResName in ResiduesInfo[&quot;ResNames&quot;]:</span>
  562 <span class="sd">            ResCount = ResiduesInfo[&quot;ResCount&quot;][ResName]</span>
  563 <span class="sd">            ResNums = ResiduesInfo[&quot;ResNum&quot;][ResName]</span>
  564 <span class="sd">            MiscUtil.PrintInfo(&quot;ResName: %s; ResCount: %s; ResNums: %s&quot; %</span>
  565 <span class="sd">                (ResName, ResCount, ResNums))</span>
  566 
  567 <span class="sd">    &quot;&quot;&quot;</span>
  568     <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainName</span><span class="p">)):</span>
  569         <span class="k">return</span> <span class="bp">None</span>
  570 
  571     <span class="n">SelectionCmd</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2"> and organic&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">)</span>
  572     <span class="n">ResiduesInfoMap</span> <span class="o">=</span> <span class="n">_GetSelectionResiduesInfo</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">)</span>
  573 
  574     <span class="k">return</span> <span class="n">ResiduesInfoMap</span>
  575 
  576 <span class="k">def</span> <span class="nf">GetPocketPolymerResiduesInfo</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">LigandResName</span><span class="p">,</span> <span class="n">LigandResNum</span><span class="p">,</span> <span class="n">PocketDistanceCutoff</span><span class="p">):</span>
  577     <span class="sd">&quot;&quot;&quot;Get information for chain residues present in a pocket around a ligand</span>
  578 <span class="sd">    in a molecule. Polymer residues are identified using negation of PyMOL</span>
  579 <span class="sd">    selection operators &#39;organic&#39;, &#39;solvent&#39;, and &#39;inorganic&#39;.</span>
  580 
  581 <span class="sd">    Arguments:</span>
  582 <span class="sd">        MoleculeName (str): Name of a PyMOL molecule object.</span>
  583 <span class="sd">        ChainName (str): Name of a chain in a molecule.</span>
  584 <span class="sd">        LigandResName (str): Residue name of a ligand in a chain.</span>
  585 <span class="sd">        LigandResNum (str): Residue number of a ligand in a chain.</span>
  586 <span class="sd">        PocketDistanceCutoff (float): Distance around ligand to identify pocket</span>
  587 <span class="sd">            residues.</span>
  588 
  589 <span class="sd">    Returns:</span>
  590 <span class="sd">        dict: A dictionary containing list of residue names and dictionaries of</span>
  591 <span class="sd">            residue numbers and residue count for each residue. Names of </span>
  592 <span class="sd">            residues in the dictionary are not sorted.</span>
  593 
  594 <span class="sd">    Examples:</span>
  595 
  596 <span class="sd">        ResiduesInfo = GetPocketPolymerResiduesInfo(MolName, ChainName)</span>
  597 <span class="sd">        for ResName in ResiduesInfo[&quot;ResNames&quot;]:</span>
  598 <span class="sd">            ResCount = ResiduesInfo[&quot;ResCount&quot;][ResName]</span>
  599 <span class="sd">            ResNums = ResiduesInfo[&quot;ResNum&quot;][ResName]</span>
  600 <span class="sd">            MiscUtil.PrintInfo(&quot;ResName: %s; ResCount: %s; ResNums: %s&quot; %</span>
  601 <span class="sd">                (ResName, ResCount, ResNums))</span>
  602 
  603 <span class="sd">    &quot;&quot;&quot;</span>
  604     <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">LigandResName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">LigandResNum</span><span class="p">)):</span>
  605         <span class="k">return</span> <span class="bp">None</span>
  606 
  607     <span class="n">LigandSelection</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2"> and organic and resn </span><span class="si">%s</span><span class="s2"> and resi </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">LigandResName</span><span class="p">,</span> <span class="n">LigandResNum</span><span class="p">)</span>
  608     <span class="n">MoleculeSelection</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">)</span>
  609     <span class="n">SelectionCmd</span> <span class="o">=</span> <span class="s2">&quot;((byresidue (</span><span class="si">%s</span><span class="s2">) within </span><span class="si">%.1f</span><span class="s2"> of (</span><span class="si">%s</span><span class="s2">))  and (not solvent) and (not inorganic) and (not organic))&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeSelection</span><span class="p">,</span> <span class="n">PocketDistanceCutoff</span><span class="p">,</span> <span class="n">LigandSelection</span><span class="p">)</span>
  610 
  611     <span class="n">ResiduesInfoMap</span> <span class="o">=</span> <span class="n">_GetSelectionResiduesInfo</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">)</span>
  612 
  613     <span class="k">return</span> <span class="n">ResiduesInfoMap</span>
  614 
  615 <span class="k">def</span> <span class="nf">GetPocketSolventResiduesInfo</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">LigandResName</span><span class="p">,</span> <span class="n">LigandResNum</span><span class="p">,</span> <span class="n">PocketDistanceCutoff</span><span class="p">):</span>
  616     <span class="sd">&quot;&quot;&quot;Get information for solvent residues present in a pocket around a ligand</span>
  617 <span class="sd">    in a molecule. Solvent residues are identified using PyMOL &#39;solvent&#39;</span>
  618 <span class="sd">    selection.</span>
  619 
  620 <span class="sd">    Arguments:</span>
  621 <span class="sd">        MoleculeName (str): Name of a PyMOL molecule object.</span>
  622 <span class="sd">        ChainName (str): Name of a chain in a molecule.</span>
  623 <span class="sd">        LigandResName (str): Residue name of a ligand in a chain.</span>
  624 <span class="sd">        LigandResNum (str): Residue number of a ligand in a chain.</span>
  625 <span class="sd">        PocketDistanceCutoff (float): Distance around ligand to identify pocket</span>
  626 <span class="sd">            residues.</span>
  627 
  628 <span class="sd">    Returns:</span>
  629 <span class="sd">        dict: A dictionary containing list of residue names and dictionaries of</span>
  630 <span class="sd">            residue numbers and residue count for each residue. Names of </span>
  631 <span class="sd">            residues in the dictionary are not sorted.</span>
  632 
  633 <span class="sd">    Examples:</span>
  634 
  635 <span class="sd">        ResiduesInfo = GetPocketSolventResiduesInfo(MolName, ChainName)</span>
  636 <span class="sd">        for ResName in ResiduesInfo[&quot;ResNames&quot;]:</span>
  637 <span class="sd">            ResCount = ResiduesInfo[&quot;ResCount&quot;][ResName]</span>
  638 <span class="sd">            ResNums = ResiduesInfo[&quot;ResNum&quot;][ResName]</span>
  639 <span class="sd">            MiscUtil.PrintInfo(&quot;ResName: %s; ResCount: %s; ResNums: %s&quot; %</span>
  640 <span class="sd">                (ResName, ResCount, ResNums))</span>
  641 
  642 <span class="sd">    &quot;&quot;&quot;</span>
  643     <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">LigandResName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">LigandResNum</span><span class="p">)):</span>
  644         <span class="k">return</span> <span class="bp">None</span>
  645 
  646     <span class="n">LigandSelection</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2"> and organic and resn </span><span class="si">%s</span><span class="s2"> and resi </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">LigandResName</span><span class="p">,</span> <span class="n">LigandResNum</span><span class="p">)</span>
  647     <span class="n">MoleculeSelection</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">)</span>
  648     <span class="n">SelectionCmd</span> <span class="o">=</span> <span class="s2">&quot;((byresidue (</span><span class="si">%s</span><span class="s2">) within </span><span class="si">%.1f</span><span class="s2"> of (</span><span class="si">%s</span><span class="s2">))  and solvent)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeSelection</span><span class="p">,</span> <span class="n">PocketDistanceCutoff</span><span class="p">,</span> <span class="n">LigandSelection</span><span class="p">)</span>
  649 
  650     <span class="n">ResiduesInfoMap</span> <span class="o">=</span> <span class="n">_GetSelectionResiduesInfo</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">)</span>
  651 
  652     <span class="k">return</span> <span class="n">ResiduesInfoMap</span>
  653 
  654 <span class="k">def</span> <span class="nf">GetPocketInorganicResiduesInfo</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">LigandResName</span><span class="p">,</span> <span class="n">LigandResNum</span><span class="p">,</span> <span class="n">PocketDistanceCutoff</span><span class="p">):</span>
  655     <span class="sd">&quot;&quot;&quot;Get information for inorganic residues present in a pocket around a</span>
  656 <span class="sd">    ligand in a molecule. Inorganic residues are identified using PyMOL</span>
  657 <span class="sd">    &#39;inorganic&#39; selection.</span>
  658 
  659 <span class="sd">    Arguments:</span>
  660 <span class="sd">        MoleculeName (str): Name of a PyMOL molecule object.</span>
  661 <span class="sd">        ChainName (str): Name of a chain in a molecule.</span>
  662 <span class="sd">        LigandResName (str): Residue name of a ligand in a chain.</span>
  663 <span class="sd">        LigandResNum (str): Residue number of a ligand in a chain.</span>
  664 <span class="sd">        PocketDistanceCutoff (float): Distance around a ligand to identify</span>
  665 <span class="sd">            pocket residues.</span>
  666 
  667 <span class="sd">    Returns:</span>
  668 <span class="sd">        dict: A dictionary containing list of residue names and dictionaries of</span>
  669 <span class="sd">            residue numbers and residue count for each residue. Names of </span>
  670 <span class="sd">            residues in the dictionary are not sorted.</span>
  671 
  672 <span class="sd">    Examples:</span>
  673 
  674 <span class="sd">        ResiduesInfo = GetPocketInorganicResiduesInfo(MolName, ChainName)</span>
  675 <span class="sd">        for ResName in ResiduesInfo[&quot;ResNames&quot;]:</span>
  676 <span class="sd">            ResCount = ResiduesInfo[&quot;ResCount&quot;][ResName]</span>
  677 <span class="sd">            ResNums = ResiduesInfo[&quot;ResNum&quot;][ResName]</span>
  678 <span class="sd">            MiscUtil.PrintInfo(&quot;ResName: %s; ResCount: %s; ResNums: %s&quot; %</span>
  679 <span class="sd">                (ResName, ResCount, ResNums))</span>
  680 
  681 <span class="sd">    &quot;&quot;&quot;</span>
  682     <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">LigandResName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">LigandResNum</span><span class="p">)):</span>
  683         <span class="k">return</span> <span class="bp">None</span>
  684 
  685     <span class="n">LigandSelection</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2"> and organic and resn </span><span class="si">%s</span><span class="s2"> and resi </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">LigandResName</span><span class="p">,</span> <span class="n">LigandResNum</span><span class="p">)</span>
  686     <span class="n">MoleculeSelection</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">)</span>
  687     <span class="n">SelectionCmd</span> <span class="o">=</span> <span class="s2">&quot;((byresidue (</span><span class="si">%s</span><span class="s2">) within </span><span class="si">%.1f</span><span class="s2"> of (</span><span class="si">%s</span><span class="s2">))  and inorganic)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeSelection</span><span class="p">,</span> <span class="n">PocketDistanceCutoff</span><span class="p">,</span> <span class="n">LigandSelection</span><span class="p">)</span>
  688 
  689     <span class="n">ResiduesInfoMap</span> <span class="o">=</span> <span class="n">_GetSelectionResiduesInfo</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">)</span>
  690 
  691     <span class="k">return</span> <span class="n">ResiduesInfoMap</span>
  692 
  693 <span class="k">def</span> <span class="nf">_GetSelectionResiduesInfo</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">):</span>
  694     <span class="sd">&quot;&quot;&quot;Get residue names and count information for a selection. &quot;&quot;&quot;</span>
  695     
  696     <span class="c1"># Retrieve atoms...</span>
  697     <span class="n">stored</span><span class="o">.</span><span class="n">SelectionInfo</span> <span class="o">=</span> <span class="p">[]</span>
  698     <span class="n">cmd</span><span class="o">.</span><span class="n">iterate</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">,</span> <span class="s2">&quot;stored.SelectionInfo.append([resi, resn])&quot;</span><span class="p">)</span>
  699 
  700     <span class="c1"># Retrieve residues...</span>
  701     <span class="n">SelectionInfoMap</span> <span class="o">=</span> <span class="p">{}</span>
  702     <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNames&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  703     <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNum&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  704     <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResCount&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  705 
  706     <span class="n">PreviousResNum</span> <span class="o">=</span> <span class="mi">0</span>
  707     <span class="k">for</span> <span class="n">ResNum</span><span class="p">,</span> <span class="n">ResName</span> <span class="ow">in</span> <span class="n">stored</span><span class="o">.</span><span class="n">SelectionInfo</span><span class="p">:</span>
  708         <span class="k">if</span> <span class="n">ResName</span> <span class="ow">in</span> <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNames&quot;</span><span class="p">]:</span>
  709             <span class="k">if</span> <span class="n">ResNum</span> <span class="o">!=</span> <span class="n">PreviousResNum</span><span class="p">:</span>
  710                 <span class="c1"># Same residue name but different residue number</span>
  711                 <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNum&quot;</span><span class="p">][</span><span class="n">ResName</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResNum</span><span class="p">)</span>
  712                 <span class="n">PreviousResNum</span> <span class="o">=</span> <span class="n">ResNum</span>
  713                 
  714                 <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResCount&quot;</span><span class="p">][</span><span class="n">ResName</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
  715         <span class="k">else</span><span class="p">:</span>
  716             <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNames&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResName</span><span class="p">)</span>
  717             
  718             <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNum&quot;</span><span class="p">][</span><span class="n">ResName</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  719             <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNum&quot;</span><span class="p">][</span><span class="n">ResName</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResNum</span><span class="p">)</span>
  720             <span class="n">PreviousResNum</span> <span class="o">=</span> <span class="n">ResNum</span>
  721             
  722             <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResCount&quot;</span><span class="p">][</span><span class="n">ResName</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
  723                 
  724     <span class="k">return</span> <span class="n">SelectionInfoMap</span>
  725 
  726 <span class="k">def</span> <span class="nf">ProcessChainsAndLigandsOptionsInfo</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">,</span> <span class="n">ChainsOptionName</span><span class="p">,</span> <span class="n">ChainsOptionValue</span><span class="p">,</span> <span class="n">LigandsOptionName</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">LigandsOptionValue</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
  727     <span class="sd">&quot;&quot;&quot;Process specified chain and ligand IDs using command line options.</span>
  728 
  729 <span class="sd">    Arguments:</span>
  730 <span class="sd">        ChainsAndLigandsInfo (dict): A dictionary containing information</span>
  731 <span class="sd">            existing chains and ligands. </span>
  732 <span class="sd">        ChainsOptionName (str): Name of command line chains option.</span>
  733 <span class="sd">        ChainsOptionValue (str): Value for command line chains option.</span>
  734 <span class="sd">        LigandsOptionName (str): Name of command line ligands option.</span>
  735 <span class="sd">        LigandsOptionValue (str): Value for command line ligands option.</span>
  736 
  737 <span class="sd">    Returns:</span>
  738 <span class="sd">        dict: A dictionary containing list of chain identifiers and dictionaries</span>
  739 <span class="sd">            of chains containing lists of ligand names for each chain.</span>
  740 
  741 <span class="sd">    Examples:</span>
  742 
  743 <span class="sd">        ChainsAndLigandsInfo = ProcessChainsAndLigandsOptionsInfo(Infile,</span>
  744 <span class="sd">            MolName)</span>
  745 <span class="sd">        for ChainID in ChainsAndLigandsInfo[&quot;ChainIDs&quot;]:</span>
  746 <span class="sd">            for LigandID in ChainsAndLigandsInfo[&quot;LigandIDs&quot;][ChainID]:</span>
  747 <span class="sd">                MiscUtil.PrintInfo(&quot;ChainID: %s; LigandID: %s&quot; % (ChainID,</span>
  748 <span class="sd">                    LigandID))</span>
  749 
  750 <span class="sd">    &quot;&quot;&quot;</span>
  751     <span class="n">SpecifiedChainsAndLigandsInfo</span> <span class="o">=</span> <span class="p">{}</span>
  752     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  753     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  754 
  755     <span class="k">if</span> <span class="n">ChainsOptionValue</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  756         <span class="k">return</span> <span class="n">SpecifiedChainsAndLigandsInfo</span>
  757         
  758     <span class="n">_ProcessChainIDs</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">,</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">,</span> <span class="n">ChainsOptionName</span><span class="p">,</span> <span class="n">ChainsOptionValue</span><span class="p">)</span>
  759 
  760     <span class="k">if</span> <span class="n">LigandsOptionValue</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  761         <span class="k">return</span> <span class="n">SpecifiedChainsAndLigandsInfo</span>
  762     
  763     <span class="n">_ProcessLigandIDs</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">,</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">,</span> <span class="n">LigandsOptionName</span><span class="p">,</span> <span class="n">LigandsOptionValue</span><span class="p">)</span>
  764     
  765     <span class="k">return</span> <span class="n">SpecifiedChainsAndLigandsInfo</span>
  766 
  767 <span class="k">def</span> <span class="nf">_ProcessChainIDs</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">,</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">,</span> <span class="n">ChainsOptionName</span><span class="p">,</span> <span class="n">ChainsOptionValue</span><span class="p">):</span>
  768     <span class="sd">&quot;&quot;&quot;Process chain IDs&quot;&quot;&quot;</span>
  769 
  770     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Processing chain IDs...&quot;</span><span class="p">)</span>
  771     
  772     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^All$&quot;</span><span class="p">,</span> <span class="n">ChainsOptionValue</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  773         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span>
  774         <span class="k">return</span>
  775     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(First|Auto)$&quot;</span><span class="p">,</span> <span class="n">ChainsOptionValue</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  776         <span class="n">FirstChainID</span> <span class="o">=</span> <span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]))</span> <span class="k">else</span> <span class="bp">None</span>
  777         <span class="k">if</span> <span class="n">FirstChainID</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
  778             <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">FirstChainID</span><span class="p">)</span>
  779         <span class="k">return</span>
  780     
  781     <span class="n">ChainIDs</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">ChainsOptionValue</span><span class="p">)</span>
  782     <span class="k">if</span> <span class="ow">not</span> <span class="n">ChainIDs</span><span class="p">:</span>
  783         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;No valid value specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option.&quot;</span> <span class="o">%</span> <span class="n">ChainsOptionName</span><span class="p">)</span>
  784 
  785     <span class="n">ChainIDsList</span> <span class="o">=</span> <span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span>
  786     <span class="n">SpecifiedChainIDsList</span> <span class="o">=</span> <span class="p">[]</span>
  787     
  788     <span class="n">ChainIDsWords</span> <span class="o">=</span> <span class="n">ChainIDs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
  789     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">ChainIDsWords</span><span class="p">:</span>
  790         <span class="k">if</span> <span class="ow">not</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">ChainIDsList</span><span class="p">:</span>
  791             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;The chain ID, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is not valid. It&#39;ll be ignored. Valid chain IDs: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">,</span> <span class="n">ChainsOptionName</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ChainIDsList</span><span class="p">)))</span>
  792             <span class="k">continue</span>
  793         <span class="k">if</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainIDsList</span><span class="p">:</span>
  794             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;The chain ID, </span><span class="si">%s</span><span class="s2">, has already been specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option. It&#39;ll be ignored.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">,</span> <span class="n">ChainsOptionName</span><span class="p">))</span>
  795             <span class="k">continue</span>
  796         <span class="n">SpecifiedChainIDsList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainID</span><span class="p">)</span>
  797     
  798     <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">SpecifiedChainIDsList</span><span class="p">):</span>
  799         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;No valid chain IDs </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">  specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainsOptionValue</span><span class="p">,</span> <span class="n">ChainsOptionName</span><span class="p">))</span>
  800     
  801     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SpecifiedChainIDsList</span>
  802     
  803 <span class="k">def</span> <span class="nf">_ProcessLigandIDs</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">,</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">,</span> <span class="n">LigandsOptionName</span><span class="p">,</span> <span class="n">LigandsOptionValue</span><span class="p">):</span>
  804     <span class="sd">&quot;&quot;&quot;Process ligand IDs&quot;&quot;&quot;</span>
  805 
  806     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Processing ligand IDs...&quot;</span><span class="p">)</span>
  807     
  808     <span class="c1"># Intialize ligand IDs...</span>
  809     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span> <span class="p">:</span>
  810         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  811         
  812     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^All$&quot;</span><span class="p">,</span> <span class="n">LigandsOptionValue</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  813         <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span> <span class="p">:</span>
  814             <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
  815         <span class="k">return</span>
  816     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(Largest|Auto)$&quot;</span><span class="p">,</span> <span class="n">LigandsOptionValue</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  817         <span class="c1"># Setup largest ligand ID for each chain...</span>
  818         <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span> <span class="p">:</span>
  819             <span class="n">LargestLigandID</span> <span class="o">=</span> <span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]))</span> <span class="k">else</span> <span class="bp">None</span>
  820             <span class="k">if</span> <span class="n">LargestLigandID</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
  821                 <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">LargestLigandID</span><span class="p">)</span>
  822         <span class="k">return</span>
  823     
  824     <span class="n">LigandIDs</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">LigandsOptionValue</span><span class="p">)</span>
  825     <span class="k">if</span> <span class="ow">not</span> <span class="n">LigandIDs</span><span class="p">:</span>
  826         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;No valid value specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option.&quot;</span> <span class="o">%</span> <span class="n">LigandsOptionName</span><span class="p">)</span>
  827     
  828     <span class="n">LigandIDsWords</span> <span class="o">=</span> <span class="n">LigandIDs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
  829     
  830     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
  831         <span class="n">LigandIDsList</span> <span class="o">=</span> <span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
  832         <span class="n">SpecifiedLigandIDsList</span> <span class="o">=</span> <span class="p">[]</span>
  833 
  834         <span class="k">for</span> <span class="n">LigandID</span> <span class="ow">in</span> <span class="n">LigandIDsWords</span><span class="p">:</span>
  835             <span class="k">if</span> <span class="ow">not</span> <span class="n">LigandID</span> <span class="ow">in</span> <span class="n">LigandIDsList</span><span class="p">:</span>
  836                 <span class="n">LigandIDsListNames</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">LigandIDsList</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">LigandIDsList</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;None&quot;</span>
  837                 <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;The ligand ID, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is not valid for chain, </span><span class="si">%s</span><span class="s2">. It&#39;ll be ignored. Valid ligand IDs: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">LigandID</span><span class="p">,</span> <span class="n">LigandsOptionName</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandIDsListNames</span><span class="p">))</span>
  838                 <span class="k">continue</span>
  839             <span class="k">if</span> <span class="n">LigandID</span> <span class="ow">in</span> <span class="n">SpecifiedLigandIDsList</span><span class="p">:</span>
  840                 <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;The ligand ID, </span><span class="si">%s</span><span class="s2">, has already been specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option. It&#39;ll be ignored.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">LigandID</span><span class="p">,</span> <span class="n">LigandsOptionName</span><span class="p">))</span>
  841                 <span class="k">continue</span>
  842             <span class="n">SpecifiedLigandIDsList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">LigandID</span><span class="p">)</span>
  843             
  844         <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">SpecifiedLigandIDsList</span><span class="p">):</span>
  845             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;No valid ligand IDs </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option for chain ID, </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">LigandsOptionValue</span><span class="p">,</span> <span class="n">LigandsOptionName</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">))</span>
  846         
  847         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SpecifiedLigandIDsList</span>
  848     
  849 <span class="k">def</span> <span class="nf">CalculateCenterOfMass</span><span class="p">(</span><span class="n">Selection</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="n">Quiet</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
  850     <span class="sd">&quot;&quot;&quot;Calculate center of mass for a selection.</span>
  851 
  852 <span class="sd">    Arguments:</span>
  853 <span class="sd">        Selection (str): A PyMOL selection.</span>
  854 <span class="sd">        Quiet (int): Print information.</span>
  855 
  856 <span class="sd">    Returns:</span>
  857 <span class="sd">        list: X, Y, Z coordinates for center of mass.</span>
  858 
  859 <span class="sd">    &quot;&quot;&quot;</span>
  860     <span class="n">MassTotal</span> <span class="o">=</span> <span class="mf">0.0</span>
  861     <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
  862     
  863     <span class="n">Atoms</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="n">get_model</span><span class="p">(</span><span class="n">Selection</span><span class="p">)</span>
  864     <span class="k">for</span> <span class="n">Atom</span> <span class="ow">in</span> <span class="n">Atoms</span><span class="o">.</span><span class="n">atom</span><span class="p">:</span>
  865         <span class="n">Mass</span> <span class="o">=</span> <span class="n">Atom</span><span class="o">.</span><span class="n">get_mass</span><span class="p">()</span>
  866         <span class="n">MassTotal</span> <span class="o">+=</span> <span class="n">Mass</span>
  867 
  868         <span class="n">X</span> <span class="o">+=</span> <span class="n">Atom</span><span class="o">.</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">Mass</span>
  869         <span class="n">Y</span> <span class="o">+=</span> <span class="n">Atom</span><span class="o">.</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">Mass</span>
  870         <span class="n">Z</span> <span class="o">+=</span> <span class="n">Atom</span><span class="o">.</span><span class="n">coord</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">Mass</span>
  871 
  872     <span class="n">XCOM</span> <span class="o">=</span> <span class="n">X</span><span class="o">/</span><span class="n">MassTotal</span>
  873     <span class="n">YCOM</span> <span class="o">=</span> <span class="n">Y</span><span class="o">/</span><span class="n">MassTotal</span>
  874     <span class="n">ZCOM</span> <span class="o">=</span> <span class="n">Z</span><span class="o">/</span><span class="n">MassTotal</span>
  875 
  876     <span class="k">if</span> <span class="ow">not</span> <span class="n">Quiet</span><span class="p">:</span>
  877         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;PyMOLUtil.CalculateCenterOfMass: </span><span class="si">%f</span><span class="s2">, </span><span class="si">%f</span><span class="s2">, </span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">XCOM</span><span class="p">,</span> <span class="n">YCOM</span><span class="p">,</span> <span class="n">ZCOM</span><span class="p">))</span>
  878     
  879     <span class="k">return</span> <span class="p">[</span><span class="n">XCOM</span><span class="p">,</span> <span class="n">YCOM</span><span class="p">,</span> <span class="n">ZCOM</span><span class="p">]</span>
  880 
  881 <span class="k">def</span> <span class="nf">ConvertFileFormat</span><span class="p">(</span><span class="n">Infile</span><span class="p">,</span> <span class="n">Outfile</span><span class="p">,</span> <span class="n">Reinitialize</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">OutputFeedback</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
  882     <span class="sd">&quot;&quot;&quot;Convert infile to outfile by automatically detecting their formats</span>
  883 <span class="sd">    from the file extensions.</span>
  884 
  885 <span class="sd">    The formats of both input and output files must be a valid format supported</span>
  886 <span class="sd">    by PyMOL.</span>
  887 
  888 <span class="sd">    Arguments:</span>
  889 <span class="sd">        Infile (str): Name of input file.</span>
  890 <span class="sd">        Outfile (str): Name of outfile file.</span>
  891 <span class="sd">        Reinitialize (bool): Reinitialize PyMOL before loading input file.</span>
  892 <span class="sd">        OutputFeedback (bool): Control output feedback.</span>
  893 
  894 <span class="sd">    &quot;&quot;&quot;</span>
  895     
  896     <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">Infile</span><span class="p">):</span>
  897         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;The input file, </span><span class="si">%s</span><span class="s2">, doesn&#39;t exists.</span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Infile</span><span class="p">))</span>
  898 
  899     <span class="k">if</span> <span class="n">Reinitialize</span><span class="p">:</span>
  900         <span class="n">cmd</span><span class="o">.</span><span class="n">reinitialize</span><span class="p">()</span>
  901 
  902     <span class="k">if</span> <span class="ow">not</span> <span class="n">OutputFeedback</span><span class="p">:</span>
  903         <span class="c1"># Turn off output feedback...</span>
  904         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Disabling output feedback for PyMOL...&quot;</span><span class="p">)</span>
  905         <span class="n">cmd</span><span class="o">.</span><span class="n">feedback</span><span class="p">(</span><span class="s2">&quot;disable&quot;</span><span class="p">,</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="s2">&quot;output&quot;</span><span class="p">)</span>
  906 
  907     <span class="n">FileDir</span><span class="p">,</span> <span class="n">FileName</span><span class="p">,</span> <span class="n">FileExt</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ParseFileName</span><span class="p">(</span><span class="n">Infile</span><span class="p">)</span>
  908     <span class="n">MolName</span> <span class="o">=</span> <span class="n">FileName</span>
  909     
  910     <span class="n">cmd</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">Infile</span><span class="p">,</span> <span class="n">MolName</span><span class="p">)</span>
  911     <span class="n">cmd</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">Outfile</span><span class="p">,</span> <span class="n">MolName</span><span class="p">)</span>
  912     <span class="n">cmd</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">MolName</span><span class="p">)</span>
  913     
  914     <span class="k">if</span> <span class="ow">not</span> <span class="n">OutputFeedback</span><span class="p">:</span>
  915         <span class="c1"># Turn it back on...</span>
  916         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Enabling output feedback for PyMOL...&quot;</span><span class="p">)</span>
  917         <span class="n">cmd</span><span class="o">.</span><span class="n">feedback</span><span class="p">(</span><span class="s2">&quot;enable&quot;</span><span class="p">,</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="s2">&quot;output&quot;</span><span class="p">)</span>
  918 
  919 <span class="k">def</span> <span class="nf">ConvertPMLFileToPSEFile</span><span class="p">(</span><span class="n">PMLFile</span><span class="p">,</span> <span class="n">PSEFile</span><span class="p">,</span> <span class="n">Reinitialize</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">OutputFeedback</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
  920     <span class="sd">&quot;&quot;&quot;Convert PML file to PME file.</span>
  921 
  922 <span class="sd">    Arguments:</span>
  923 <span class="sd">        PMLFile (str): Name of PML file.</span>
  924 <span class="sd">        PSEFile (str): Name of PSE file.</span>
  925 <span class="sd">        Reinitialize (bool): Reinitialize PyMOL before loading PML file.</span>
  926 <span class="sd">        OutputFeedback (bool): Control output feedback.</span>
  927 
  928 <span class="sd">    &quot;&quot;&quot;</span>
  929     
  930     <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">PMLFile</span><span class="p">):</span>
  931         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;The PML file, </span><span class="si">%s</span><span class="s2">, doesn&#39;t exists.</span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PMLFile</span><span class="p">))</span>
  932 
  933     <span class="k">if</span> <span class="n">Reinitialize</span><span class="p">:</span>
  934         <span class="n">cmd</span><span class="o">.</span><span class="n">reinitialize</span><span class="p">()</span>
  935 
  936     <span class="k">if</span> <span class="ow">not</span> <span class="n">OutputFeedback</span><span class="p">:</span>
  937         <span class="c1"># Turn off output feedback...</span>
  938         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Disabling output feedback for PyMOL...&quot;</span><span class="p">)</span>
  939         <span class="n">cmd</span><span class="o">.</span><span class="n">feedback</span><span class="p">(</span><span class="s2">&quot;disable&quot;</span><span class="p">,</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="s2">&quot;output&quot;</span><span class="p">)</span>
  940 
  941     <span class="n">cmd</span><span class="o">.</span><span class="n">do</span><span class="p">(</span><span class="s2">&quot;@</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PMLFile</span><span class="p">)</span>
  942     <span class="n">cmd</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">PSEFile</span><span class="p">)</span>
  943     
  944     <span class="k">if</span> <span class="ow">not</span> <span class="n">OutputFeedback</span><span class="p">:</span>
  945         <span class="c1"># Turn it back on...</span>
  946         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Enabling output feedback for PyMOL...&quot;</span><span class="p">)</span>
  947         <span class="n">cmd</span><span class="o">.</span><span class="n">feedback</span><span class="p">(</span><span class="s2">&quot;enable&quot;</span><span class="p">,</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="s2">&quot;output&quot;</span><span class="p">)</span>
  948 
  949 <span class="k">def</span> <span class="nf">SetupPMLHeaderInfo</span><span class="p">(</span><span class="n">ScriptName</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">IncludeLocalPython</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
  950     <span class="sd">&quot;&quot;&quot;Setup header information for generating PML files. The local Python</span>
  951 <span class="sd">    functions are optionally embedded in the header information for their</span>
  952 <span class="sd">    use in PML files.</span>
  953 <span class="sd"> </span>
  954 <span class="sd">    Arguments:</span>
  955 <span class="sd">        ScriptName (str): Name of script calling the function.</span>
  956 <span class="sd">        IncludeLocalPython (bool): Include local Python functions.</span>
  957 
  958 <span class="sd">    Returns:</span>
  959 <span class="sd">        str: Text containing header information for generating PML files.</span>
  960 
  961 <span class="sd">    &quot;&quot;&quot;</span>
  962     <span class="k">if</span> <span class="n">ScriptName</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  963         <span class="n">HeaderInfo</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  964 <span class="s2">#</span>
  965 <span class="s2"># This file is automatically generated by a script available in MayaChemTools.</span>
  966 <span class="s2">#</span>
  967 <span class="s2">cmd.reinitialize()&quot;&quot;&quot;</span>
  968     <span class="k">else</span><span class="p">:</span>
  969         <span class="n">HeaderInfo</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  970 <span class="s2">#</span>
  971 <span class="s2"># This file is automatically generated by the following PyMOL script available in</span>
  972 <span class="s2"># MayaChemTools: </span><span class="si">%s</span><span class="s2"></span>
  973 <span class="s2">#</span>
  974 <span class="s2">cmd.reinitialize() &quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ScriptName</span><span class="p">)</span>
  975 
  976     <span class="k">if</span> <span class="n">IncludeLocalPython</span><span class="p">:</span>
  977         <span class="n">PMLForLocalPython</span> <span class="o">=</span> <span class="n">_SetupPMLForLocalPython</span><span class="p">()</span>
  978         <span class="n">HeaderInfo</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n\n</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">HeaderInfo</span><span class="p">,</span> <span class="n">PMLForLocalPython</span><span class="p">)</span>
  979     
  980     <span class="k">return</span> <span class="n">HeaderInfo</span>
  981 
  982 <span class="k">def</span> <span class="nf">_SetupPMLForLocalPython</span><span class="p">():</span>
  983     <span class="sd">&quot;&quot;&quot;Setup local Python functions for PML file.</span>
  984 <span class="sd">    &quot;&quot;&quot;</span>
  985     
  986     <span class="n">PMLForPython</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  987 <span class="s2">&quot;&quot;</span>
  988 <span class="s2">&quot;Setting up local Python functions  for PML script...&quot;</span>
  989 <span class="s2">&quot;&quot;</span>
  990 <span class="s2">python</span>
  991 
  992 <span class="s2">from __future__ import print_function</span>
  993 <span class="s2">import re</span>
  994 
  995 <span class="s2">def ColorByHydrophobicity(Selection, ColorPalette = &quot;RedToWhite&quot;):</span>
  996 <span class="s2">    </span><span class="se">\&quot;</span><span class="s2">&quot;&quot;Color by hydrophobicity using hydrophobic values for amino acid</span>
  997 <span class="s2">    residues corresponding to the Eisenberg hydrophobicity scale.</span>
  998 <span class="s2">    </span>
  999 <span class="s2">    Possible values for ColorPalette: RedToWhite or WhiteToGreen from most</span>
 1000 <span class="s2">    hydrophobic amino acid to least hydrophobic.</span>
 1001 <span class="s2">    </span>
 1002 <span class="s2">    The colors values for amino acids are taken from color_h script avaiable</span>
 1003 <span class="s2">    as part of the Script Library at PyMOL Wiki. </span>
 1004 <span class="s2">        </span>
 1005 <span class="s2">    </span><span class="se">\&quot;</span><span class="s2">&quot;&quot;</span>
 1006 <span class="s2">        </span>
 1007 <span class="s2">    if not re.match(&quot;^(RedToWhite|WhiteToGreen)$&quot;, ColorPalette, re.I):</span>
 1008 <span class="s2">        print(&quot;Invalid ColorPalette value: </span><span class="si">%s</span><span class="s2">. Valid values: RedToWhite, WhiteToGreen&quot; % ColorPalette)</span>
 1009 <span class="s2">    </span>
 1010 <span class="s2">    ResColors = {}</span>
 1011 <span class="s2">    ColorType = &quot;&quot;</span>
 1012 <span class="s2">    </span>
 1013 <span class="s2">    if re.match(&quot;^WhiteToGreen$&quot;, ColorPalette, re.I):</span>
 1014 <span class="s2">        ColorType = &quot;H2&quot;</span>
 1015 <span class="s2">        ResColors = {&quot;ile&quot; : [0.938,1,0.938], &quot;phe&quot; : [0.891,1,0.891], &quot;val&quot; : [0.844,1,0.844], &quot;leu&quot; : [0.793,1,0.793], &quot;trp&quot; : [0.746,1,0.746], &quot;met&quot; : [0.699,1,0.699], &quot;ala&quot; : [0.652,1,0.652], &quot;gly&quot; : [0.606,1,0.606], &quot;cys&quot; : [0.555,1,0.555], &quot;tyr&quot; : [0.508,1,0.508], &quot;pro&quot; : [0.461,1,0.461], &quot;thr&quot; : [0.414,1,0.414], &quot;ser&quot; : [0.363,1,0.363], &quot;his&quot; : [0.316,1,0.316], &quot;glu&quot; : [0.27,1,0.27], &quot;asn&quot; : [0.223,1,0.223], &quot;gln&quot; : [0.176,1,0.176], &quot;asp&quot; : [0.125,1,0.125], &quot;lys&quot; : [0.078,1,0.078], &quot;arg&quot; : [0.031,1,0.031]}</span>
 1016 <span class="s2">    else:</span>
 1017 <span class="s2">        ColorType = &quot;H1&quot;</span>
 1018 <span class="s2">        ResColors = {&quot;ile&quot; : [0.996,0.062,0.062], &quot;phe&quot; : [0.996,0.109,0.109], &quot;val&quot; : [0.992,0.156,0.156], &quot;leu&quot; : [0.992,0.207,0.207], &quot;trp&quot; : [0.992,0.254,0.254], &quot;met&quot; : [0.988,0.301,0.301], &quot;ala&quot; : [0.988,0.348,0.348], &quot;gly&quot; : [0.984,0.394,0.394], &quot;cys&quot; : [0.984,0.445,0.445], &quot;tyr&quot; : [0.984,0.492,0.492], &quot;pro&quot; : [0.980,0.539,0.539], &quot;thr&quot; : [0.980,0.586,0.586], &quot;ser&quot; : [0.980,0.637,0.637], &quot;his&quot; : [0.977,0.684,0.684], &quot;glu&quot; : [0.977,0.730,0.730], &quot;asn&quot; : [0.973,0.777,0.777], &quot;gln&quot; : [0.973,0.824,0.824], &quot;asp&quot; : [0.973,0.875,0.875], &quot;lys&quot; : [0.899,0.922,0.922], &quot;arg&quot; : [0.899,0.969,0.969]}</span>
 1019 <span class="s2">        </span>
 1020 <span class="s2">    # Set up colors...</span>
 1021 <span class="s2">    for ResName in ResColors:</span>
 1022 <span class="s2">        ColorName = &quot;color_</span><span class="si">%s</span><span class="s2">_</span><span class="si">%s</span><span class="s2">&quot; % (ResName, ColorType)</span>
 1023 <span class="s2">        cmd.set_color(ColorName, ResColors[ResName])</span>
 1024 <span class="s2">        </span>
 1025 <span class="s2">        ResSelection = &quot;(</span><span class="si">%s</span><span class="s2"> and resn </span><span class="si">%s</span><span class="s2">*)&quot; % (Selection, ResName)</span>
 1026 <span class="s2">        cmd.color(ColorName, ResSelection)</span>
 1027 <span class="s2">    </span>
 1028 <span class="s2">cmd.extend(&quot;ColorByHydrophobicity&quot;, ColorByHydrophobicity)</span>
 1029 
 1030 <span class="s2">def ColorAtomsByHydrophobicityAndCharge(Selection, HydrophobicAtomsColor = &quot;yellow&quot;, NegativelyChargedAtomsColor = &quot;red&quot;, PositivelyChargedAtomsColor = &quot;blue&quot;, OtherAtomsColor = &quot;gray90&quot;):</span>
 1031 <span class="s2">    </span><span class="se">\&quot;</span><span class="s2">&quot;&quot;Color atoms in amino acids by their propensity to make hydrophobic and</span>
 1032 <span class="s2">    charge interactions [REF 140].  The atom names in standard amino acid</span>
 1033 <span class="s2">    residues are used to identify atom types as shown below:</span>
 1034 <span class="s2">    </span>
 1035 <span class="s2">        Hydrophobic: C atoms not bound to N or O atoms</span>
 1036 <span class="s2">        NegativelyCharged: Side chain O atoms in ASP and GLU</span>
 1037 <span class="s2">        PositivelyCharged: Side chain N atoms in ARG and LYS</span>
 1038 <span class="s2">        Others: Remaining atoms in polar and other residues</span>
 1039 <span class="s2">         </span>
 1040 <span class="s2">    The following color scheme is used by default:</span>
 1041 
 1042 <span class="s2">        Hydrophobic: yellow</span>
 1043 <span class="s2">        NegativelyCharged: red</span>
 1044 <span class="s2">        PositivelyCharged: blue</span>
 1045 <span class="s2">        Others: gray90</span>
 1046 <span class="s2">    </span>
 1047 <span class="s2">    The  amino acid atom names to color specific atoms  are taken from YRB.py</span>
 1048 <span class="s2">    script [ REF 140]. The color values may also be specified as comma delimited</span>
 1049 <span class="s2">    RGB triplets. For example: HydrophobicAtomsColor = &quot;0.950 0.78 0.0&quot;,</span>
 1050 <span class="s2">    NegativelyChargedAtomsColor = &quot;1.0 0.4 0.4&quot;, PositivelyChargedAtomsColor</span>
 1051 <span class="s2">    = &quot;0.2 0.5 0.8&quot;, OtherAtomsColor = &quot;0.95 0.95 0.95&quot;</span>
 1052 <span class="s2">    </span>
 1053 <span class="s2">    </span><span class="se">\&quot;</span><span class="s2">&quot;&quot;</span>
 1054 
 1055 <span class="s2">    # Process colors...</span>
 1056 <span class="s2">    Colors = {&quot;HydrophobicAtomsColor&quot;: HydrophobicAtomsColor, &quot;NegativelyChargedAtomsColor&quot;: NegativelyChargedAtomsColor, &quot;PositivelyChargedAtomsColor&quot;: PositivelyChargedAtomsColor, &quot;OtherAtomsColor&quot;: OtherAtomsColor}</span>
 1057 <span class="s2">    ColorsRGB = {}</span>
 1058 <span class="s2">    for ColorKey, ColorValue in Colors.items():</span>
 1059 <span class="s2">        if re.search(&quot; &quot;, ColorValue):</span>
 1060 <span class="s2">            ColorRGB = ColorValue.split(&quot; &quot;)</span>
 1061 <span class="s2">        else:</span>
 1062 <span class="s2">            ColorRGB = cmd.get_color_tuple(cmd.get_color_index(ColorValue))</span>
 1063 <span class="s2">        ColorsRGB[ColorKey] = ColorRGB</span>
 1064 <span class="s2">    </span>
 1065 <span class="s2">    # Set up colors...</span>
 1066 <span class="s2">    for ColorKey, ColorValue in ColorsRGB.items():</span>
 1067 <span class="s2">        cmd.set_color(ColorKey, ColorValue)</span>
 1068 
 1069 <span class="s2">    #  Set up colors for atom names across all resiudes...</span>
 1070 <span class="s2">    AtomColors = {&quot;OtherAtomsColor&quot;: &quot;N,C,CA,O&quot;, &quot;HydrophobicAtomsColor&quot;: &quot;CB&quot;}</span>
 1071 <span class="s2">    </span>
 1072 <span class="s2">    #  Set up colors for atom names across specific resiudes...</span>
 1073 <span class="s2">    ResAtomColors = {&quot;arg&quot; : {&quot;HydrophobicAtomsColor&quot;: &quot;CG&quot;, &quot;PositivelyChargedAtomsColor&quot;: &quot;NE,NH2,NH1&quot;, &quot;OtherAtomsColor&quot;: &quot;CD,CZ&quot;}, &quot;asn&quot; : {&quot;OtherAtomsColor&quot;: &quot;CG,OD1,ND2&quot;}, &quot;asp&quot; : {&quot;NegativelyChargedAtomsColor&quot;: &quot;OD2,OD1&quot;, &quot;OtherAtomsColor&quot;: &quot;CG&quot;}, &quot;cys&quot; : {&quot;OtherAtomsColor&quot;: &quot;SG&quot;}, &quot;gln&quot; : {&quot;HydrophobicAtomsColor&quot;: &quot;CG&quot;, &quot;OtherAtomsColor&quot;: &quot;CD,OE1,NE2&quot;}, &quot;glu&quot; : {&quot;HydrophobicAtomsColor&quot;: &quot;CG&quot;, &quot;NegativelyChargedAtomsColor&quot;: &quot;OE1,OE2&quot;, &quot;OtherAtomsColor&quot;: &quot;CD&quot;}, &quot;his&quot; : {&quot;OtherAtomsColor&quot;: &quot;CG,CD2,ND1,NE2,CE1&quot;}, &quot;ile&quot; : {&quot;HydrophobicAtomsColor&quot;: &quot;CG1,CG2,CD1&quot;}, &quot;leu&quot; : {&quot;HydrophobicAtomsColor&quot;: &quot;CG,CD1,CD2&quot;}, &quot;lys&quot; : {&quot;HydrophobicAtomsColor&quot;: &quot;CG,CD&quot;, &quot;PositivelyChargedAtomsColor&quot;: &quot;NZ&quot;, &quot;OtherAtomsColor&quot;: &quot;CE&quot;}, &quot;met&quot; : {&quot;HydrophobicAtomsColor&quot;: &quot;CG,CE&quot;, &quot;OtherAtomsColor&quot;: &quot;SD&quot;}, &quot;phe&quot; : {&quot;HydrophobicAtomsColor&quot;: &quot;CG,CD1,CE1,CZ,CE2,CD2&quot;}, &quot;pro&quot; : {&quot;HydrophobicAtomsColor&quot;: &quot;CG&quot;, &quot;OtherAtomsColor&quot;: &quot;CD&quot;}, &quot;ser&quot; : {&quot;OtherAtomsColor&quot;: &quot;CB,OG&quot;}, &quot;thr&quot; : {&quot;HydrophobicAtomsColor&quot;: &quot;CG2&quot;, &quot;OtherAtomsColor&quot;: &quot;CB,OG1&quot;}, &quot;trp&quot; : {&quot;HydrophobicAtomsColor&quot;: &quot;CG,CD2,CZ2,CH2,CZ3,CE3&quot;, &quot;OtherAtomsColor&quot;: &quot;CD1,NE1,CE2&quot;}, &quot;tyr&quot; : {&quot;HydrophobicAtomsColor&quot;: &quot;CG,CE1,CD1,CE2,CD2&quot;, &quot;OtherAtomsColor&quot;: &quot;CZ,OH&quot;}, &quot;val&quot; : {&quot;HydrophobicAtomsColor&quot;: &quot;CG1,CG2&quot;}}</span>
 1074 <span class="s2">    </span>
 1075 <span class="s2">    #  Color atom names across all resiudes...</span>
 1076 <span class="s2">    for ColorName in AtomColors:</span>
 1077 <span class="s2">        AtomNames = AtomColors[ColorName]</span>
 1078 <span class="s2">        AtomsSelection = &quot;(</span><span class="si">%s</span><span class="s2"> and name </span><span class="si">%s</span><span class="s2">)&quot; % (Selection, AtomNames)</span>
 1079 <span class="s2">        cmd.color(ColorName, AtomsSelection)</span>
 1080 <span class="s2">        </span>
 1081 <span class="s2">    #  Color atom names across specific resiudes...</span>
 1082 <span class="s2">    for ResName in ResAtomColors:</span>
 1083 <span class="s2">        for ColorName in ResAtomColors[ResName]:</span>
 1084 <span class="s2">            AtomNames = ResAtomColors[ResName][ColorName]</span>
 1085 <span class="s2">            AtomsSelection = &quot;(</span><span class="si">%s</span><span class="s2"> and resn </span><span class="si">%s</span><span class="s2"> and name </span><span class="si">%s</span><span class="s2">)&quot; % (Selection, ResName, AtomNames)</span>
 1086 <span class="s2">            cmd.color(ColorName, AtomsSelection)</span>
 1087 <span class="s2">    </span>
 1088 <span class="s2">cmd.extend(&quot;ColorAtomsByHydrophobicityAndCharge&quot;, ColorAtomsByHydrophobicityAndCharge)</span>
 1089 
 1090 <span class="s2">def CheckAndDeleteEmptyObjects(ObjectNames, ParentObjectName = None):</span>
 1091 <span class="s2">    </span><span class="se">\&quot;</span><span class="s2">&quot;&quot;Delete an empty objects along with optionally deleting their parent.</span>
 1092 <span class="s2">        </span>
 1093 <span class="s2">    </span><span class="se">\&quot;</span><span class="s2">&quot;&quot;</span>
 1094 <span class="s2">    </span>
 1095 <span class="s2">    ObjectNamesList = ObjectNames.split(&quot;,&quot;)</span>
 1096 
 1097 <span class="s2">    AllObjectsEmpty = True</span>
 1098 <span class="s2">    for ObjectName in ObjectNamesList:</span>
 1099 <span class="s2">        ObjectName = ObjectName.strip()</span>
 1100 <span class="s2">        if  cmd.count_atoms(&quot;(</span><span class="si">%s</span><span class="s2">)&quot; % ObjectName):</span>
 1101 <span class="s2">            AllObjectsEmpty = False</span>
 1102 <span class="s2">        else:</span>
 1103 <span class="s2">            cmd.delete(&quot;</span><span class="si">%s</span><span class="s2">&quot; % ObjectName)</span>
 1104 <span class="s2">    </span>
 1105 <span class="s2">    if AllObjectsEmpty and ParentObjectName is not None:</span>
 1106 <span class="s2">        cmd.delete(&quot;</span><span class="si">%s</span><span class="s2">&quot; % ParentObjectName)</span>
 1107 <span class="s2">    </span>
 1108 <span class="s2">cmd.extend(&quot;CheckAndDeleteEmptyObjects&quot;, CheckAndDeleteEmptyObjects)</span>
 1109 
 1110 <span class="s2">python end&quot;&quot;&quot;</span>
 1111     
 1112     <span class="k">return</span> <span class="n">PMLForPython</span>
 1113 
 1114 <span class="k">def</span> <span class="nf">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
 1115     <span class="sd">&quot;&quot;&quot;Setup PML command for enabling or disabling display of a PyMOL object.</span>
 1116 
 1117 <span class="sd">    Arguments:</span>
 1118 <span class="sd">        Name (str): Name of a PyMOL object.</span>
 1119 <span class="sd">        Enable (bool): Display status.</span>
 1120 
 1121 <span class="sd">    Returns:</span>
 1122 <span class="sd">        str: PML command for enabling or disabling display of an object.</span>
 1123 
 1124 <span class="sd">    &quot;&quot;&quot;</span>
 1125     
 1126     <span class="k">if</span> <span class="n">Enable</span><span class="p">:</span>
 1127         <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;cmd.enable(&quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">Name</span>
 1128     <span class="k">else</span><span class="p">:</span>
 1129         <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;cmd.disable(&quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">Name</span>
 1130         
 1131     <span class="k">return</span> <span class="n">PML</span>
 1132 
 1133 <span class="k">def</span> <span class="nf">SetupPMLForGroup</span><span class="p">(</span><span class="n">GroupName</span><span class="p">,</span> <span class="n">GroupMembersList</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
 1134     <span class="sd">&quot;&quot;&quot;Setup PML commands for creating a group from a list of group members. The</span>
 1135 <span class="sd">    display and open status of the group may be optionally set. The &#39;None&#39; values</span>
 1136 <span class="sd">    for Enable and Action imply usage of PyMOL defaults for the creation of group.</span>
 1137 
 1138 <span class="sd">    Arguments:</span>
 1139 <span class="sd">        GroupName (str): Name of a PyMOL group.</span>
 1140 <span class="sd">        GroupMembersList (list): List of group member names.</span>
 1141 <span class="sd">        Enable (bool): Display status of group.</span>
 1142 <span class="sd">        Action (str): Open or close status of group object.</span>
 1143 
 1144 <span class="sd">    Returns:</span>
 1145 <span class="sd">        str: PML commands for creating a group object.</span>
 1146 
 1147 <span class="sd">    &quot;&quot;&quot;</span>
 1148 
 1149     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
 1150     
 1151     <span class="n">GroupMembers</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">GroupMembersList</span><span class="p">)</span>
 1152     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.group(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupName</span><span class="p">,</span> <span class="n">GroupMembers</span><span class="p">))</span>
 1153     
 1154     <span class="k">if</span> <span class="n">Enable</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
 1155         <span class="k">if</span> <span class="n">Enable</span><span class="p">:</span>
 1156             <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.enable(&quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">GroupName</span><span class="p">)</span>
 1157         <span class="k">else</span><span class="p">:</span>
 1158             <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.disable(&quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">GroupName</span><span class="p">)</span>
 1159     
 1160     <span class="k">if</span> <span class="n">Action</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
 1161         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.group(&quot;</span><span class="si">%s</span><span class="s2">&quot;, action=&quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupName</span><span class="p">,</span> <span class="n">Action</span><span class="p">))</span>
 1162 
 1163     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
 1164     
 1165     <span class="k">return</span> <span class="n">PML</span>
 1166 
 1167 <span class="k">def</span> <span class="nf">SetupPMLForLigandView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">LigandResName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
 1168     <span class="sd">&quot;&quot;&quot;Setup PML commands for creating a ligand view corresponding to a ligand </span>
 1169 <span class="sd">    present in a selection. The ligand is identified using organic selection</span>
 1170 <span class="sd">    operator available in PyMOL in conjunction with the specified ligand ID.</span>
 1171 <span class="sd">    The ligand is colored by atom types and displayed as &#39;sticks&#39;.</span>
 1172 
 1173 <span class="sd">    Arguments:</span>
 1174 <span class="sd">        Name (str): Name of a new PyMOL ligand object.</span>
 1175 <span class="sd">        Selection (str): PyMOL selection containing ligand.</span>
 1176 <span class="sd">        LigandResName (str): Ligand ID.</span>
 1177 <span class="sd">        Enable (bool): Display status of ligand object.</span>
 1178 
 1179 <span class="sd">    Returns:</span>
 1180 <span class="sd">        str: PML commands for a ligand view.</span>
 1181 
 1182 <span class="sd">    &quot;&quot;&quot;</span>
 1183 
 1184     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
 1185     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.create(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;((</span><span class="si">%s</span><span class="s2">) and organic and (resn </span><span class="si">%s</span><span class="s2">))&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">LigandResName</span><span class="p">))</span>
 1186     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.hide(&quot;everything&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 1187     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;util.cbag(&quot;</span><span class="si">%s</span><span class="s2">&quot;, _self = cmd)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 1188     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;sticks&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 1189     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Enable</span><span class="p">))</span>
 1190     
 1191     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
 1192     
 1193     <span class="k">return</span> <span class="n">PML</span>
 1194 
 1195 <span class="k">def</span> <span class="nf">SetupPMLForLigandPocketView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">LigandSelection</span><span class="p">,</span> <span class="n">DistanceCutoff</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
 1196     <span class="sd">&quot;&quot;&quot;Setup PML commands for creating a ligand binding pocket view</span>
 1197 <span class="sd">    corresponding all residues present in a selection within a specified</span>
 1198 <span class="sd">    distance from a ligand selection. The solvent and inorganic portions of</span>
 1199 <span class="sd">    the selection are not included in the binding pocket. The pocket residues</span>
 1200 <span class="sd">    are shown as &#39;lines&#39;. The hydrogen atoms are not displayed.</span>
 1201 
 1202 <span class="sd">    Arguments:</span>
 1203 <span class="sd">        Name (str): Name of a new PyMOL binding pocket object.</span>
 1204 <span class="sd">        Selection (str): PyMOL selection containing binding pocket residues.</span>
 1205 <span class="sd">        LigandSelection (str): PyMOL selection containing ligand.</span>
 1206 <span class="sd">        DistanceCutoff (float): Distance cutoff from ligand for selecting</span>
 1207 <span class="sd">            binding pockect residues.</span>
 1208 <span class="sd">        Enable (bool): Display status of binding pocket object.</span>
 1209 
 1210 <span class="sd">    Returns:</span>
 1211 <span class="sd">        str: PML commands for a ligand binding pocket view.</span>
 1212 
 1213 <span class="sd">    &quot;&quot;&quot;</span>
 1214 
 1215     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
 1216     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.create(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;((byresidue (</span><span class="si">%s</span><span class="s2">) within </span><span class="si">%.1f</span><span class="s2"> of (</span><span class="si">%s</span><span class="s2">)) and (not solvent) and (not inorganic) and (not organic))&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">DistanceCutoff</span><span class="p">,</span> <span class="n">LigandSelection</span><span class="p">))</span>
 1217     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.hide(&quot;everything&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 1218     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;lines&quot;, &quot;(</span><span class="si">%s</span><span class="s2">)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 1219     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.hide(&quot;(</span><span class="si">%s</span><span class="s2"> and hydro)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 1220     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Enable</span><span class="p">))</span>
 1221     
 1222     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
 1223     
 1224     <span class="k">return</span> <span class="n">PML</span>
 1225 
 1226 <span class="k">def</span> <span class="nf">SetupPMLForLigandPocketSolventView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">LigandSelection</span><span class="p">,</span> <span class="n">DistanceCutoff</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
 1227     <span class="sd">&quot;&quot;&quot;Setup PML commands for creating a ligand binding pocket view</span>
 1228 <span class="sd">    corresponding to only solvent residues present in a selection within a</span>
 1229 <span class="sd">    specified distance from a ligand selection. The solvent pocket residues</span>
 1230 <span class="sd">    are shown as &#39;lines&#39; and &#39;nonbonded&#39;.</span>
 1231 
 1232 <span class="sd">    Arguments:</span>
 1233 <span class="sd">        Name (str): Name of a new PyMOL solvent binding pocket object.</span>
 1234 <span class="sd">        Selection (str): PyMOL selection containing binding pocket residues.</span>
 1235 <span class="sd">        LigandSelection (str): PyMOL selection containing ligand.</span>
 1236 <span class="sd">        DistanceCutoff (float): Distance cutoff from ligand for selecting</span>
 1237 <span class="sd">            binding pocket solvent residues.</span>
 1238 <span class="sd">        Enable (bool): Display status of binding pocket object.</span>
 1239 
 1240 <span class="sd">    Returns:</span>
 1241 <span class="sd">        str: PML commands for a ligand binding pocket view only showing solvent</span>
 1242 <span class="sd">            residues.</span>
 1243 
 1244 <span class="sd">    &quot;&quot;&quot;</span>
 1245 
 1246     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
 1247     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.create(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;((byresidue (</span><span class="si">%s</span><span class="s2">) within </span><span class="si">%.1f</span><span class="s2"> of (</span><span class="si">%s</span><span class="s2">)) and solvent)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">DistanceCutoff</span><span class="p">,</span> <span class="n">LigandSelection</span><span class="p">))</span>
 1248     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.hide(&quot;everything&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 1249     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;nonbonded&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 1250     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;lines&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 1251     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Enable</span><span class="p">))</span>
 1252     
 1253     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
 1254     
 1255     <span class="k">return</span> <span class="n">PML</span>
 1256 
 1257 <span class="k">def</span> <span class="nf">SetupPMLForLigandPocketInorganicView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">LigandSelection</span><span class="p">,</span> <span class="n">DistanceCutoff</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
 1258     <span class="sd">&quot;&quot;&quot;Setup PML commands for creating a ligand binding pocket view</span>
 1259 <span class="sd">    corresponding to only inorganic residues present in a selection within a</span>
 1260 <span class="sd">    specified distance from a ligand selection. The inorganic pocket residues</span>
 1261 <span class="sd">    are shown as &#39;lines&#39; and &#39;nonbonded&#39;.</span>
 1262 
 1263 <span class="sd">    Arguments:</span>
 1264 <span class="sd">        Name (str): Name of a new PyMOL solvent binding pocket object.</span>
 1265 <span class="sd">        Selection (str): PyMOL selection containing binding pocket residues.</span>
 1266 <span class="sd">        LigandSelection (str): PyMOL selection containing ligand.</span>
 1267 <span class="sd">        DistanceCutoff (float): Distance cutoff from ligand for selecting</span>
 1268 <span class="sd">            binding pocket inorganic residues.</span>
 1269 <span class="sd">        Enable (bool): Display status of binding pocket object.</span>
 1270 
 1271 <span class="sd">    Returns:</span>
 1272 <span class="sd">        str: PML commands for a ligand binding pocket view only showing inorganic</span>
 1273 <span class="sd">            residues.</span>
 1274 
 1275 <span class="sd">    &quot;&quot;&quot;</span>
 1276 
 1277     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
 1278     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.create(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;((byresidue (</span><span class="si">%s</span><span class="s2">) within </span><span class="si">%.1f</span><span class="s2"> of (</span><span class="si">%s</span><span class="s2">)) and inorganic)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">DistanceCutoff</span><span class="p">,</span> <span class="n">LigandSelection</span><span class="p">))</span>
 1279     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.hide(&quot;everything&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 1280     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;nonbonded&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 1281     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;lines&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 1282     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Enable</span><span class="p">))</span>
 1283     
 1284     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
 1285     
 1286     <span class="k">return</span> <span class="n">PML</span>
 1287 
 1288 <span class="k">def</span> <span class="nf">SetupPMLForPolarContactsView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection1</span><span class="p">,</span> <span class="n">Selection2</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">Color</span> <span class="o">=</span> <span class="s2">&quot;yellow&quot;</span><span class="p">):</span>
 1289     <span class="sd">&quot;&quot;&quot;Setup PML commands for creating polar contacts view between a pair of</span>
 1290 <span class="sd">    selections. The polar contact view is generated using &#39;util.dist&#39; command. The</span>
 1291 <span class="sd">    distance labels are shown by default.</span>
 1292 
 1293 <span class="sd">    Arguments:</span>
 1294 <span class="sd">        Name (str): Name of a new PyMOL polar contacts object.</span>
 1295 <span class="sd">        Selection1 (str): First PyMOL selection.</span>
 1296 <span class="sd">        Selection2 (str): Second PyMOL selection.</span>
 1297 <span class="sd">        Enable (bool): Display status of polar contacts object.</span>
 1298 <span class="sd">        Colot (str): Color for polar contact lines and labels.</span>
 1299 
 1300 <span class="sd">    Returns:</span>
 1301 <span class="sd">        str: PML commands for polar contacts view between a pair of selections.</span>
 1302 
 1303 <span class="sd">    &quot;&quot;&quot;</span>
 1304     
 1305     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
 1306     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.dist(&quot;</span><span class="si">%s</span><span class="s2">&quot;,&quot;(</span><span class="si">%s</span><span class="s2">)&quot;,&quot;(</span><span class="si">%s</span><span class="s2">)&quot;,quiet = 1, mode = 2, label = 1, reset = 1)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection1</span><span class="p">,</span> <span class="n">Selection2</span><span class="p">))</span>
 1307     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;util.color_deep(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Color</span><span class="p">,</span> <span class="n">Name</span><span class="p">))</span>
 1308     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Enable</span><span class="p">))</span>
 1309     
 1310     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
 1311     
 1312     <span class="k">return</span> <span class="n">PML</span>
 1313 
 1314 <span class="k">def</span> <span class="nf">SetupPMLForAlignment</span><span class="p">(</span><span class="n">Method</span><span class="p">,</span> <span class="n">RefSelection</span><span class="p">,</span> <span class="n">FitSelection</span><span class="p">):</span>
 1315     <span class="sd">&quot;&quot;&quot;Setup PML commands for aligning a pair of selection using  a specified</span>
 1316 <span class="sd">    alignment method.</span>
 1317 
 1318 <span class="sd">    Arguments:</span>
 1319 <span class="sd">        Method (str): Alignment method. Possible values: align, cealign, super.</span>
 1320 <span class="sd">        RefSelection (str): Name of reference selection which stays stationary.</span>
 1321 <span class="sd">        FitSelection (str): Name of selection to align to reference selection.</span>
 1322 
 1323 <span class="sd">    Returns:</span>
 1324 <span class="sd">        str: PML commands for aligning  a pair of selections.</span>
 1325 
 1326 <span class="sd">    &quot;&quot;&quot;</span>
 1327 
 1328     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
 1329     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^align$&quot;</span><span class="p">,</span> <span class="n">Method</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1330         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.align(&quot;(</span><span class="si">%s</span><span class="s2">)&quot;, &quot;(</span><span class="si">%s</span><span class="s2">)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">FitSelection</span><span class="p">,</span> <span class="n">RefSelection</span><span class="p">))</span>
 1331     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^cealign$&quot;</span><span class="p">,</span> <span class="n">Method</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1332         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.cealign(&quot;(</span><span class="si">%s</span><span class="s2">)&quot;, &quot;(</span><span class="si">%s</span><span class="s2">)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">RefSelection</span><span class="p">,</span> <span class="n">FitSelection</span><span class="p">))</span>
 1333     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^super$&quot;</span><span class="p">,</span> <span class="n">Method</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1334         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.super(&quot;(</span><span class="si">%s</span><span class="s2">)&quot;, &quot;(</span><span class="si">%s</span><span class="s2">)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">FitSelection</span><span class="p">,</span> <span class="n">RefSelection</span><span class="p">))</span>
 1335     <span class="k">else</span><span class="p">:</span>
 1336         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;PyMOLUtil.SetupPMLForAlignment: Invalid method name: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">Method</span><span class="p">)</span>
 1337 
 1338     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
 1339     
 1340     <span class="k">return</span> <span class="n">PML</span>
 1341 
 1342 <span class="k">def</span> <span class="nf">SetupPMLForBFactorPuttyView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">ColorPalette</span> <span class="o">=</span> <span class="s2">&quot;blue_white_red&quot;</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
 1343     <span class="sd">&quot;&quot;&quot;Setup PML commands for creating a B factor putty view for a specified</span>
 1344 <span class="sd">    selection. The B factor values must be available for the atoms. The atoms</span>
 1345 <span class="sd">    are colored using a color spectrum corresponding to a specified color</span>
 1346 <span class="sd">    palette. Any valid PyMOL color palette name may be used.</span>
 1347 
 1348 <span class="sd">    Arguments:</span>
 1349 <span class="sd">        Name (str): Name of a new PyMOL B factor putty object.</span>
 1350 <span class="sd">        Selection (str): Name of PyMOL selection.</span>
 1351 <span class="sd">        ColorPalette (str): Name of color palette to use for color spectrum.</span>
 1352 <span class="sd">        Enable (bool): Display status of B factor putty object.</span>
 1353 
 1354 <span class="sd">    Returns:</span>
 1355 <span class="sd">        str: PML commands for B factor putty view.</span>
 1356 
 1357 <span class="sd">    &quot;&quot;&quot;</span>
 1358     
 1359     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
 1360     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.create(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;(</span><span class="si">%s</span><span class="s2">)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">))</span>
 1361     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.hide(&quot;everything&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 1362     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.spectrum(&quot;b&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;(</span><span class="si">%s</span><span class="s2">)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ColorPalette</span><span class="p">,</span> <span class="n">Name</span><span class="p">))</span>
 1363     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;cartoon&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 1364     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.cartoon(&quot;putty&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 1365     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Enable</span><span class="p">))</span>
 1366     
 1367     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
 1368     
 1369     <span class="k">return</span> <span class="n">PML</span>
 1370 
 1371 <span class="k">def</span> <span class="nf">SetupPMLForHydrophobicSurfaceView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">ColorPalette</span> <span class="o">=</span> <span class="s2">&quot;RedToWhite&quot;</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="s2">&quot;cartoon&quot;</span><span class="p">):</span>
 1372     <span class="sd">&quot;&quot;&quot;Setup PML commands for creating a hydrophobic surface view for a specified</span>
 1373 <span class="sd">    selection. The surfaces are colored using a specified color palette. This is only valid</span>
 1374 <span class="sd">    for amino acids.</span>
 1375 
 1376 <span class="sd">    Arguments:</span>
 1377 <span class="sd">        Name (str): Name of a new PyMOL hydrophobic surface object.</span>
 1378 <span class="sd">        Selection (str): Name of PyMOL selection.</span>
 1379 <span class="sd">        ColorPalette (str): Name of color palette to use for coloring surfaces.</span>
 1380 <span class="sd">            Possible values: RedToWhite or WhiteToGreen for most hydrophobic</span>
 1381 <span class="sd">            to least hydrophobic amino acids.</span>
 1382 <span class="sd">        Enable (bool): Display status of surface object.</span>
 1383 <span class="sd">        DisplayAs (str): Any additional valid display type such as lines,</span>
 1384 <span class="sd">            sticks, ribbon, cartoon, or None. </span>
 1385 
 1386 <span class="sd">    Returns:</span>
 1387 <span class="sd">        str: PML commands for hydrophobic surface view.</span>
 1388 
 1389 <span class="sd">    &quot;&quot;&quot;</span>
 1390 
 1391     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="n">_GetPMLCmdsForSurfaceView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">DisplayAs</span><span class="p">)</span>
 1392     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;ColorByHydrophobicity(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">ColorPalette</span><span class="p">))</span>
 1393     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Enable</span><span class="p">))</span>
 1394     
 1395     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
 1396     
 1397     <span class="k">return</span> <span class="n">PML</span>
 1398 
 1399 <span class="k">def</span> <span class="nf">SetupPMLForHydrophobicAndChargeSurfaceView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">HydrophobicAtomsColor</span> <span class="o">=</span> <span class="s2">&quot;yellow&quot;</span><span class="p">,</span> <span class="n">NegativelyChargedAtomsColor</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">PositivelyChargedAtomsColor</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">OtherAtomsColor</span> <span class="o">=</span> <span class="s2">&quot;gray90&quot;</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="s2">&quot;cartoon&quot;</span><span class="p">):</span>
 1400     <span class="sd">&quot;&quot;&quot;Setup PML commands for creating a surface colored by hydrophobic and</span>
 1401 <span class="sd">    charge [ REF 140] properties of atoms in amino acids. The atom names in</span>
 1402 <span class="sd">    standard amino acid residues are used to identify atom types as shown below:</span>
 1403 
 1404 <span class="sd">    Hydrophobic: C atoms not bound to N or O atoms; NegativelyCharged: Side</span>
 1405 <span class="sd">    chain O atoms in ASP and GLU; PositivelyCharged: Side chain N atoms in</span>
 1406 <span class="sd">    ARG and LYS; Others: Remaining atoms in polar and other residues</span>
 1407 
 1408 <span class="sd">    The  amino acid atom names to color specific atoms  are taken from YRB.py</span>
 1409 <span class="sd">    script [ REF 140]. The color values may also be specified as comma delimited</span>
 1410 <span class="sd">    RGB triplets. For example: HydrophobicAtomsColor = &quot;0.950 0.78 0.0&quot;,</span>
 1411 <span class="sd">    NegativelyChargedAtomsColor = &quot;1.0 0.4 0.4&quot;, PositivelyChargedAtomsColor</span>
 1412 <span class="sd">    = &quot;0.2 0.5 0.8&quot;, OtherAtomsColor = &quot;0.95 0.95 0.95&quot;</span>
 1413 
 1414 <span class="sd">    Arguments:</span>
 1415 <span class="sd">        Name (str): Name of a new PyMOL hydrophobic surface object.</span>
 1416 <span class="sd">        Selection (str): Name of PyMOL selection.</span>
 1417 <span class="sd">        HydrophobicAtomsColor (str): Color name or space delimited RGB values</span>
 1418 <span class="sd">        NegativelyChargedAtomsColor (str): Color name or space delimited RGB values</span>
 1419 <span class="sd">        PositivelyChargedAtomsColor (str): Color name or space delimited RGB values</span>
 1420 <span class="sd">        OtherAtomsColor (str): Color name or space delimited RGB values</span>
 1421 <span class="sd">        Enable (bool): Display status of surface object.</span>
 1422 <span class="sd">        DisplayAs (str): Any additional valid display type such as lines,</span>
 1423 <span class="sd">            sticks, ribbon, cartoon, or None. </span>
 1424 
 1425 <span class="sd">    Returns:</span>
 1426 <span class="sd">        str: PML commands for hydrophobic and charge surface view.</span>
 1427 
 1428 <span class="sd">    &quot;&quot;&quot;</span>
 1429 
 1430     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="n">_GetPMLCmdsForSurfaceView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">DisplayAs</span><span class="p">)</span>
 1431     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;ColorAtomsByHydrophobicityAndCharge(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">HydrophobicAtomsColor</span><span class="p">,</span> <span class="n">NegativelyChargedAtomsColor</span><span class="p">,</span> <span class="n">PositivelyChargedAtomsColor</span><span class="p">,</span> <span class="n">OtherAtomsColor</span><span class="p">))</span>
 1432     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Enable</span><span class="p">))</span>
 1433     
 1434     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
 1435     
 1436     <span class="k">return</span> <span class="n">PML</span>
 1437 
 1438 <span class="k">def</span> <span class="nf">SetupPMLForSurfaceView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="s2">&quot;cartoon&quot;</span><span class="p">):</span>
 1439     <span class="sd">&quot;&quot;&quot;Setup PML commands for creating a molecular surface view for a specified</span>
 1440 <span class="sd">    selection.</span>
 1441 
 1442 <span class="sd">    Arguments:</span>
 1443 <span class="sd">        Name (str): Name of a new PyMOL molecular surface object.</span>
 1444 <span class="sd">        Selection (str): Name of PyMOL selection.</span>
 1445 <span class="sd">        Enable (bool): Display status of surface object.</span>
 1446 <span class="sd">        DisplayAs (str): Any additional valid display type such as lines,</span>
 1447 <span class="sd">            sticks, ribbon, cartoon, or None. </span>
 1448 
 1449 <span class="sd">    Returns:</span>
 1450 <span class="sd">        str: PML commands for molecular surface view.</span>
 1451 
 1452 <span class="sd">    &quot;&quot;&quot;</span>
 1453 
 1454     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="n">_GetPMLCmdsForSurfaceView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">DisplayAs</span><span class="p">)</span>
 1455     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Enable</span><span class="p">))</span>
 1456     
 1457     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
 1458     
 1459     <span class="k">return</span> <span class="n">PML</span>
 1460 
 1461 <span class="k">def</span> <span class="nf">_GetPMLCmdsForSurfaceView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="s2">&quot;cartoon&quot;</span><span class="p">):</span>
 1462     <span class="sd">&quot;&quot;&quot;Setup PML command for surface view.&quot;&quot;&quot;</span>
 1463 
 1464     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
 1465     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.create(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;(</span><span class="si">%s</span><span class="s2">)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">))</span>
 1466     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.hide(&quot;everything&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 1467     <span class="k">if</span> <span class="n">DisplayAs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
 1468         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DisplayAs</span><span class="p">,</span> <span class="n">Name</span><span class="p">))</span>
 1469     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;surface&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 1470 
 1471     <span class="k">return</span> <span class="n">PMLCmds</span>
 1472     
 1473 <span class="k">def</span> <span class="nf">SetupPMLForSelectionDisplayView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">DisplayAs</span><span class="p">,</span> <span class="n">Color</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
 1474     <span class="sd">&quot;&quot;&quot;Setup PML commands for creating a specific molecular display view for a</span>
 1475 <span class="sd">     selection.</span>
 1476 
 1477 <span class="sd">    Arguments:</span>
 1478 <span class="sd">        Name (str): Name of a new PyMOL object.</span>
 1479 <span class="sd">        Selection (str): Name of PyMOL selection.</span>
 1480 <span class="sd">        DisplayAs (str): Any valid display type such as lines, sticks, ribbon,</span>
 1481 <span class="sd">            cartoon, or surface</span>
 1482 <span class="sd">        Color (str): Color name or use default color.</span>
 1483 <span class="sd">        Enable (bool): Display status of object.</span>
 1484 
 1485 <span class="sd">    Returns:</span>
 1486 <span class="sd">        str: PML commands for molecular selection view.</span>
 1487 
 1488 <span class="sd">    &quot;&quot;&quot;</span>
 1489 
 1490     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
 1491     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.create(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;(</span><span class="si">%s</span><span class="s2">)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">))</span>
 1492     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.hide(&quot;everything&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 1493     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DisplayAs</span><span class="p">,</span> <span class="n">Name</span><span class="p">))</span>
 1494     <span class="k">if</span> <span class="n">Color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
 1495         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;util.color_deep(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Color</span><span class="p">,</span> <span class="n">Name</span><span class="p">))</span>
 1496     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Enable</span><span class="p">))</span>
 1497     
 1498     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
 1499     
 1500     <span class="k">return</span> <span class="n">PML</span>
 1501 
 1502 <span class="k">def</span> <span class="nf">SetupPMLForBallAndStickView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">SphereScale</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">StickRadius</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">):</span>
 1503     <span class="sd">&quot;&quot;&quot;Setup PML commands for creating a ball and stick view for a specified</span>
 1504 <span class="sd">    selection.</span>
 1505 
 1506 <span class="sd">    Arguments:</span>
 1507 <span class="sd">        Name (str): Name of a new PyMOL ball and stick object.</span>
 1508 <span class="sd">        Selection (str): Name of PyMOL selection.</span>
 1509 <span class="sd">        Enable (bool): Display status of ball and stick object.</span>
 1510 <span class="sd">        SphereScale (float): Scaling factor for sphere radii.</span>
 1511 <span class="sd">        StickScale (float): Scaling factor for stick radii.</span>
 1512 
 1513 <span class="sd">    Returns:</span>
 1514 <span class="sd">        str: PML commands for ball and stick view.</span>
 1515 
 1516 <span class="sd">    &quot;&quot;&quot;</span>
 1517 
 1518     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
 1519     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.create(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;(</span><span class="si">%s</span><span class="s2">)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">))</span>
 1520     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.hide(&quot;everything&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 1521     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;sphere&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 1522     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;sticks&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 1523     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;sphere_scale&quot;, </span><span class="si">%.1f</span><span class="s2">, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SphereScale</span><span class="p">,</span> <span class="n">Name</span><span class="p">))</span>
 1524     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;stick_radius&quot;, </span><span class="si">%.1f</span><span class="s2">, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">StickRadius</span><span class="p">,</span> <span class="n">Name</span><span class="p">))</span>
 1525     
 1526     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Enable</span><span class="p">))</span>
 1527     
 1528     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
 1529     
 1530     <span class="k">return</span> <span class="n">PML</span>
 1531 
 1532 <span class="k">def</span> <span class="nf">SetupPMLForInorganicView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
 1533     <span class="sd">&quot;&quot;&quot;Setup PML commands for creating a inorganic view corresponding to</span>
 1534 <span class="sd">    inorganic residues present in a selection. The inorganic residues are</span>
 1535 <span class="sd">    identified using inorganic selection operator available in PyMOL. The</span>
 1536 <span class="sd">    inorganic residues are displayed as &#39;lines&#39; and &#39;nonbonded&#39;.</span>
 1537 
 1538 <span class="sd">    Arguments:</span>
 1539 <span class="sd">        Name (str): Name of a new PyMOL inorganic object.</span>
 1540 <span class="sd">        Selection (str): Name of PyMOL selection.</span>
 1541 <span class="sd">        Enable (bool): Display status of inorganic object.</span>
 1542 
 1543 <span class="sd">    Returns:</span>
 1544 <span class="sd">        str: PML commands for inorganic view.</span>
 1545 
 1546 <span class="sd">    &quot;&quot;&quot;</span>
 1547 
 1548     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
 1549     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.create(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;((</span><span class="si">%s</span><span class="s2">) and inorganic)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">))</span>
 1550     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;nonbonded&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 1551     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;lines&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 1552     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Enable</span><span class="p">))</span>
 1553     
 1554     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
 1555     
 1556     <span class="k">return</span> <span class="n">PML</span>
 1557 
 1558 <span class="k">def</span> <span class="nf">SetupPMLForSolventView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
 1559     <span class="sd">&quot;&quot;&quot;Setup PML commands for creating a solvent view corresponding to</span>
 1560 <span class="sd">    solvent residues present in a selection. The solvent residues are</span>
 1561 <span class="sd">    identified using solvent selection operator available in PyMOL. The</span>
 1562 <span class="sd">    solvent residues are displayed as &#39;nonbonded&#39;.</span>
 1563 
 1564 <span class="sd">    Arguments:</span>
 1565 <span class="sd">        Name (str): Name of a new PyMOL solvent object.</span>
 1566 <span class="sd">        Selection (str): Name of PyMOL selection.</span>
 1567 <span class="sd">        Enable (bool): Display status of inorganic object.</span>
 1568 
 1569 <span class="sd">    Returns:</span>
 1570 <span class="sd">        str: PML commands for solvent view.</span>
 1571 
 1572 <span class="sd">    &quot;&quot;&quot;</span>
 1573 
 1574     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
 1575     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.create(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;((</span><span class="si">%s</span><span class="s2">) and solvent)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">))</span>
 1576     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;nonbonded&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 1577     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Enable</span><span class="p">))</span>
 1578     
 1579     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
 1580     
 1581     <span class="k">return</span> <span class="n">PML</span>
 1582 
 1583 <span class="k">def</span> <span class="nf">SetupPMLForPolymerChainView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
 1584     <span class="sd">&quot;&quot;&quot;Setup PML commands for creating a polymer chain view corresponding</span>
 1585 <span class="sd">    to backbone and sidechain residues in a selection. The polymer chain is</span>
 1586 <span class="sd">    displayed as &#39;cartoon&#39;.</span>
 1587 
 1588 <span class="sd">    Arguments:</span>
 1589 <span class="sd">        Name (str): Name of a new PyMOL polymer chain object.</span>
 1590 <span class="sd">        Selection (str): Name of PyMOL selection.</span>
 1591 <span class="sd">        Enable (bool): Display status of chain object.</span>
 1592 
 1593 <span class="sd">    Returns:</span>
 1594 <span class="sd">        str: PML commands for polymer chain view.</span>
 1595 
 1596 <span class="sd">    &quot;&quot;&quot;</span>
 1597 
 1598     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
 1599     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.create(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;((</span><span class="si">%s</span><span class="s2">) and (backbone or sidechain))&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">))</span>
 1600     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.hide(&quot;everything&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 1601     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;util.cbag(&quot;</span><span class="si">%s</span><span class="s2">&quot;, _self = cmd)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 1602     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;cartoon&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 1603     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Enable</span><span class="p">))</span>
 1604     
 1605     
 1606     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
 1607     
 1608     <span class="k">return</span> <span class="n">PML</span>
 1609 
 1610 
 1611 <span class="k">def</span> <span class="nf">SetupPMLForPolymerComplexView</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">PDBFile</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">ShowSolvent</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">ShowInorganic</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">ShowLines</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
 1612     <span class="sd">&quot;&quot;&quot;Setup PML commands for creating a polymer complex view for all chains</span>
 1613 <span class="sd">    in a PDB file. The solvent and inorganic residues are also shown by default.</span>
 1614 <span class="sd">     The polymer chains are displayed as &#39;cartoon&#39;. The &#39;line&#39; display for the</span>
 1615 <span class="sd">    polymer chains is also shown and may be turned off. The organic residues are</span>
 1616 <span class="sd">    displayed as &#39;sticks&#39;. The solvent and inorganic residues are displayed as</span>
 1617 <span class="sd">    &#39;nonbonded&#39; and &#39;lines&#39;.</span>
 1618 <span class="sd">    </span>
 1619 <span class="sd">    Arguments:</span>
 1620 <span class="sd">        MoleculeName (str): Name of a new PyMOL molecule object.</span>
 1621 <span class="sd">        PDBFile (str): Name of PDB file.</span>
 1622 <span class="sd">        Enable (bool): Display status of chain object.</span>
 1623 <span class="sd">        ShowSolvent (bool): Display solvent residues.</span>
 1624 <span class="sd">        ShowInorganic (bool): Display inorganic residues.</span>
 1625 <span class="sd">        ShowLines (bool): Display lines for polymer chains.</span>
 1626 
 1627 <span class="sd">    Returns:</span>
 1628 <span class="sd">        str: PML commands for polymer complex view.</span>
 1629 
 1630 <span class="sd">    &quot;&quot;&quot;</span>
 1631 
 1632     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
 1633     
 1634     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.load(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PDBFile</span><span class="p">,</span> <span class="n">MoleculeName</span><span class="p">))</span>
 1635     <span class="n">PML</span> <span class="o">=</span> <span class="n">_SetupPMLForPolymerComplexView</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">ShowSolvent</span><span class="p">,</span> <span class="n">ShowInorganic</span><span class="p">,</span> <span class="n">ShowLines</span><span class="p">)</span>
 1636     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PML</span><span class="p">)</span>
 1637     
 1638     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
 1639     
 1640     <span class="k">return</span> <span class="n">PML</span>
 1641 
 1642 <span class="k">def</span> <span class="nf">SetupPMLForPolymerChainComplexView</span><span class="p">(</span><span class="n">ChainComplexName</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">ShowSolvent</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">ShowInorganic</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">ShowLines</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
 1643     <span class="sd">&quot;&quot;&quot;Setup PML commands for creating a polymer chain complex view for a specified</span>
 1644 <span class="sd">    chain in a selection. The solvent and inorganic residues are also shown by</span>
 1645 <span class="sd">    default. The polymer chain is displayed as &#39;cartoon&#39;. The &#39;line&#39; display for the</span>
 1646 <span class="sd">    polymer chain is also shown and may be turned off. The organic residues are</span>
 1647 <span class="sd">    displayed as &#39;sticks&#39;. The solvent and inorganic residues are displayed as</span>
 1648 <span class="sd">    &#39;nonbonded&#39; and &#39;lines&#39;.</span>
 1649 
 1650 <span class="sd">    Arguments:</span>
 1651 <span class="sd">        ChainComplexName (str): Name of a new PyMOL polymer chain complex.</span>
 1652 <span class="sd">        Selection (str): Name of PyMOL selection.</span>
 1653 <span class="sd">        ChainName (str): Name of a chain.</span>
 1654 <span class="sd">        Enable (bool): Display status of chain object.</span>
 1655 <span class="sd">        ShowSolvent (bool): Display solvent residues.</span>
 1656 <span class="sd">        ShowInorganic (bool): Display inorganic residues.</span>
 1657 <span class="sd">        ShowLines (bool): Display lines for polymer chain.</span>
 1658 
 1659 <span class="sd">    Returns:</span>
 1660 <span class="sd">        str: PML commands for polymer chain complex view.</span>
 1661 
 1662 <span class="sd">    &quot;&quot;&quot;</span>
 1663 
 1664     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
 1665     
 1666     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.create(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;(</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2">)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainComplexName</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">))</span>
 1667     <span class="n">PML</span> <span class="o">=</span> <span class="n">_SetupPMLForPolymerComplexView</span><span class="p">(</span><span class="n">ChainComplexName</span><span class="p">,</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">ShowSolvent</span><span class="p">,</span> <span class="n">ShowInorganic</span><span class="p">,</span> <span class="n">ShowLines</span><span class="p">)</span>
 1668     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PML</span><span class="p">)</span>
 1669 
 1670     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
 1671     
 1672     <span class="k">return</span> <span class="n">PML</span>
 1673 
 1674 <span class="k">def</span> <span class="nf">_SetupPMLForPolymerComplexView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">ShowSolvent</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">ShowInorganic</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span>  <span class="n">ShowLines</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
 1675     <span class="sd">&quot;&quot;&quot;Setup PML for creating a polymer complex view.&quot;&quot;&quot;</span>
 1676 
 1677     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
 1678     
 1679     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.hide(&quot;everything&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 1680     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;cartoon&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 1681     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;util.cba(33, &quot;</span><span class="si">%s</span><span class="s2">&quot;, _self = cmd)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 1682     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;sticks&quot;, &quot;(organic and (</span><span class="si">%s</span><span class="s2">))&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 1683     <span class="k">if</span> <span class="n">ShowSolvent</span><span class="p">:</span>
 1684         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;nonbonded&quot;, &quot;(solvent and (</span><span class="si">%s</span><span class="s2">))&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 1685     <span class="k">if</span> <span class="n">ShowInorganic</span><span class="p">:</span>
 1686         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;nonbonded&quot;, &quot;(inorganic and (</span><span class="si">%s</span><span class="s2">))&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 1687     
 1688     <span class="k">if</span> <span class="n">ShowLines</span><span class="p">:</span>
 1689         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;lines&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 1690     <span class="k">else</span><span class="p">:</span>
 1691         <span class="k">if</span> <span class="n">ShowInorganic</span><span class="p">:</span>
 1692             <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;lines&quot;, &quot;(inorganic and (</span><span class="si">%s</span><span class="s2">))&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 1693     
 1694     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set_bond(&quot;valence&quot;, &quot;1&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, quiet = 1)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 1695     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Enable</span><span class="p">))</span>
 1696 
 1697     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
 1698     
 1699     <span class="k">return</span> <span class="n">PML</span>
</pre>
<br />
<center>
<img src="../../../images/h2o2.png">
</center>
</body>
</html>
